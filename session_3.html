<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Session 3: Plotting with ggplot2 – WEHI R Course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./session_4.html" rel="next">
<link href="./session_2.html" rel="prev">
<link href="./favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-cc48a02baa7d92beca338a7447a78b59.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8b16d95f9cb9693e68e2bdbbe3456629.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/alpine-3.12/buttons.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./session_3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Session 3: Plotting with ggplot2</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./WEHI_RGB_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">WEHI R Course Book</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Session 1: Introduction to R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Session 2: Working with data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Session 3: Plotting with ggplot2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Session 4: Putting it all together</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Session 5: RNA-seq part 1</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./session_6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Session 6: RNA-seq part 2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./further_reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Further reading</span></a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">In this session:</h2>
   
  <ul>
  <li><a href="#building-our-first-plot-layer-by-layer" id="toc-building-our-first-plot-layer-by-layer" class="nav-link active" data-scroll-target="#building-our-first-plot-layer-by-layer"><span class="header-section-number">3.1</span> Building our first plot, layer by layer</a>
  <ul class="collapse">
  <li><a href="#initialisation" id="toc-initialisation" class="nav-link" data-scroll-target="#initialisation"><span class="header-section-number">3.1.1</span> Initialisation</a></li>
  <li><a href="#adding-data" id="toc-adding-data" class="nav-link" data-scroll-target="#adding-data"><span class="header-section-number">3.1.2</span> Adding data</a></li>
  <li><a href="#overlaying-additional-data" id="toc-overlaying-additional-data" class="nav-link" data-scroll-target="#overlaying-additional-data"><span class="header-section-number">3.1.3</span> Overlaying additional data</a></li>
  <li><a href="#saving-plots-as-images" id="toc-saving-plots-as-images" class="nav-link" data-scroll-target="#saving-plots-as-images"><span class="header-section-number">3.1.4</span> Saving plots as images</a></li>
  </ul></li>
  <li><a href="#some-commonly-used-geoms" id="toc-some-commonly-used-geoms" class="nav-link" data-scroll-target="#some-commonly-used-geoms"><span class="header-section-number">3.2</span> Some commonly used geoms</a>
  <ul class="collapse">
  <li><a href="#visualising-individual-data-points-geom_point" id="toc-visualising-individual-data-points-geom_point" class="nav-link" data-scroll-target="#visualising-individual-data-points-geom_point"><span class="header-section-number">3.2.1</span> Visualising individual data points: geom_point</a></li>
  <li><a href="#visualising-the-distribution-of-a-continuous-variable-geom_histogram-geom_density" id="toc-visualising-the-distribution-of-a-continuous-variable-geom_histogram-geom_density" class="nav-link" data-scroll-target="#visualising-the-distribution-of-a-continuous-variable-geom_histogram-geom_density"><span class="header-section-number">3.2.2</span> Visualising the distribution of a continuous variable: geom_histogram / geom_density</a></li>
  <li><a href="#visualising-the-distribution-of-a-continuous-variable-across-categories-geom_boxplot-geom_violin" id="toc-visualising-the-distribution-of-a-continuous-variable-across-categories-geom_boxplot-geom_violin" class="nav-link" data-scroll-target="#visualising-the-distribution-of-a-continuous-variable-across-categories-geom_boxplot-geom_violin"><span class="header-section-number">3.2.3</span> Visualising the distribution of a continuous variable across categories: geom_boxplot / geom_violin</a></li>
  <li><a href="#geom_bar-geom_col" id="toc-geom_bar-geom_col" class="nav-link" data-scroll-target="#geom_bar-geom_col"><span class="header-section-number">3.2.4</span> geom_bar / geom_col</a></li>
  <li><a href="#geom_hline-geom_vline" id="toc-geom_hline-geom_vline" class="nav-link" data-scroll-target="#geom_hline-geom_vline"><span class="header-section-number">3.2.5</span> geom_hline / geom_vline</a></li>
  </ul></li>
  <li><a href="#aesthetics-and-scales" id="toc-aesthetics-and-scales" class="nav-link" data-scroll-target="#aesthetics-and-scales"><span class="header-section-number">3.3</span> Aesthetics and scales</a>
  <ul class="collapse">
  <li><a href="#aesthetics" id="toc-aesthetics" class="nav-link" data-scroll-target="#aesthetics"><span class="header-section-number">3.3.1</span> Aesthetics</a></li>
  <li><a href="#combining-multiple-aesthetics" id="toc-combining-multiple-aesthetics" class="nav-link" data-scroll-target="#combining-multiple-aesthetics"><span class="header-section-number">3.3.2</span> Combining multiple aesthetics</a></li>
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales"><span class="header-section-number">3.3.3</span> Scales</a></li>
  <li><a href="#positions" id="toc-positions" class="nav-link" data-scroll-target="#positions"><span class="header-section-number">3.3.4</span> Positions</a></li>
  </ul></li>
  <li><a href="#making-a-plot-pretty" id="toc-making-a-plot-pretty" class="nav-link" data-scroll-target="#making-a-plot-pretty"><span class="header-section-number">3.4</span> Making a plot pretty</a>
  <ul class="collapse">
  <li><a href="#labels-and-text" id="toc-labels-and-text" class="nav-link" data-scroll-target="#labels-and-text"><span class="header-section-number">3.4.1</span> Labels and text</a></li>
  <li><a href="#themes" id="toc-themes" class="nav-link" data-scroll-target="#themes"><span class="header-section-number">3.4.2</span> Themes</a></li>
  <li><a href="#changing-colourssizesshapes" id="toc-changing-colourssizesshapes" class="nav-link" data-scroll-target="#changing-colourssizesshapes"><span class="header-section-number">3.4.3</span> Changing colours/sizes/shapes</a></li>
  </ul></li>
  <li><a href="#making-many-similar-plots-with-facets" id="toc-making-many-similar-plots-with-facets" class="nav-link" data-scroll-target="#making-many-similar-plots-with-facets"><span class="header-section-number">3.5</span> Making many similar plots with facets</a></li>
  <li><a href="#laying-out-multiple-plots-into-a-single-figure" id="toc-laying-out-multiple-plots-into-a-single-figure" class="nav-link" data-scroll-target="#laying-out-multiple-plots-into-a-single-figure"><span class="header-section-number">3.6</span> Laying out multiple plots into a single figure</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">3.7</span> Summary</a>
  <ul class="collapse">
  <li><a href="#practice-questions" id="toc-practice-questions" class="nav-link" data-scroll-target="#practice-questions"><span class="header-section-number">3.7.1</span> Practice questions</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-session03" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Session 3: Plotting with ggplot2</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i></button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this session we will learn how to create and customise plots using the <code>ggplot2</code> package.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="Learning Objectives">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning Objectives
</div>
</div>
<div class="callout-body-container callout-body">
<p>At the end of this session, learners should be able to:</p>
<ol type="1">
<li>Create a ggplot and save it for use outside of R</li>
<li>Describe some of the common ways we can change the appearance of a plot, such as themes, legends and colours.</li>
<li>List some of the common geoms available in ggplot2 and what types of data they might be useful for</li>
<li>Use the <code>facet_wrap</code> function to create a series of similar plots</li>
<li>Understand how to use the <code>patchwork</code> package to compose multiple plots together into a single figure</li>
</ol>
</div>
</div>
<p>To get started, let’s load the <code>tidyverse</code> package, which includes <code>ggplot2</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>And read in the <code>mousezempic_dosage_data</code> that we have been using in previous sessions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mousezempic_dosage_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/mousezempic_dosage_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 344 Columns: 9
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (4): mouse_strain, cage_number, replicate, sex
dbl (5): weight_lost_g, drug_dose_g, tail_length_mm, initial_weight_g, id_num

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<section id="building-our-first-plot-layer-by-layer" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="building-our-first-plot-layer-by-layer"><span class="header-section-number">3.1</span> Building our first plot, layer by layer</h2>
<p>Although R has a built-in plotting system, <code>ggplot2</code> is a more powerful and flexible package for creating plots. The <code>gg</code> in <code>ggplot2</code> stands for “Grammar of Graphics”, which is a way thinking about how each component of a plot (e.g.&nbsp;axes or colours) is part of the ‘language’ of data visualisation that allows you to compose complex plots piece by piece, just like you combine words to form sentences.</p>
<section id="initialisation" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="initialisation"><span class="header-section-number">3.1.1</span> Initialisation</h3>
<p>When making a ggplot, the first thing you need to do is initialise it with the <code>ggplot()</code> function. This function takes two arguments:</p>
<ul>
<li>the <strong>data</strong> that you want to visualise (a dataframe/tibble), and</li>
<li><strong>mapping</strong>, which describes the scales that will be used to display the data (e.g.&nbsp;which variable should be the x axis, which should be represented by colour, etc.)</li>
</ul>
<p>The mapping is specified using the <code>aes()</code> function, which stands for ‘aesthetics’. It takes named arguments, where the names are the aesthetics you want to use to show your data (e.g.&nbsp;<code>x</code>, <code>y</code>, <code>colour</code>, <code>shape</code>, etc.) and the values are the names of the columns in your data that you want to use for those aesthetics.</p>
<p>For example, to make a plot to explore the relationship between the initial weight of the mice and their tail length, we would write:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>In the plot panel (bottom right hand corner), you should now see a blank plot with the x and y axes labelled with the column names we specified in the <code>aes()</code> function. There’s no data on it yet, because we haven’t told ggplot how to physically represent the data on the x and y scales we have specified.</p>
</section>
<section id="adding-data" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="adding-data"><span class="header-section-number">3.1.2</span> Adding data</h3>
<p>Data is represented in ggplot using <strong>geoms</strong> (short for ‘geometric objects’). A geom is a visual representation of the data in the plot, such as points, lines or bars. They are named <code>geom_*</code> where <code>*</code> is the type of geom you want to use. We will cover some of the most common geoms later in this session.</p>
<p>Geoms are added to plots layers (which are drawn on top of one another, like layers of a cake) using the <code>+</code> operator.</p>
<p>For example, let’s add points to the plot that we initialised above using <code>geom_point()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>This gives us a basic scatterplot of the data, with each point representing the tail length and initial weight of a mouse in our dataset.</p>
<p>Notice how we didn’t have to specify the data or mapping again when we added the <code>geom_point()</code> layer, because the data and mapping are inherited from the initial <code>ggplot()</code> function call. This is a common pattern in ggplot2: you only need to specify the data and mapping once, and it is used by all subsequent layers.</p>
<div class="callout callout-style-default callout-note callout-titled" title="The plus `+` vs the pipe `%>%`">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The plus <code>+</code> vs the pipe <code>%&gt;%</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>You might have noticed that <code>+</code> in ggplot works similarly to the pipe operator <code>%&gt;%</code> in the <code>dplyr</code> package in that you place it at the end of a line of code, but <strong><code>+</code> is only ever used in the context of plotting.</strong></p>
<p>Don’t mix them up! A handy way to remember is that <code>+</code> looks a bit like the axes of a plot, so it’s what you should use when plotting.</p>
</div>
</div>
</section>
<section id="overlaying-additional-data" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="overlaying-additional-data"><span class="header-section-number">3.1.3</span> Overlaying additional data</h3>
<p>Of course, this is a very simple plot. To show more information, we can add additional layers using the <code>+</code> operator, or use additional aesthetics.</p>
<p>For example, let’s add a a layer containing a linear trendline using <code>geom_smooth(method = "lm")</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Here, we supplied the <code>method = "lm"</code> argument to <code>geom_smooth()</code> to tell it fit a linear model (lm for short) to the data and plot the line of best fit, surrounded by a 95% confidence interval. Most geoms will have additional arguments like this that you can use to customise their appearance. Remember that we can check the documentation for geoms and other functions using <code>?geom_smooth</code>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="ggplot2 and missing values">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ggplot2 and missing values
</div>
</div>
<div class="callout-body-container callout-body">
<p>You might have noticed that, along with the plot, R is also printing a warning message that lets us know that some rows of our data contain missing values. ggplot2 will automatically remove these rows from the plot (and warn you that it’s happening), but it’s always a good idea to check your data for missing values before plotting it, as they can affect the results of your analysis. Recall from last session that we can do this by combining the <code>is.na()</code> function with <code>filter()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># find the rows of our data that contain missing values in the columns we're plotting</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>mousezempic_dosage_data <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(initial_weight_g), <span class="fu">is.na</span>(tail_length_mm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 9
  mouse_strain cage_number weight_lost_g replicate sex   drug_dose_g
  &lt;chr&gt;        &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;       &lt;dbl&gt;
1 CD-1         1A                     NA rep1      &lt;NA&gt;           NA
2 Black 6      3E                     NA rep3      &lt;NA&gt;           NA
# ℹ 3 more variables: tail_length_mm &lt;dbl&gt;, initial_weight_g &lt;dbl&gt;,
#   id_num &lt;dbl&gt;</code></pre>
</div>
</div>
<p>From here on, we will hide these warnings in the ebook so that it’s easier to read, but you’ll still see them if you run the code in your own R session.</p>
</div>
</div>
<p>We can also add additional aesthetics to the plot beyond just <code>x</code> and <code>y</code>. For example, let’s use the <code>colour</code> aesthetic to represent the strain of each mouse. To do this, we add <code>colour = strain</code> to the <code>aes()</code> function that describes the mapping in the <code>ggplot()</code> call:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Not only are the points now coloured by the strain of each mouse, but there are now three separate colour-coded trendlines, one for each strain. This is because the aesthetic mapping we supply to the <code>ggplot()</code> function when initialising the plot is inherited by <strong>all</strong> subsequent layers/geoms.</p>
<p>Notice as well how adding colour to the plot totally changes the way we perceive the data! Without colour and just plotting a single trendline, it appeared that there was an overall negative association between initial weight and tail length, but we can now see that there is actually a positive association within each strain. This is an example of <a href="https://en.wikipedia.org/wiki/Simpson%27s_paradox">Simpson’s Paradox</a>, and shows why it’s so important to visualise your data!</p>
</section>
<section id="saving-plots-as-images" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="saving-plots-as-images"><span class="header-section-number">3.1.4</span> Saving plots as images</h3>
<p>Once you’re satisfied with the plot you’ve created, you can programmatically save your plot using the <code>ggsave()</code> function.</p>
<p>To use <code>ggsave()</code>, you need to specify:</p>
<ul>
<li>The name of the file to to save the plot as (e.g.&nbsp;<code>"my_plot.png"</code>). Specifying a different file extension, e.g.&nbsp;<code>"my_plot.pdf"</code> will save the plot in the appropriate format.</li>
<li>The plot object you want to save (defaults to the last plot you sent to the plot pane).</li>
<li>The dimensions of the plot (e.g.&nbsp;<code>width = 6, height = 4</code>). Dimensions are in inches by default and can be changed using the <code>units</code> argument (e.g.&nbsp;<code>units = "cm"</code>).</li>
</ul>
<p>For example, to save the last plot we created as a .png file with dimensions of 5 by 7 inches, we would write:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"coloured_scatterplot.png"</span>, <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or to save it as a .pdf file with dimensions of 20 by 30 cm:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"coloured_scatterplot.pdf"</span>, <span class="at">device =</span> <span class="st">"pdf"</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s good practice to assign the plot you want to save to a variable, and provide it to the ‘plot’ argument of <code>ggsave()</code>, rather than relying on the last plot you created. This makes it clear what plot you’re saving, so that your code is more readable and reproducible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first assign the plot to a variable</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>colourful_scatterplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># then save the plot: notice the 'plot' argument</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"coloured_scatterplot.pdf"</span>, <span class="at">plot =</span> colourful_scatterplot, <span class="at">device =</span> <span class="st">"pdf"</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It’s also possible to save plots using the export button in the plot panel: <img src="images/S03F01_export.png" class="img-fluid" alt="You can use the export button to save plots interactively"></p>
<p>You can choose to save the plot either as an image: <img src="images/S03F02_export_image.png" class="img-fluid" alt="Saving an R plot as an image"></p>
<p>In this case, you can set the file type and dimensions, and see a preview of the plot before saving it. Tip: it’s also possible to change the dimensions of the plot by dragging the bottom left of the preview window.</p>
<p>You can also save plots as a PDF: <img src="images/S03F03_export_pdf.png" class="img-fluid" alt="Saving an R plot as a PDF"></p>
<p>Although there is no preview for PDFs within RStudio itself, you can click the ‘preview’ button to open the PDF in your default PDF viewer.</p>
<p>In general, it’s preferable to save plots programmatically using <code>ggsave()</code> because it’s more reproducible (because if you ever change your plotting code or data, new plot files can be automatically generated), but the export button can be useful for quickly saving plots during exploratory data analysis (or use the ultimate lazy hack: just screenshot the plot panel!).</p>
<div class="callout callout-style-default callout-important callout-titled" title="Practice exercises">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice exercises
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try these practice questions to test your understanding</p>
<div class="question">
<p>1. Which of the following statements about the mapping in a ggplot is <strong>incorrect</strong>?</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span>Mapping is specified using the <code>aes()</code> function</p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span>Mapping refers to the type of plot you want to create (e.g.&nbsp;scatterplot, line plot)</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span>When you specify the mapping in the <code>ggplot()</code> function, it is inherited by all subsequent layers/geoms</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span>Mapping allows you to specify which scales (e.g.&nbsp;x, y, colour) should be used to display the data</p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<p>2. Which of the following lines of code is a valid way to create a scatterplot of the drug dosage (x) and weight loss (y) in the <code>mousezempic_dosage_data</code> dataset?</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) %&gt;% geom_point()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, x = drug_dose_g, y = weight_lost_g) + geom_point()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>ggplot2(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g))</code></p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) + geom_point()</code></p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<ol start="3" type="1">
<li>How could you programmatically save the plot created in question 2 as a .pdf file with dimensions of 10 by 15 cm?</li>
</ol>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>ggsave("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15, units = "cm")</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span><code>save("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15, units = "cm")</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>ggsave("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15)</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span><code>ggsave("drug_dosage_vs_weight_loss.pdf", width = 10, height = 15)</code></p><p></p>
</div>
</div>

</div>
</div>
<details>
<summary>
Solutions
</summary>
<ol type="1">
<li>Mapping in ggplot refers to the scales that will be used to display the data (e.g.&nbsp;x, y, colour), not the type of plot you want to create. It is specified using the <code>aes()</code> function, and when specified in the initial <code>ggplot()</code> function call, is inherited by all subsequent layers/geoms.</li>
<li>The correct way to create a scatterplot of the drug dosage and weight loss in the <code>mousezempic_dosage_data</code> dataset is <code>ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) + geom_point()</code>. This specifies the data and mapping in the <code>ggplot()</code> function call, and adds a layer of points to the plot using <code>geom_point()</code>. The <code>%&gt;%</code> operator is not used in ggplot2, and the <code>x</code> and <code>y</code> mapping should be specified within the <code>aes()</code> function. Also, remember that although ggplot2 is the name of the package, the function you use to initialise a plot is <code>ggplot()</code>.</li>
<li>To programmatically save the plot created in question 2 as a .pdf file with dimensions of 10 by 15 cm, you would use the <code>ggsave()</code> function with the arguments <code>ggsave("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15, units = "cm")</code>. This specifies the filename, file type, dimensions, and units of the plot you want to save. Remember that by default, dimensions are in inches (boooo), so you need to specify the units as “cm” to save the plot with dimensions in centimetres.</li>
</ol>
</details>
</div>
</div>
</section>
</section>
<section id="some-commonly-used-geoms" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="some-commonly-used-geoms"><span class="header-section-number">3.2</span> Some commonly used geoms</h2>
<p>ggplot2 has (as of writing) almost 50 different geoms that you can use to represent your data. You can see the full list in the <a href="https://ggplot2.tidyverse.org/reference/#geoms">ggplot2 documentation</a>, but some of the most commonly used geoms include:</p>
<ul>
<li><code>geom_point()</code> for visualising individual data points</li>
<li><code>geom_density()</code> and <code>geom_histogram()</code> for visualising the distribution of a continuous variable</li>
<li><code>geom_violin()</code> and <code>geom_boxplot()</code> for visualising the distribution of a continuous variable <strong>across different categories</strong></li>
<li><code>geom_bar()</code> and <code>geom_col()</code> for making bar plots</li>
<li><code>geom_h/vline()</code> for adding horizontal and vertical lines to a plot</li>
</ul>
<p>In this section, we will briefly cover these geoms and how you might use them to visualise your data. It’s not designed to be an exhaustive list, but hopefully it will help you get started with some of the most common types of plots you might want to create.</p>
<div class="callout callout-style-default callout-note callout-titled" title="How do I make a ... plot in ggplot2?">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
How do I make a … plot in ggplot2?
</div>
</div>
<div class="callout-body-container callout-body">
<p>Often, you might come across a specific type of plot you want to make that is a bit more complex than the basic geoms we’ve covered here. If you know the name of the plot you’re wanting to make, you can often find a tutorial/guide online by googling, or you could ask an AI assistant like ChatGPT. Particularly for specific types of data (e.g.&nbsp;clinical data, phylogenetic data), there are often field-specific packages that provide geoms or functions to make particular types of plots, like the <a href="https://yulab-smu.top/treedata-book/index.html">ggtree package</a> for phylogenetic trees or the <a href="https://rpkgs.datanovia.com/survminer/">survminer package</a> for survival plots.</p>
<p>If the plot doesn’t have a specifc name, you can try to break it down by thinking about the geoms you might need to use to represent the data, or try uploading a picture of a similar plot to ChatGPT.</p>
<p>Whatever method you use, remember to add ‘ggplot2’ to your search query to get the most relevant results, as there are many different plotting packages in R!</p>
</div>
</div>
<section id="visualising-individual-data-points-geom_point" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="visualising-individual-data-points-geom_point"><span class="header-section-number">3.2.1</span> Visualising individual data points: geom_point</h3>
<p>Above, we saw how to use <code>geom_point()</code> to create a scatterplot, but <code>geom_point()</code> can be used in other ways too. For example, you can use it to create a dot plot, where the x axis is categorical and the y axis is continuous:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a dot plot of initial weight by mouse strain</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remember we add layers to a plot with +</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how the points are stacked on top of one another for each strain. This is because the x axis is categorical, and ggplot2 doesn’t know how to spread the points out. This can make it difficult to see the individual points, so when making a plot like this it’s often useful to add the <code>position = position_jitter()</code> argument to <code>geom_point()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a jittered dot plot of initial weight by mouse strain</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>The <code>position_jitter()</code> function adds a small amount of random noise to the x axis position of each point, which helps to spread them out and make it easier to see the individual points. Like most functions in ggplot2, <code>position_jitter()</code> will try to guess an appropriate amount of jitter to add, but you can specify the amount as well:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use less jitter so there is more distinction between the different mouse strains</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>The exact amount of jitter you need will depend heavily on your data, so it’s often a good idea to experiment with different amounts to see what works best.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Beeswarm plots">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Beeswarm plots
</div>
</div>
<div class="callout-body-container callout-body">
<p>Another way to spread out points in a dot plot is to use a beeswarm plot, in which points are spread out slightly along the x axis so that they don’t overlap. The <code>ggbeeswarm</code> package provides a <code>geom_beeswarm()</code> function that you can use to create beeswarm plots in ggplot2 (rather than using <code>geom_point(position = position_jitter())</code> like we did here). For more information, see the <a href="https://github.com/eclarke/ggbeeswarm/blob/main/README.md">ggbeeswarm documentation</a>.</p>
</div>
</div>
<p>Beyond just scatterplots and dot plots, <code>geom_point()</code> is also really useful to overlay additional data on top of other geoms. For example, you can use it to add individual data points to a boxplot or violin plot, as we will see shortly!</p>
</section>
<section id="visualising-the-distribution-of-a-continuous-variable-geom_histogram-geom_density" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="visualising-the-distribution-of-a-continuous-variable-geom_histogram-geom_density"><span class="header-section-number">3.2.2</span> Visualising the distribution of a continuous variable: geom_histogram / geom_density</h3>
<p>As the number of data points increases, it can be difficult to see individual points. In this case, it can be useful to visualise the distribution of a continuous variable using a histogram or density plot.</p>
<p>Histograms are created using the <code>geom_histogram()</code> function. Seeing as only a single variable is being plotted, you only need to specify the <code>x</code> aesthetic in the <code>aes()</code> function.</p>
<p>For example, let’s create a histogram of the initial weight of the mice:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>One of the most important arguments to <code>geom_histogram()</code> is the <code>bins</code> argument, which specifies the number of bins (bars) to use for the histogram. By default, it is 30, but you might want a smaller or larger value depending on the distribution of your data. For example, let’s create a histogram with 15 bins:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Similarly to histograms, density plots are also used to visualise the distribution of a continuous variable, but they are smoothed out. To create a density plot in ggplot2, you can use the <code>geom_density()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how the density plot is smoothed out compared to the histogram, and it is also scaled so that the area under the curve is equal to 1. This means that the y axis of a density plot represents the probability density of the data, rather than the count of data points in each bin.</p>
</section>
<section id="visualising-the-distribution-of-a-continuous-variable-across-categories-geom_boxplot-geom_violin" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="visualising-the-distribution-of-a-continuous-variable-across-categories-geom_boxplot-geom_violin"><span class="header-section-number">3.2.3</span> Visualising the distribution of a continuous variable across categories: geom_boxplot / geom_violin</h3>
<p>Often in biological data, you will want to visualise the distribution of a continuous variable across different categories. For example, we might want to see how the initial weight of the mice varies by strain. Two plot types that are useful for this are boxplots and violin plots.</p>
<p>Boxplots allow you to easily see the median, quartiles, and any outliers in the data. To create a boxplot win ggplot2, you can use the <code>geom_boxplot()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>It can sometimes be nice to add points to a boxplot to show the individual data points as well as the summary statistics. You can do this by adding a <code>geom_point()</code> layer to the plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows the distribution of initial weight for each strain (with the boxplot), as well as the individual data points. Notice how the points are jittered to avoid overlapping, as we did earlier with the dot plot.</p>
<p>However, when you have a lot of data points (as we do here), a boxplot with overlaid points can be a bit messy and hard to read. In this case, it might be better to use a violin plot instead, which shows the distribution of the data as a density plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>You can even combine <code>geom_violin()</code> with <code>geom_boxplot()</code> to show both the distribution of the data and the summary statistics:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how we specified the <code>width</code> argument in <code>geom_boxplot()</code> to make the boxplot narrower, so that it doesn’t obscure the violin plot.</p>
</section>
<section id="geom_bar-geom_col" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="geom_bar-geom_col"><span class="header-section-number">3.2.4</span> geom_bar / geom_col</h3>
<p>The last pair of basic geoms we’ll cover are <code>geom_bar()</code> and <code>geom_col()</code>, which are used to create bar plots. These are handy for visualising categorical data, such as the number of mice in each strain or the average weight loss for each dosage.</p>
<p><code>geom_bar()</code> is used to create bar plots from counts of categorical data, while <code>geom_col()</code> is used to create bar plots from pre-computed values. This means that if you have already calculated the counts or averages for each category, you should use <code>geom_col()</code> instead of <code>geom_bar()</code>.</p>
<p>For example, if we wanted to create a bar plot of the number of mice in each strain with <code>geom_col()</code>, we would first need to calculate the counts for each strain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first count the number of mice per strain</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mouse_counts <span class="ot">&lt;-</span> mousezempic_dosage_data <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mouse_strain) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># then create the bar plot</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mouse_counts,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Whereas if we used <code>geom_bar()</code>, we would not need to calculate the counts first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how we only specified the <code>x</code> aesthetic in the <code>aes()</code> function, and <code>geom_bar()</code> automatically calculated the counts for each strain.</p>
<p>The advantage of using <code>geom_bar()</code> is that it is simpler and easier to read for plotting counts, but it can’t be used for plotting pre-computed values. For example, if you wanted to plot the average weight loss for each strain, you would need to calculate the averages first with the dplyr functions we learned in <a href="session_2.html" class="quarto-xref"><span>Chapter 2</span></a> and use <code>geom_col()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first calculate the average weight loss for each strain</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>mouse_avg_weight_loss <span class="ot">&lt;-</span> mousezempic_dosage_data <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mouse_strain) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_weight_loss =</span> <span class="fu">mean</span>(weight_lost_g))</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="co"># then create the bar plot</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mouse_avg_weight_loss,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> avg_weight_loss)) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_col()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<!-- ### geom_line
Idk how useful geom_line is ? i feel like i use density more often
As the name suggests, `geom_line()` is used to create line plots. These are useful for showing trends over time or across a continuous variable. Since we don't have a time variable in our dataset, let's use the `drug_dosage` variable to show how weight loss changes with increasing dosage:


::: {.cell}

```{.r .cell-code}
ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +
  geom_line()
```

::: {.cell-output-display}
![](session_3_files/figure-html/unnamed-chunk-24-1.png){width=2000}
:::
:::

(In reality the relationship between these variables is probably better represented as points on a scatterplot rather than as a line, but this is just an example of how you can use `geom_line()`).

It's also possible to combine `geom_line()` with `geom_point()` to show the individual data points as well as the connection between them:


::: {.cell}

```{.r .cell-code}
ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +
  geom_line() +
  geom_point()
```

::: {.cell-output-display}
![](session_3_files/figure-html/unnamed-chunk-25-1.png){width=2000}
:::
:::

 -->
</section>
<section id="geom_hline-geom_vline" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="geom_hline-geom_vline"><span class="header-section-number">3.2.5</span> geom_hline / geom_vline</h3>
<p>The <code>geom_hline()</code> and <code>geom_vline()</code> functions are used to add horizontal and vertical lines to a plot, respectively. Although you’ll probably never use them alone, they are great to add to your plots to highlight specific values or thresholds in your data. To use them, you need to specify the <code>yintercept</code> (for <code>geom_hline()</code>) or <code>xintercept</code> (for <code>geom_vline()</code>) argument, which specifies where to draw the line.</p>
<p>For example, let’s add a horizontal line to our scatterplot of drug dosage and weight loss at the 4g mark, which might represent a clinically significant amount of weight loss:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>We could also add a vertical line at the 0.0025g mark to show the theorectical maximum dosage of the drug:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how adding this line extends the x axis to include 0.0025, even though there are no data points at that value. This is because, by default, ggplot2 chooses axes limits for you that include all the data and any additional layers you add to the plot.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Practice exercises">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice exercises
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try these practice questions to test your understanding</p>
<div class="question">
<p>1. Which geom could you use to create a boxplot?</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>geom_boxplot()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span><code>geom_box()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>geom_col()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span><code>geom_violin()</code></p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<p>2. Which of the following lines of code is a valid way to create a violin plot of the tail length of the mice by strain, with points overlaid?</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin(geom_point(position = position_jitter(width = 0.2)))</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_point(position = position_jitter(width = 0.2))</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin()</code></p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin() + geom_point(position = position_jitter(width = 0.2))</code></p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<ol start="3" type="1">
<li>What does this code do?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span>Makes a box plot of the number of mice in each cage, with a horizontal line at 60.</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span>Makes a bar plot of the number of cages in the dataset, with a horizontal line at 60.</p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span>Makes a bar plot of the number of mice in each cage, with a horizontal line at 60.</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span>Makes a bar plot of the number of mice in each cage</p><p></p>
</div>
</div>

</div>
</div>
<details>
<summary>
Solutions
</summary>
<ol type="1">
<li>The correct answer is <code>geom_boxplot()</code>. This is the function used to create boxplots in ggplot2.</li>
<li>The correct way to create a violin plot of the tail length of the mice by strain, with points overlaid, is <code>ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin() + geom_point(position = position_jitter(width = 0.2))</code>. This specifies the data and mapping in the <code>ggplot()</code> function call, adds a layer of violin plots using <code>geom_violin()</code>, and then adds a layer of points using <code>geom_point()</code> with jittered positions to avoid overlapping.</li>
<li>The code creates a bar plot of the number of mice in each cage, with a horizontal line at 60. The <code>geom_bar()</code> function counts the number of mice in each cage and plots the counts as bars, while the <code>geom_hline()</code> function adds a horizontal line at the y value of 60. This could be used to show a threshold e.g.&nbsp;for the maximum number of mice allowed in a cage.</li>
</ol>
</details>
</div>
</div>
</section>
</section>
<section id="aesthetics-and-scales" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="aesthetics-and-scales"><span class="header-section-number">3.3</span> Aesthetics and scales</h2>
<p>Now that we’ve learned some of the common geoms we can use to physically represent our data, let’s discuss the aesthetics that govern how these geoms look and the scales that map our data to these aesthetics.</p>
<section id="aesthetics" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="aesthetics"><span class="header-section-number">3.3.1</span> Aesthetics</h3>
<p>As described earlier, aesthetics are the visual properties of the geoms that we can control, such as colour, position, size and shape. We saw how the <code>colour</code> aesthetic could be used in all layers of the plot to show the strain of each mouse, by specifying <code>colour = mouse_strain</code> in the <code>aes()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>It’s also possible to specify aesthetics for specific geoms, rather than for the whole plot. For example, let’s say we wanted to colour the points by mouse strain, but just have a single trendline for all of the data (rather than one for each strain, like we have above). We could do this by specifying the <code>colour</code> aesthetic in the <code>geom_point()</code> layer, rather than in the <code>ggplot()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>This allows us to have different aesthetics for different layers of the plot, giving us the power to create some really complex visualisations.</p>
<p>Different geoms can accept different aesthetics. For example, let’s try using the <code>colour</code> aesthetic to colour a boxplot of tail length by mouse strain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how the outline of the boxplot is coloured by strain, but the fill is not. For geoms that show an area of some sort (like boxplots, histograms, violin plots or bar charts), they have both a <code>colour</code> aesthetic that controls the colour of the outline of the shape, and a <code>fill</code> aesthetic that controls the fill colour. So if we wanted the boxplot to be filled with the colour of the strain, we should use the <code>fill</code> aesthetic instead:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> tail_length_mm, <span class="at">fill =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>You can see all of the aesthetics that a geom accepts by checking its help page (e.g.&nbsp;<code>?geom_boxplot</code>) and reading the “Aesthetics” section.</p>
</section>
<section id="combining-multiple-aesthetics" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="combining-multiple-aesthetics"><span class="header-section-number">3.3.2</span> Combining multiple aesthetics</h3>
<p>Notice how in the last example, we used mapped the same variable (<code>mouse_strain</code>) to both the <code>x</code> and <code>fill</code> aesthetics. It’s often helpful to show the same variable through multiple aesthetics, as it can convey the information more clearly. As another example, for the scatterplot example we used earlier, we could also use the <code>shape</code> aesthetic to show the strain of each mouse:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain, <span class="at">shape =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Now we can see the strain of each mouse through both colour and shape, which makes it even easier to distinguish between the different strains.</p>
<p>Of course, we may instead want to use aesthetics to add additional variables to our visualisation. To illustrate this, let’s make a scatterplot that visualises the initial weight and tail length of each mouse, but also shows the drug dosage, cage number and mouse strain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">size =</span> drug_dose_g, <span class="at">colour =</span> mouse_strain, <span class="at">shape =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Looks pretty crazy right? There’s no limit to the number of aesthetics you can use in a single plot, but it’s important to remember that the more aesthetics you add, the harder it is to interpret. Try to keep it simple and only add aesthetics that are necessary to convey key information.</p>
</section>
<section id="scales" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="scales"><span class="header-section-number">3.3.3</span> Scales</h3>
<p>Scales control how particular data values/variables are mapped to aesthetics. For example, when we specify <code>colour = mouse_strain</code>, ggplot2 automatically chooses a colour palette to use for each strain. Scales are specified using the <code>scale_*</code> functions, where <code>*</code> is the name of the aesthetic you want to control (e.g.&nbsp;<code>scale_colour</code>, <code>scale_size</code>, etc.) and the arguments control how data will be visually represented e.g.&nbsp;the colour palette used for the <code>colour</code> aesthetic, or the range of size of the points for the <code>size</code> aesthetic. You add scale functions to your plot using the <code>+</code> operator, just like you do with geoms.</p>
<section id="colours" class="level4" data-number="3.3.3.1">
<h4 data-number="3.3.3.1" class="anchored" data-anchor-id="colours"><span class="header-section-number">3.3.3.1</span> Colours</h4>
<p>One thing you’ll often want to do is change the colour palette. You can do this manually, using either the <code>scale_colour_manual()</code> function (for categorical variables) or the <code>scale_colour_gradient()</code> function (for continuous variables). For example, if we wanted to use a different colour palette for the mouse strains in our scatterplot, we would use <code>scale_colour_manual()</code> as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>When using <code>scale_colour_manual()</code>, you need to provide to the <code>values</code> argument a vector of colours that matches the number of levels in the variable you’re mapping to colour. In the example above, we have three mouse strains, so we need to provide three colours in the <code>values</code> argument.</p>
<p>R has a range of built-in colours that you can use, such as “red”, “blue”, “green”, etc., but you can also use <a href="https://www.w3schools.com/html/html_colors_hex.asp">hex codes</a> to specify colours:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#f45c2e"</span>, <span class="st">"#912247"</span>, <span class="st">"#039f22"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Colour highlighting in RStudio">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Colour highlighting in RStudio
</div>
</div>
<div class="callout-body-container callout-body">
<p>To help you see the colours you’re using, RStudio will highlight the colour names and hex codes when you type them in your R script panel:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/S03F04_colours.png" class="img-fluid figure-img"></p>
<figcaption>RStudio colour highlighting</figcaption>
</figure>
</div>
<p>If it doesn’t do this automatically, you can turn it on by going to <code>Tools</code> &gt; <code>Global Options</code> &gt; <code>Code</code> &gt; <code>Display</code> and checking the “Enable preview of named and hexadecimal colours” option.</p>
</div>
</div>
<p>So far, we’ve only used colour to visualise categorical variables, but it can also be used to visualise continuous variables. As an example, let’s colour each point in our scatterplot of initial weight and tail length by the drug dosage:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> drug_dose_g)) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>The points are now coloured based on the drug dosage, using a default gradient of blue colours. You can change the colour of the gradient using the <code>scale_colour_gradient()</code> function, which allows you to specify the colours to use for the low and high ends of the gradient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> drug_dose_g)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_gradient</span>(<span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>We now have a gradient from yellow to red.</p>
<p>Instead of specifying colours manually, there are also a range of pre-defined colour palettes you can use, such as <code>scale_colour_brewer()</code> or <code>scale_colour_viridis()</code>. Check out their help pages to learn more about them, or try the <a href="https://r-graph-gallery.com/package/paletteer.html">paleteer package</a> for a huge range of other pre-defined colour palettes.</p>
</section>
<section id="the-x-and-y-axes" class="level4" data-number="3.3.3.2">
<h4 data-number="3.3.3.2" class="anchored" data-anchor-id="the-x-and-y-axes"><span class="header-section-number">3.3.3.2</span> The x and y axes</h4>
<p>Scales are also used to control the x and y axes. In particular, it can be handy to specify the limits of the axes, or to apply some sort of transformation to the data.</p>
<p>By default, ggplot2 will automatically choose the limits of the x and y axes based on the data you provide. For example, look at the scatterplots of initial weight and tail length we created earlier, and you’ll see that the origin (0,0) is not shown because there are no data points near there. If we wanted to, we could change the limits of the axes using the <code>xlim()</code> and <code>ylim()</code> functions to include the origin:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify axis limits like xlim(min, max)</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if we want to use the automatic limit, use NA instead of a max value</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how different this makes the plot look! Choosing appropriate axis limits is important for accurately conveying the data, so it’s worth spending some time thinking about what limits to use.</p>
<p>By default, ggplot2 uses a linear scale for both axes, but you can change this to a logarithmic scale using the <code>scale_x_log10()</code> or <code>scale_y_log10()</code> functions. This is useful when you have data that spans several orders of magnitude.</p>
<p>We don’t have anything like this in our <code>mousezempic_dosage_data</code> dataset, so let’s use the <code>diamonds</code> dataset that comes with ggplot2 to demonstrate this. The <code>diamonds</code> dataset contains information about the price and carat weight of diamonds, both of which are continuous variables that span several orders of magnitude. Let’s create a scatterplot of the price and carat of the diamonds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">y =</span> price, <span class="at">x =</span> carat)) <span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>To linearise this relationship, we can apply a log10 transformation to the x and y axes using the <code>scale_x_log10()</code> and <code>scale_y_log10()</code> functions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">y =</span> price, <span class="at">x =</span> carat)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how the points are now more evenly distributed across the plot, and we can see the relationship between carat and price more clearly.</p>
</section>
</section>
<section id="positions" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="positions"><span class="header-section-number">3.3.4</span> Positions</h3>
<p>Positions aren’t really an aesthetic, but they are a way to control how geoms are displayed, particularly when parts of that geom overlap. We saw the position argument earlier in the <code>geom_point()</code> function, where we used <code>position = position_jitter()</code> to spread out the points in a dot plot. This is a common use of the position argument, but there are other ways it is helpful too.</p>
<p>For example, when we are using <code>geom_bar()</code> to create a bar plot that is coloured by a categorical variable, the bars will be stacked on top of each other by default. Let’s illustrate this by creating a bar plot of the number of mice in each strain, coloured by the sex of the mouse:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Having the bars stacked up is useful when you want to see the total count for each strain, but it can make it difficult to see the individual counts for sex. Instead, we can use the <code>position = "dodge"</code> argument in <code>geom_bar()</code> to place the bars side by side:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how there is now a bar for each sex in each strain, and it’s easier to examine the sex distribution of each strain (but equally harder to appreciate the total number of mice in each strain!). There’s no right or wrong way to lay out the bars, but it’s worth trying both and seeing which one works best for the message you want to convey.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Practice exercises">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice exercises
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try these practice questions to test your understanding</p>
<div class="question">
<p>1. What kind of plot would the following code make?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span>A violin plot of tail length by mouse strain, with points overlaid</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span>A violin plot of tail length by mouse strain, with points overlaid. The points are jittered to avoid overlapping. The points and the violin plots are both coloured by mouse strain.</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span>A dot plot of tail length by mouse strain. The points are jittered to avoid overlapping and are coloured by mouse strain.</p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span>A violin plot of tail length by mouse strain, with points overlaid. The points are jittered to avoid overlapping and are coloured by mouse strain. The violin plot is not coloured.</p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<p>2. I would like to make a scatterplot of initial weight and tail length, but I also want to show the weight lost by each mouse using colour with the viridis palette. Which of the following lines of code would do this?</p>
<p>Hint: You can use the <code>scale_colour_viridis_c()</code> function to apply the viridis colour palette to a continuous variable.</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point() + scale_colour_viridis_c()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + scale_colour_viridis_c()</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point(scale_colour_viridis_c())</code></p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<p>3. How can I make a histogram of the tail length of the mice, with 10 bins and coloured by mouse strain, with the different strains side by side?</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10)</code></p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10, position = "dodge")</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10, position = "stack")</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm)) + geom_histogram(bins = 10)</code></p><p></p>
</div>
</div>

</div>
</div>
<details>
<summary>
Solutions
</summary>
<ol type="1">
<li><p>The correct answer is “A violin plot of tail length by mouse strain, with points overlaid. The points are jittered to avoid overlapping and are coloured by mouse strain. The violin plot is not coloured.” Note that because we specified the <code>aes(colour = mouse_strain)</code> argument within <code>geom_point()</code> and not in the <code>ggplot()</code> function, <strong>only the points will be coloured by mouse strain</strong>, while the violin plot will not be coloured.</p></li>
<li><p>The correct answer is <code>ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point() + scale_colour_viridis_c()</code>. This code creates a scatterplot of initial weight and tail length, with the points coloured by weight lost using the viridis colour palette. Remember that we add scales to the plot using the <code>+</code> operator, just like we do with geoms, and that we need to specify the <code>colour</code> aesthetic in the <code>aes()</code> function to map the weight lost to colour.</p></li>
<li><p>The correct answer is <code>ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10, position = "dodge")</code>. Remember that the <code>position = "dodge"</code> argument in <code>geom_histogram()</code> specifies that the bars should be placed side by side rather than stacked on top of each other (the default behaviour). Also note that histograms, like bar plots, use the <code>fill</code> aesthetic to colour the entire bars (the <code>colour</code> aesthetic is only used to colour the outline of the bars).</p></li>
</ol>
</details>
</div>
</div>
</section>
</section>
<section id="making-a-plot-pretty" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="making-a-plot-pretty"><span class="header-section-number">3.4</span> Making a plot pretty</h2>
<p>Now that we’ve covered the basics of creating plots in ggplot2, let’s talk about how to make them look good! Of course there are countless ways to customise the appearance of a plot in ggplot2. We’ll cover a few of the most common ones here to give you a starting point, but if you’re wanting to do something specific, you can often find a solution online, by using AI or by <a href="https://ggplot2-book.org/themes.html">reading the ggplot2 documentation</a>.</p>
<section id="labels-and-text" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="labels-and-text"><span class="header-section-number">3.4.1</span> Labels and text</h3>
<p>One thing you’ll want to do is add labels to your plot, such as a title, axis labels and/or a caption. You can do this quickly and easily with the <code>labs()</code> function. For example, let’s add labels to our scatterplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add labels to the plot</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data from the mousezempic_dosage_data dataset"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>You don’t need to specify all of these labels (just omit the ones you don’t want).</p>
<p>It’s also possible to change the way that the axes are labelled. You can do this by adding the <code>labels</code> argument to the appropriate x or y scale functions. For example, if we made the following plot of drug dosage and weight loss:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>We could use the <code>scale_x_continuous()</code> function to label the x axis in scientific notation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_scientific</span>()) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between drug dosage and weight loss"</span>,</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="Accessing functions using ::">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Accessing functions using ::
</div>
</div>
<div class="callout-body-container callout-body">
<p>You may have noticed that we used <code>scales::label_scientific()</code> to access the <code>label_scientific()</code> function. This is because we haven’t loaded <code>scales</code> package (i.e.&nbsp;we haven’t run <code>library(scales)</code>), so we need to specify the package name to access the function. You can do this for any function in R by using the <code>package::function()</code> syntax.</p>
<p>This is useful when you only need one function from a package, although if you need to use a lot of different functions (like we do with the tidyverse packages in this course), it’s easier to load the package with <code>library()</code> instead.</p>
</div>
</div>
<p>There are a range of other functions you can use to label the axes, beyond just <code>scales::label_scientific()</code>. One that is particularly handy is <code>scales::label_comma()</code> which adds commas to large numbers (rather than using scientific notation, e.g.&nbsp;1,000,000 instead of 1e6) so that they are easier to read. You can check out the full list of label functions in the <a href="https://ggplot2-book.org/scales-position.html#sec-position-continuous-labels">ggplot2 book</a>.</p>
</section>
<section id="themes" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="themes"><span class="header-section-number">3.4.2</span> Themes</h3>
<p>Themes are a way to control the non-data appearance of a plot (e.g.&nbsp;font, background colour, grid lines, etc.)</p>
<p>There are a number of pre-set theme functions in ggplot2, such as <code>theme_bw()</code>, <code>theme_minimal()</code> and <code>theme_classic()</code>. You can add these to your plot with the <code>+</code> operator to quickly change its appearance. For example, let’s use the <code>theme_minimal()</code> function to create a scatterplot with a simple white background:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>One common edit you might want to make to a theme is to change the font size, so that the text is easier to read. You can do this by setting the <code>base_size</code> argument in the <code>theme_*()</code> function. For example, let’s increase the font size in our previous plot to 16 points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>To modify other parts of the theme, you can use the <code>theme()</code> function to specify the elements you want to change. Make sure you put the <code>theme()</code> function after your theme preset, if any (e.g.&nbsp;<code>theme_minimal()</code>) as it will override the default settings.</p>
<p>There are more than 40 different plot elements you can modify using the <code>theme()</code> function, such as <code>axis.text</code>, <code>axis.title</code>, <code>plot.title</code>, <code>legend.position</code>, etc. It’s impossible to remember them all, so you can refer to the <a href="https://ggplot2-book.org/themes.html#sec-theme-elements">ggplot2 documentation</a>, search online or ask ChatGPT.</p>
<p>In general though, to set the value of a plot element, you need to know its name, and the name of the function that sets it. Usually this will be <code>element_text()</code> (for text), <code>element_line()</code> (for lines) or <code>element_rect()</code> (for rectangles). As an example, let’s change the colour of our plot title to red, make it bold size 20 and change the plot background colour to pink:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a title to the plot</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between initial weight &amp; tail length"</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># place the theme function after the theme preset</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># use setting functions like element_text() to set the value of a plot element</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"pink"</span>)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>If your plot has a legend, you can also modify its appearance using the <code>theme()</code> function. For example, in our colour-coded scatterplot of tail length and initial weight, let’s move it to the bottom of the plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>You can remove the legend altogether by setting <code>legend.position = "none"</code> in the <code>theme()</code> function. This is useful when you have a lot of data points and the legend takes up too much space, or when the legend is not needed to interpret the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="changing-colourssizesshapes" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="changing-colourssizesshapes"><span class="header-section-number">3.4.3</span> Changing colours/sizes/shapes</h3>
<p>Earlier, we saw how to map variables in our data to aesthetics like colour, size and shape. But you can also set these aesthetics manually to make the plot prettier, rather than to show something about the data. For example, if we wanted to make all the points in our scatterplot violet, we could do this by setting the <code>colour</code> aesthetic directly in the <code>geom_point()</code> layer, rather than in the <code>aes()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"violet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>This will make all the points violet, regardless of the strain of the mouse. You can do this for any aesthetic, such as size or shape. For example, let’s make all the points in our scatterplot size 3 and shape 17:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">colour =</span> <span class="st">"violet"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Now, all of our plots have changed to violet triangles! <a href="https://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r">You can see the full list of point shapes here</a> to help you customise your plot.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Practice exercises">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice exercises
</div>
</div>
<div class="callout-body-container callout-body">
<div class="question">
<p>1. I’ve made the following plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> weight_lost_g, <span class="at">fill =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Which of the following could I use to add labels to the plot?</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>labs(title = "Weight lost by cage number and mouse strain", x = "Cage number", y = "Weight lost (g)")</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span><code>labels(title = "Weight lost by cage number and mouse strain", x = "Cage number", y = "Weight lost (g)")</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>labels(title = "Weight lost", x = "Cage number", y = "Weight lost (g)")</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span><code>labels(x = "Cage number", y = "Weight lost (g)")</code></p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<p>2. I’m trying to change move my plot legend to the top and change the font of my title to bold, but it’s not working. What am I doing wrong?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span>You need to use the pipe operator to combine the two <code>theme()</code> functions</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span>You can’t use the <code>theme_bw()</code> function and the <code>theme()</code> function in the same plot</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span>You need to specify the <code>legend.position</code> and <code>plot.title</code> arguments in the <code>theme_bw()</code> function, not the <code>theme()</code> function.</p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span>You need to put the <code>theme()</code> function after the <code>theme_bw()</code> function, because currently the <code>theme_bw()</code> function is overriding the <code>theme()</code> function.</p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<p>3. I have the following code to make a boxplot of the initial weight of the mice by strain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>How can I add points over the top of the boxplot, that are jittered to avoid overlap, size 0.5 and square shaped? Hint: find the shape number for squares <a href="https://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r">here</a>.</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span>Add <code>geom_point(position = position_jitter(width = 0.2))</code> to the plot code above with the <code>+</code> operator and specify the size and shape in the <code>aes()</code> function</p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span>Add <code>geom_point(size = 0.5, shape = 15, position = position_jitter(width = 0.2))</code> to the plot code above with the <code>+</code> operator</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span>It’s not possible to add points to a boxplot</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span>Add <code>geom_point()</code> to the plot code above with the <code>+</code> operator</p><p></p>
</div>
</div>

</div>
</div>
<details>
<summary>
Solutions
</summary>
<p>
</p><ol type="1">
<li>The correct answer is <code>labs(title = "Weight lost by cage number and mouse strain", x = "Cage number", y = "Weight lost (g)")</code>. This will add a title and axis labels to the plot. The <code>labels()</code> function does not exist in ggplot2, so the second option is incorrect. The third and fourth options are also incorrect because they do not include an title informative title.</li>
<li>The correct answer is “You need to put the <code>theme()</code> function after the <code>theme_bw()</code> function, because currently the <code>theme_bw()</code> function is overriding the <code>theme()</code> function.” The <code>theme_bw()</code> function sets the default theme for the plot, so if you want to modify it, you need to put the <code>theme()</code> function after it. The other options are incorrect because you can use the <code>theme()</code> function and the <code>theme_bw()</code> function together, and you don’t need to specify the <code>legend.position</code> and <code>plot.title</code> arguments in the <code>theme_bw()</code> function. You always use <code>+</code> when adding a new layer to a plot, so you don’t need to use the pipe operator.</li>
<li>The correct answer is “Add <code>geom_point(size = 0.5, shape = 15, position = position_jitter(width = 0.2))</code> to the plot code above with the <code>+</code> operator.” This will add points to the boxplot that are size 0.5 and square shaped. The first option is incorrect because you need to specify the size and shape in the <code>geom_point()</code> function, not in the <code>aes()</code> function (as the size and shape here don’t represent anything in the data, they are just used to style the plot). The third option is incorrect because it is possible to add points to a boxplot, and the fourth option is incorrect because it does not specify the size or shape of the points, or the jitter.</li>
</ol>
<p></p>
</details>
</div>
</div>
</section>
</section>
<section id="making-many-similar-plots-with-facets" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="making-many-similar-plots-with-facets"><span class="header-section-number">3.5</span> Making many similar plots with facets</h2>
<p>Faceting is a powerful way to create multiple plots that each show subsets of your data. This is useful when you want to compare different groups or categories.</p>
<p>Before, we saw how to do this by using aesthetics such as colour to distinguish between groups. For example, let’s consider the relationship between weight lost and drug dosage in our <code>mousezempic_dosage_data</code> dataset. We could use what we’ve learned so far to create a scatterplot of weight lost vs drug dosage, and colour the points by mouse strain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Notice how the points for the CD-1 and BALB/c strains are sitting pretty much on top of each other. This makes it difficult to see the differences between the strains, so it might be better to create separate plots for each strain. This is where faceting comes in!</p>
<p>When we want to facet our data by a single variable, we can use the <code>facet_wrap()</code> function. This will create a series of plots, with each plot showing a different subset of the data according to that variable.</p>
<p>Let’s repeat our previous plot, but this time we’ll facet it by mouse strain:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mouse_strain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>You use the facet_wrap() function by specifying the variable you want to facet by with a <code>~</code>.</p>
<p>By default, all of the facets will have the same x and y axis limits, which is useful when you want to compare the data across all of them. However, if you want to allow each facet to have its own x and y axis limits, you can set the <code>scales</code> argument to <code>"free"</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mouse_strain, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>This makes it easier to see patterns within each strain, but it makes it harder to compare the strains to each other. So it’s a trade-off between clarity and comparability.</p>
<p>Two other useful arguments to <code>facet_wrap()</code> are <code>nrow</code> and <code>ncol</code>, which allow you to specify the number of rows or columns to use for the facets. For example, if we wanted our three facets to be arranged in a single column, we could set <code>ncol = 1</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mouse_strain, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Play around with different layouts to see what works best for your data!</p>
<p>It’s also possible to facet by two variables, using the <code>facet_grid()</code> function. In this case, you need to specify the two column names to facet by, separated by a <code>~</code>. For example, if we wanted to facet our previous plot by both mouse strain and cage number, we could do this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain and cage number</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(mouse_strain <span class="sc">~</span> cage_number)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>There is now a separate plot for each combination of mouse strain and cage number. Notice how some of the plots are empty, because there are no data points for that combination of mouse strain and cage number.</p>
<div class="callout callout-style-default callout-important callout-titled" title="Practice exercises">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice exercises
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try these practice questions to test your understanding</p>
<div class="question">
<p>1. Using the <code>mtcars</code> dataset, create a scatterplot of <code>mpg</code> vs <code>hp</code>, faceted by <code>cyl</code>, with the same x and y axes across each facet.</p>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(hp ~ mpg)</code></p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span><code>ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(~ cyl)</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(~ hp)</code></p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no4"> <span id="no4" x-show="answer == $el.id" class="badge">✗</span><code>ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_grid(~ cyl)</code></p><p></p>
</div>
</div>

</div>
</div>
<div class="question">
<p>2. What does the following code do?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(mouse_strain <span class="sc">~</span> sex, <span class="at">scales =</span> <span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="choices">
<div x-data="{ answer: '' , clear() { this.answer = '' }}">

<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no1"> <span id="no1" x-show="answer == $el.id" class="badge">✗</span>Creates a scatterplot of the tail length for each unique combination of ‘sex’ and ‘mouse strain’, with the y axis limits set independently for each facet.</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no2"> <span id="no2" x-show="answer == $el.id" class="badge">✗</span>Creates a boxplot of the tail length for each unique combination of ‘sex’ and ‘mouse strain’.</p><p></p>
</div>
<div class="choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="no3"> <span id="no3" x-show="answer == $el.id" class="badge">✗</span>Creates boxplots of the tail length of mice, in mm.</p><p></p>
</div>
<div class="choice correct-choice">
<p></p><p><input class="form-check-input" type="radio" x-model="answer" value="correct"> <span id="correct" x-show="answer == $el.id" class="badge">✔</span>Creates a boxplot of the tail length for each unique combination of ‘sex’ and ‘mouse strain’, with the y axis limits set independently for each facet.</p><p></p>
</div>
</div>

</div>
</div>
<details>
<summary>
Solutions
</summary>
<p>
</p><ol type="1">
<li>The correct answer is <code>ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(~ cyl)</code>. This code creates a scatterplot of <code>mpg</code> vs <code>hp</code>, faceted by <code>cyl</code>, with the same x and y axes across each facet. The other options are incorrect because they either use the wrong variable to facet by or use the wrong function to create the facets (since we are faceting by a single variable, we should use <code>facet_wrap()</code>).</li>
<li>This code creates a boxplot of the tail length for each unique combination of ‘sex’ and ‘mouse strain’, with the y axis limits set independently for each facet (with the <code>scales = "free"</code> argument).</li>
</ol>
<p></p>
</details>
</div>
</div>
</section>
<section id="laying-out-multiple-plots-into-a-single-figure" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="laying-out-multiple-plots-into-a-single-figure"><span class="header-section-number">3.6</span> Laying out multiple plots into a single figure</h2>
<p>Faceting is a great way to create multiple versions of the same plot, but sometimes you want to create completely different plots and lay them out together. For example, let’s say we are interested in the tail length variable from our <code>mousezempic_dosage_data</code> dataset. We might want to create a scatterplot of initial weight vs tail length, and a boxplot of tail length by cage number, and lay them out together.</p>
<p>We can do this using the <code>patchwork</code> package, which allows you to combine multiple ggplot2 plots into a single figure. To use it, you first need to load the package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if you get an error saying that the package is not installed, uncomment and then run the following line to install it</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("patchwork")</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="co"># otherwise just load the package</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The patchwork package changes the way that the <code>+</code> operator works, so that it can be used to combine multiple plots together, as well as to add layers to plots like we’ve seen so far. To use it, you just create your plots as normal, but <strong>assign them to variables</strong>. Then, you can use the <code>+</code> operator to combine them.</p>
<p>Returning to the example above, we can create our plots and assign them to variables. We’ll also use this as an opportunity to revise some of the things we’ve learned so far, such as adding labels and changing the theme:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> tail_length_mm, <span class="at">fill =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add labels</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tail length by cage number"</span>,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cage number"</span>,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the theme</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove the legend, because we will use the same colour for the points and the plot, don't need both legends</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>tail_weight_scatterplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how there is no output from these lines of code, because we are not printing the plots to the console (just assigning them).</p>
<p>Now, we can use the <code>+</code> operator to combine the two plots together into a single figure:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="sc">+</span> tail_weight_scatterplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>This will create a single figure with the boxplot on the left and the scatterplot on the right (following the order in which we specified them).</p>
<p>If we want to stack our plots on top of eachother in a column, we can use the <code>\</code> operator. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put the boxplot on top of the scatterplot</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="sc">/</span> tail_weight_scatterplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>The patchwork package has several other ways to lay out plots, particularly for more complex layouts. For more information, check out the <a href="https://patchwork.data-imaginist.com/articles/patchwork.html#controlling-layout">patchwork documentation</a>.</p>
<p>Another useful feature of the patchwork package is that you can add annotations to your plots, such ‘A’ or ‘B’ to indicate which plot is which. You can do this using the <code>plot_annotation()</code> function, with the <code>tag_levels = "A"</code> argument. We can add this to the plot with the <code>+</code> operator, just like we do with layers in a singular ggplot.</p>
<p>For example, if we wanted to identify our two plots as ‘A’ and ‘B’:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="sc">+</span> tail_weight_scatterplot <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This allows you to make entire figures within R!</p>
<p>Once you’ve decided on your layout and added your annotations, you probably want to save it to a file. You can do this using the <code>ggsave()</code> function, just like you would for a single plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> tail_cage_boxplot <span class="sc">+</span> tail_weight_scatterplot</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"combined_plot.png"</span>, <span class="at">plot =</span> combined_plot, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Practice exercises">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Practice exercises
</div>
</div>
<div class="callout-body-container callout-body">
<p>Try this practice question to test your understanding!</p>
<p>1. Using the <code>mtcars</code> dataset, create a scatterplot of <code>mpg</code> vs <code>hp</code>, and a boxplot of <code>mpg</code> by <code>cyl</code>, and lay them out together in a single figure. Add labels to each plot and remove the legend from the boxplot. Use your creativity to make the plots look nice!</p>
<details>
<summary>
Solution
</summary>
<p>First, we create the scatterplot and boxplot, remembering to assign them to variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>mpg_hp_scatterplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to know what the column names are, I looked at the</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># help page for the mtcars dataset by running ?mtcars</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MPG vs HP"</span>,</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Horsepower (hp)"</span>,</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon (mpg)"</span>) <span class="sc">+</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>mpg_cyl_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars,</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the cyl column to a character variable</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># because even though it's a number, it represents a category</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.character</span>(cyl), <span class="at">y =</span> mpg, <span class="at">colour =</span> <span class="fu">as.character</span>(cyl))) <span class="sc">+</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use lwd = 1.5 to make the line thicker so it's easier to see</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MPG by number of cylinders"</span>,</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of cylinders"</span>,</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon (mpg)"</span>) <span class="sc">+</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use the viridis colour palette for the boxplot</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note it's scale_colour_viridis_d() because this is discrete data</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we combine the two plots together with the <code>+</code> operator. To add the labels, we can use the <code>plot_annotation()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>mpg_hp_scatterplot <span class="sc">+</span> mpg_cyl_boxplot <span class="sc">+</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Of course, your plots might look quite different, depending on how you choose to style them. The important thing is that you create a scatterplot of <code>mpg</code> vs <code>hp</code>, and a boxplot of <code>mpg</code> by <code>cyl</code>, and lay them out together in a single figure.</p>
</details>
</div>
</div>
</section>
<section id="summary" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="summary"><span class="header-section-number">3.7</span> Summary</h2>
<p>Today, we’ve covered a lot of ground in ggplot2! Here’s a quick summary of what we’ve learned:</p>
<ul>
<li>How to use the <code>ggplot(aes(x = ..., y = ...))</code> function to initialise a plot</li>
<li>That we can add layers to a plot using the <code>+</code> operator</li>
<li>How to use the <code>geom_*()</code> functions to add different physical representations of the data to your plot (e.g.&nbsp;points with <code>geom_point()</code>, bars with <code>geom_bar()</code>, etc.)</li>
<li>How to save a plot to a file using the <code>ggsave()</code> function, or through the RStudio plot window</li>
<li>Using the <code>aes()</code> function to map variables in your data to aesthetics like colour, x/y position, size and shape, as well as the different <code>scale_*()</code> functions that can change the appearance of these aesthetics</li>
<li>Ways we can change the appearance of a plot with pre-set themes (e.g.&nbsp;<code>theme_bw()</code>, <code>theme_minimal()</code>, etc.), using the <code>theme()</code> function and adding labels with the <code>labs()</code> function</li>
<li>That we can use the <code>facet_wrap()</code> and <code>facet_grid()</code> functions to create multiple plots that show different subsets of the data according to particular categorical variable(s)</li>
<li>How to use the <code>patchwork</code> package to combine multiple plots into a single figure with operators like <code>+</code> and <code>/</code></li>
</ul>
<p>These are just the basics of ggplot2, and there are many more features and functions that you can use to create beautiful and informative plots. If you’re interested in learning more, check out the <a href="https://ggplot2-book.org/">ggplot2 book</a>, the <a href="https://r-graph-gallery.com/">R graph gallery</a> or explore some of the many packages that extend ggplot2, like <a href="https://github.com/eclarke/ggbeeswarm">ggbeeswarm</a> for making beeswarm plots or <a href="https://ggrepel.slowkow.com/;">ggrepel</a> to label plots without the text overlapping.</p>
<section id="practice-questions" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="practice-questions"><span class="header-section-number">3.7.1</span> Practice questions</h3>
<p>Try these practice questions to test your understanding!</p>
<ol type="1">
<li>Look at the following ggplot2 code and try to describe in words what type of plot it will make. If you’re not sure, try looking up the help pages for the functions!</li>
</ol>
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sex), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> drug_dose_g)) <span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Write some ggplot2 code that will create:</li>
</ol>
<ol type="a">
<li>A violin plot with points overlaid of drug dosage for each of the mouse strains. The violins should be coloured by mouse strain, and the points should be jittered to avoid overlap.</li>
<li>A histogram of the weight lost, faceted into separate plots for each combination of sex and mouse strain. Each histogram should be coloured pink, and should have 15 bins.</li>
</ol>
<p>Try to make them look as nice as possible, using the techniques we’ve learned in this session.</p>
<ol start="3" type="1">
<li>I’ve written the following code to create a scatterplot of initial weight vs tail length, with points coloured by weight lost. However, I’m getting an error. What’s wrong?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> weight_lost_g) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hint: read the error message carefully! It will give you a clue about what the problem is.</p>
<ol start="4" type="1">
<li>Write some code to re-create the plots below in ggplot2.</li>
</ol>
<ol type="a">
<li>Hint: you can use <code>geom_smooth()</code> twice, once to add the overall trendline, and once to add the separate trendlines for each mouse strain. You’ll want to use the <code>aes()</code> function within the geoms that need to be colour coded.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>The font size here is 16 and the thicker line is size 2.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<ol start="5" type="1">
<li>Assign the plots you created in question 4 to variables, use the patchwork package to combine them into a single figure, and save it to a file.</li>
</ol>
<details>
<summary>
Solutions
</summary>
<ol type="1">
<li>The plotting code would generate:</li>
</ol>
<ol type="a">
<li>Boxplots of the weight lost (in grams), with one for each sex in each cage. The boxplots are coloured by sex and the width of the boxplots is set to 0.5 so they are a bit skinnier than usual. A dashed line is drawn at y = 4 (4g of weight lost), and the legend is placed at the bottom of the plot. The plot uses a minimal theme.</li>
<li>A scatterplot of initial weight (in grams) vs weight lost (in grams), with points coloured by drug dosage (using a the viridis colour palette for continuous variables). A black linear trendline is plotted over the top, and the confidence interval is not shown (<code>se = FALSE</code>). The plot uses a minimal theme.</li>
</ol>
<ol start="2" type="1">
<li>Below are some sample answers. Your plots might look a little different depending on your aesthetic preferences.</li>
</ol>
<ol type="a">
<li>To make the plot you could use the following code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> drug_dose_g, <span class="at">fill =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># you could also use aes(colour = mouse_strain) here to have the outline of the violin be the same colour as the fill</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># choose a scale you like</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here I am using a vector of three different hex colours for the three different strains</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFBA49"</span>, <span class="st">"#EF5B5B"</span>, <span class="st">"#3581B8"</span>)) <span class="sc">+</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># don't forget to label!!</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Drug dosage by mouse strain"</span>,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_ydensity()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>To make the plot you could use the following code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># choose your fave pink colour, here i just used "pink"</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># don't forget to set the bins to 15</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"pink"</span>, <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(sex <span class="sc">~</span> mouse_strain) <span class="sc">+</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># don't forget to label!!</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="st">"Weight lost by sex and mouse strain"</span>,</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Weight lost (g)"</span>,</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># my fave theme</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>The error is because you are trying to colour the points by weight lost, but you haven’t specified it in the <code>aes()</code> function. You need to put <code>colour = weight_lost_g</code> inside the <code>aes()</code> function. This can be either the first <code>aes()</code> function call inside <code>ggplot()</code>:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Or, you could set the colour in the <code>geom_point()</code> function, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<p>Either way, if you want to map a variable to an aesthetic, you need to put it inside the <code>aes()</code> function!</p>
<ol start="4" type="1">
<li>To recreate the plots, you could use the following code:</li>
</ol>
<ol type="a">
<li>Note how the <code>aes()</code> function is used to colour the points and individual trendlines by mouse strain, but not the overall trendline because we specify it within the geoms, not in the initial <code>ggplot()</code> function call:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># colour the points by mouse strain</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we put this in geom_point() because we want to colour the points by mouse strain but not the overall trendline</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a grey trendline for the overall trend (not coloured by mouse strain)</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a separate trendline for each mouse strain</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># label the plot</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Simpson's Paradox in the relationship between initial weight and tail length"</span>,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use the minimal theme</span></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="a">
<li>Notice how we specified the <code>linewidth</code> argument in the <code>geom_boxplot()</code> and <code>geom_hline()</code> functions to make the lines thicker. This is not inside the <code>aes()</code> function because it doesn’t represent anything in the data, it’s just used to style the plot. We also set the <code>base_size</code> argument in the <code>theme_minimal()</code> function to make the font size larger:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> weight_lost_g, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set linewidth = 2 to make the lines thicker</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a dashed line at y = 4</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#endregion</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost by cage number and mouse strain"</span>,</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cage number"</span>,</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># minimal theme and increase font size</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># move the legend to the bottom</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing non-finite outside the scale range
(`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="session_3_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="2000"></p>
</figure>
</div>
</div>
</div>
<ol start="5" type="1">
<li>To combine the plots, you could use the following code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming you have already created the plots and assigned them to variables 'plot1' and 'plot2'</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="co"># don't forget to load the patchwork package!</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the plots</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">+</span> plot2 <span class="sc">+</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we can add annotation if we like</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co"># save the plot to a file</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"combined_plot.png"</span>, <span class="at">plot =</span> combined_plot, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./session_2.html" class="pagination-link" aria-label="Session 2: Working with data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Session 2: Working with data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./session_4.html" class="pagination-link" aria-label="Session 4: Putting it all together">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Session 4: Putting it all together</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb116" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co">  - naquiz</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-title: "In this session:"</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session 3: Plotting with ggplot2 {#sec-session03}</span></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>In this session we will learn how to create and customise plots using the <span class="in">`ggplot2`</span> package.</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip title="Learning Objectives"}</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>At the end of this session, learners should be able to:</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Create a ggplot and save it for use outside of R</span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Describe some of the common ways we can change the appearance of a plot, such as themes, legends and colours.</span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>List some of the common geoms available in ggplot2 and what types of data they might be useful for</span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Use the <span class="in">`facet_wrap`</span> function to create a series of similar plots</span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Understand how to use the <span class="in">`patchwork`</span> package to compose multiple plots together into a single figure</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-25"><a href="#cb116-25" aria-hidden="true" tabindex="-1"></a>To get started, let's load the <span class="in">`tidyverse`</span> package, which includes <span class="in">`ggplot2`</span>:</span>
<span id="cb116-26"><a href="#cb116-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-29"><a href="#cb116-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-30"><a href="#cb116-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb116-31"><a href="#cb116-31" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-32"><a href="#cb116-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-33"><a href="#cb116-33" aria-hidden="true" tabindex="-1"></a>And read in the <span class="in">`mousezempic_dosage_data`</span> that we have been using in previous sessions:</span>
<span id="cb116-34"><a href="#cb116-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-37"><a href="#cb116-37" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-38"><a href="#cb116-38" aria-hidden="true" tabindex="-1"></a>mousezempic_dosage_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/mousezempic_dosage_data.csv"</span>)</span>
<span id="cb116-39"><a href="#cb116-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-40"><a href="#cb116-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-41"><a href="#cb116-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Building our first plot, layer by layer</span></span>
<span id="cb116-42"><a href="#cb116-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-43"><a href="#cb116-43" aria-hidden="true" tabindex="-1"></a>Although R has a built-in plotting system, <span class="in">`ggplot2`</span> is a more powerful and flexible package for creating plots. The <span class="in">`gg`</span> in <span class="in">`ggplot2`</span> stands for "Grammar of Graphics", which is a way thinking about how each component of a plot (e.g. axes or colours) is part of the 'language' of data visualisation that allows you to compose complex plots piece by piece, just like you combine words to form sentences.</span>
<span id="cb116-44"><a href="#cb116-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-45"><a href="#cb116-45" aria-hidden="true" tabindex="-1"></a><span class="fu">### Initialisation</span></span>
<span id="cb116-46"><a href="#cb116-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-47"><a href="#cb116-47" aria-hidden="true" tabindex="-1"></a>When making a ggplot, the first thing you need to do is initialise it with the <span class="in">`ggplot()`</span> function. This function takes two arguments:</span>
<span id="cb116-48"><a href="#cb116-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-49"><a href="#cb116-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>the **data** that you want to visualise (a dataframe/tibble), and</span>
<span id="cb116-50"><a href="#cb116-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**mapping**, which describes the scales that will be used to display the data (e.g. which variable should be the x axis, which should be represented by colour, etc.)</span>
<span id="cb116-51"><a href="#cb116-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-52"><a href="#cb116-52" aria-hidden="true" tabindex="-1"></a>The mapping is specified using the <span class="in">`aes()`</span> function, which stands for 'aesthetics'. It takes named arguments, where the names are the aesthetics you want to use to show your data (e.g. <span class="in">`x`</span>, <span class="in">`y`</span>, <span class="in">`colour`</span>, <span class="in">`shape`</span>, etc.) and the values are the names of the columns in your data that you want to use for those aesthetics.</span>
<span id="cb116-53"><a href="#cb116-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-54"><a href="#cb116-54" aria-hidden="true" tabindex="-1"></a>For example, to make a plot to explore the relationship between the initial weight of the mice and their tail length, we would write:</span>
<span id="cb116-55"><a href="#cb116-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-58"><a href="#cb116-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-59"><a href="#cb116-59" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm))</span>
<span id="cb116-60"><a href="#cb116-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-61"><a href="#cb116-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-62"><a href="#cb116-62" aria-hidden="true" tabindex="-1"></a>In the plot panel (bottom right hand corner), you should now see a blank plot with the x and y axes labelled with the column names we specified in the <span class="in">`aes()`</span> function. There's no data on it yet, because we haven't told ggplot how to physically represent the data on the x and y scales we have specified.</span>
<span id="cb116-63"><a href="#cb116-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-64"><a href="#cb116-64" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adding data</span></span>
<span id="cb116-65"><a href="#cb116-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-66"><a href="#cb116-66" aria-hidden="true" tabindex="-1"></a>Data is represented in ggplot using **geoms** (short for 'geometric objects'). A geom is a visual representation of the data in the plot, such as points, lines or bars. They are named <span class="in">`geom_*`</span> where <span class="in">`*`</span> is the type of geom you want to use. We will cover some of the most common geoms later in this session.</span>
<span id="cb116-67"><a href="#cb116-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-68"><a href="#cb116-68" aria-hidden="true" tabindex="-1"></a>Geoms are added to plots layers (which are drawn on top of one another, like layers of a cake) using the <span class="in">`+`</span> operator.</span>
<span id="cb116-69"><a href="#cb116-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-70"><a href="#cb116-70" aria-hidden="true" tabindex="-1"></a>For example, let's add points to the plot that we initialised above using <span class="in">`geom_point()`</span>:</span>
<span id="cb116-71"><a href="#cb116-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-74"><a href="#cb116-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-75"><a href="#cb116-75" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-76"><a href="#cb116-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-77"><a href="#cb116-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-78"><a href="#cb116-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-79"><a href="#cb116-79" aria-hidden="true" tabindex="-1"></a>This gives us a basic scatterplot of the data, with each point representing the tail length and initial weight of a mouse in our dataset.</span>
<span id="cb116-80"><a href="#cb116-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-81"><a href="#cb116-81" aria-hidden="true" tabindex="-1"></a>Notice how we didn't have to specify the data or mapping again when we added the <span class="in">`geom_point()`</span> layer, because the data and mapping are inherited from the initial <span class="in">`ggplot()`</span> function call. This is a common pattern in ggplot2: you only need to specify the data and mapping once, and it is used by all subsequent layers.</span>
<span id="cb116-82"><a href="#cb116-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-83"><a href="#cb116-83" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="The plus <span class="in">`+`</span> vs the pipe <span class="in">`%&gt;%`</span>"}</span>
<span id="cb116-84"><a href="#cb116-84" aria-hidden="true" tabindex="-1"></a>You might have noticed that <span class="in">`+`</span> in ggplot works similarly to the pipe operator <span class="in">`%&gt;%`</span> in the <span class="in">`dplyr`</span> package in that you place it at the end of a line of code, but **`+` is only ever used in the context of plotting.**</span>
<span id="cb116-85"><a href="#cb116-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-86"><a href="#cb116-86" aria-hidden="true" tabindex="-1"></a>Don't mix them up! A handy way to remember is that <span class="in">`+`</span> looks a bit like the axes of a plot, so it's what you should use when plotting.</span>
<span id="cb116-87"><a href="#cb116-87" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-88"><a href="#cb116-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-89"><a href="#cb116-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overlaying additional data</span></span>
<span id="cb116-90"><a href="#cb116-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-91"><a href="#cb116-91" aria-hidden="true" tabindex="-1"></a>Of course, this is a very simple plot. To show more information, we can add additional layers using the <span class="in">`+`</span> operator, or use additional aesthetics.</span>
<span id="cb116-92"><a href="#cb116-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-93"><a href="#cb116-93" aria-hidden="true" tabindex="-1"></a>For example, let's add a a layer containing a linear trendline using <span class="in">`geom_smooth(method = "lm")`</span>:</span>
<span id="cb116-94"><a href="#cb116-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-97"><a href="#cb116-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-98"><a href="#cb116-98" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-99"><a href="#cb116-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-100"><a href="#cb116-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb116-101"><a href="#cb116-101" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-102"><a href="#cb116-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-103"><a href="#cb116-103" aria-hidden="true" tabindex="-1"></a>Here, we supplied the <span class="in">`method = "lm"`</span> argument to <span class="in">`geom_smooth()`</span> to tell it fit a linear model (lm for short) to the data and plot the line of best fit, surrounded by a 95% confidence interval. Most geoms will have additional arguments like this that you can use to customise their appearance. Remember that we can check the documentation for geoms and other functions using <span class="in">`?geom_smooth`</span>.</span>
<span id="cb116-104"><a href="#cb116-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-105"><a href="#cb116-105" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="ggplot2 and missing values"}</span>
<span id="cb116-106"><a href="#cb116-106" aria-hidden="true" tabindex="-1"></a>You might have noticed that, along with the plot, R is also printing a warning message that lets us know that some rows of our data contain missing values. ggplot2 will automatically remove these rows from the plot (and warn you that it's happening), but it's always a good idea to check your data for missing values before plotting it, as they can affect the results of your analysis. Recall from last session that we can do this by combining the <span class="in">`is.na()`</span> function with <span class="in">`filter()`</span>:</span>
<span id="cb116-107"><a href="#cb116-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-110"><a href="#cb116-110" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-111"><a href="#cb116-111" aria-hidden="true" tabindex="-1"></a><span class="co"># find the rows of our data that contain missing values in the columns we're plotting</span></span>
<span id="cb116-112"><a href="#cb116-112" aria-hidden="true" tabindex="-1"></a>mousezempic_dosage_data <span class="sc">%&gt;%</span></span>
<span id="cb116-113"><a href="#cb116-113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(initial_weight_g), <span class="fu">is.na</span>(tail_length_mm))</span>
<span id="cb116-114"><a href="#cb116-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-115"><a href="#cb116-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-116"><a href="#cb116-116" aria-hidden="true" tabindex="-1"></a>From here on, we will hide these warnings in the ebook so that it's easier to read, but you'll still see them if you run the code in your own R session.</span>
<span id="cb116-117"><a href="#cb116-117" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-118"><a href="#cb116-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-119"><a href="#cb116-119" aria-hidden="true" tabindex="-1"></a>We can also add additional aesthetics to the plot beyond just <span class="in">`x`</span> and <span class="in">`y`</span>. For example, let's use the <span class="in">`colour`</span> aesthetic to represent the strain of each mouse. To do this, we add <span class="in">`colour = strain`</span> to the <span class="in">`aes()`</span> function that describes the mapping in the <span class="in">`ggplot()`</span> call:</span>
<span id="cb116-120"><a href="#cb116-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-123"><a href="#cb116-123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-124"><a href="#cb116-124" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-125"><a href="#cb116-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-126"><a href="#cb116-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-127"><a href="#cb116-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb116-128"><a href="#cb116-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-129"><a href="#cb116-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-130"><a href="#cb116-130" aria-hidden="true" tabindex="-1"></a>Not only are the points now coloured by the strain of each mouse, but there are now three separate colour-coded trendlines, one for each strain. This is because the aesthetic mapping we supply to the <span class="in">`ggplot()`</span> function when initialising the plot is inherited by **all** subsequent layers/geoms.</span>
<span id="cb116-131"><a href="#cb116-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-132"><a href="#cb116-132" aria-hidden="true" tabindex="-1"></a>Notice as well how adding colour to the plot totally changes the way we perceive the data! Without colour and just plotting a single trendline, it appeared that there was an overall negative association between initial weight and tail length, but we can now see that there is actually a positive association within each strain. This is an example of <span class="co">[</span><span class="ot">Simpson's Paradox</span><span class="co">](https://en.wikipedia.org/wiki/Simpson%27s_paradox)</span>, and shows why it's so important to visualise your data!</span>
<span id="cb116-133"><a href="#cb116-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-134"><a href="#cb116-134" aria-hidden="true" tabindex="-1"></a><span class="fu">### Saving plots as images</span></span>
<span id="cb116-135"><a href="#cb116-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-136"><a href="#cb116-136" aria-hidden="true" tabindex="-1"></a>Once you're satisfied with the plot you've created, you can programmatically save your plot using the <span class="in">`ggsave()`</span> function.</span>
<span id="cb116-137"><a href="#cb116-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-138"><a href="#cb116-138" aria-hidden="true" tabindex="-1"></a>To use <span class="in">`ggsave()`</span>, you need to specify:</span>
<span id="cb116-139"><a href="#cb116-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-140"><a href="#cb116-140" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The name of the file to to save the plot as (e.g. <span class="in">`"my_plot.png"`</span>). Specifying a different file extension, e.g. <span class="in">`"my_plot.pdf"`</span> will save the plot in the appropriate format.</span>
<span id="cb116-141"><a href="#cb116-141" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The plot object you want to save (defaults to the last plot you sent to the plot pane).</span>
<span id="cb116-142"><a href="#cb116-142" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The dimensions of the plot (e.g. <span class="in">`width = 6, height = 4`</span>). Dimensions are in inches by default and can be changed using the <span class="in">`units`</span> argument (e.g. <span class="in">`units = "cm"`</span>).</span>
<span id="cb116-143"><a href="#cb116-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-144"><a href="#cb116-144" aria-hidden="true" tabindex="-1"></a>For example, to save the last plot we created as a .png file with dimensions of 5 by 7 inches, we would write:</span>
<span id="cb116-145"><a href="#cb116-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-148"><a href="#cb116-148" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-149"><a href="#cb116-149" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-150"><a href="#cb116-150" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"coloured_scatterplot.png"</span>, <span class="at">device =</span> <span class="st">"png"</span>, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">7</span>)</span>
<span id="cb116-151"><a href="#cb116-151" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-152"><a href="#cb116-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-153"><a href="#cb116-153" aria-hidden="true" tabindex="-1"></a>Or to save it as a .pdf file with dimensions of 20 by 30 cm:</span>
<span id="cb116-154"><a href="#cb116-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-157"><a href="#cb116-157" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-158"><a href="#cb116-158" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-159"><a href="#cb116-159" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"coloured_scatterplot.pdf"</span>, <span class="at">device =</span> <span class="st">"pdf"</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb116-160"><a href="#cb116-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-161"><a href="#cb116-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-162"><a href="#cb116-162" aria-hidden="true" tabindex="-1"></a>It's good practice to assign the plot you want to save to a variable, and provide it to the 'plot' argument of <span class="in">`ggsave()`</span>, rather than relying on the last plot you created. This makes it clear what plot you're saving, so that your code is more readable and reproducible.</span>
<span id="cb116-163"><a href="#cb116-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-166"><a href="#cb116-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-167"><a href="#cb116-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-168"><a href="#cb116-168" aria-hidden="true" tabindex="-1"></a><span class="co"># first assign the plot to a variable</span></span>
<span id="cb116-169"><a href="#cb116-169" aria-hidden="true" tabindex="-1"></a>colourful_scatterplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-170"><a href="#cb116-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-171"><a href="#cb116-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-172"><a href="#cb116-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb116-173"><a href="#cb116-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-174"><a href="#cb116-174" aria-hidden="true" tabindex="-1"></a><span class="co"># then save the plot: notice the 'plot' argument</span></span>
<span id="cb116-175"><a href="#cb116-175" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"coloured_scatterplot.pdf"</span>, <span class="at">plot =</span> colourful_scatterplot, <span class="at">device =</span> <span class="st">"pdf"</span>, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">30</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb116-176"><a href="#cb116-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-177"><a href="#cb116-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-178"><a href="#cb116-178" aria-hidden="true" tabindex="-1"></a>It's also possible to save plots using the export button in the plot panel: <span class="al">![You can use the export button to save plots interactively](images/S03F01_export.png)</span></span>
<span id="cb116-179"><a href="#cb116-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-180"><a href="#cb116-180" aria-hidden="true" tabindex="-1"></a>You can choose to save the plot either as an image: <span class="al">![Saving an R plot as an image](images/S03F02_export_image.png)</span></span>
<span id="cb116-181"><a href="#cb116-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-182"><a href="#cb116-182" aria-hidden="true" tabindex="-1"></a>In this case, you can set the file type and dimensions, and see a preview of the plot before saving it. Tip: it's also possible to change the dimensions of the plot by dragging the bottom left of the preview window.</span>
<span id="cb116-183"><a href="#cb116-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-184"><a href="#cb116-184" aria-hidden="true" tabindex="-1"></a>You can also save plots as a PDF: <span class="al">![Saving an R plot as a PDF](images/S03F03_export_pdf.png)</span></span>
<span id="cb116-185"><a href="#cb116-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-186"><a href="#cb116-186" aria-hidden="true" tabindex="-1"></a>Although there is no preview for PDFs within RStudio itself, you can click the 'preview' button to open the PDF in your default PDF viewer.</span>
<span id="cb116-187"><a href="#cb116-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-188"><a href="#cb116-188" aria-hidden="true" tabindex="-1"></a>In general, it's preferable to save plots programmatically using <span class="in">`ggsave()`</span> because it's more reproducible (because if you ever change your plotting code or data, new plot files can be automatically generated), but the export button can be useful for quickly saving plots during exploratory data analysis (or use the ultimate lazy hack: just screenshot the plot panel!).</span>
<span id="cb116-189"><a href="#cb116-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-190"><a href="#cb116-190" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="Practice exercises"}</span>
<span id="cb116-191"><a href="#cb116-191" aria-hidden="true" tabindex="-1"></a>Try these practice questions to test your understanding</span>
<span id="cb116-192"><a href="#cb116-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-193"><a href="#cb116-193" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-194"><a href="#cb116-194" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> Which of the following statements about the mapping in a ggplot is **incorrect**?</span>
<span id="cb116-195"><a href="#cb116-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-196"><a href="#cb116-196" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-197"><a href="#cb116-197" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-198"><a href="#cb116-198" aria-hidden="true" tabindex="-1"></a>Mapping is specified using the <span class="in">`aes()`</span> function</span>
<span id="cb116-199"><a href="#cb116-199" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-200"><a href="#cb116-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-201"><a href="#cb116-201" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-202"><a href="#cb116-202" aria-hidden="true" tabindex="-1"></a>Mapping refers to the type of plot you want to create (e.g. scatterplot, line plot)</span>
<span id="cb116-203"><a href="#cb116-203" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-204"><a href="#cb116-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-205"><a href="#cb116-205" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-206"><a href="#cb116-206" aria-hidden="true" tabindex="-1"></a>When you specify the mapping in the <span class="in">`ggplot()`</span> function, it is inherited by all subsequent layers/geoms</span>
<span id="cb116-207"><a href="#cb116-207" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-208"><a href="#cb116-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-209"><a href="#cb116-209" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-210"><a href="#cb116-210" aria-hidden="true" tabindex="-1"></a>Mapping allows you to specify which scales (e.g. x, y, colour) should be used to display the data</span>
<span id="cb116-211"><a href="#cb116-211" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-212"><a href="#cb116-212" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-213"><a href="#cb116-213" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-214"><a href="#cb116-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-215"><a href="#cb116-215" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-216"><a href="#cb116-216" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> Which of the following lines of code is a valid way to create a scatterplot of the drug dosage (x) and weight loss (y) in the <span class="in">`mousezempic_dosage_data`</span> dataset?</span>
<span id="cb116-217"><a href="#cb116-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-218"><a href="#cb116-218" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-219"><a href="#cb116-219" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-220"><a href="#cb116-220" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) %&gt;% geom_point()`</span></span>
<span id="cb116-221"><a href="#cb116-221" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-222"><a href="#cb116-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-223"><a href="#cb116-223" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-224"><a href="#cb116-224" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, x = drug_dose_g, y = weight_lost_g) + geom_point()`</span></span>
<span id="cb116-225"><a href="#cb116-225" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-226"><a href="#cb116-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-227"><a href="#cb116-227" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-228"><a href="#cb116-228" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g))`</span></span>
<span id="cb116-229"><a href="#cb116-229" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-230"><a href="#cb116-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-231"><a href="#cb116-231" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-232"><a href="#cb116-232" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) + geom_point()`</span></span>
<span id="cb116-233"><a href="#cb116-233" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-234"><a href="#cb116-234" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-235"><a href="#cb116-235" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-236"><a href="#cb116-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-237"><a href="#cb116-237" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-238"><a href="#cb116-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-239"><a href="#cb116-239" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>How could you programmatically save the plot created in question 2 as a .pdf file with dimensions of 10 by 15 cm?</span>
<span id="cb116-240"><a href="#cb116-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-241"><a href="#cb116-241" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-242"><a href="#cb116-242" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-243"><a href="#cb116-243" aria-hidden="true" tabindex="-1"></a><span class="in">`ggsave("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15, units = "cm")`</span></span>
<span id="cb116-244"><a href="#cb116-244" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-245"><a href="#cb116-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-246"><a href="#cb116-246" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-247"><a href="#cb116-247" aria-hidden="true" tabindex="-1"></a><span class="in">`save("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15, units = "cm")`</span></span>
<span id="cb116-248"><a href="#cb116-248" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-249"><a href="#cb116-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-250"><a href="#cb116-250" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-251"><a href="#cb116-251" aria-hidden="true" tabindex="-1"></a><span class="in">`ggsave("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15)`</span></span>
<span id="cb116-252"><a href="#cb116-252" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-253"><a href="#cb116-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-254"><a href="#cb116-254" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-255"><a href="#cb116-255" aria-hidden="true" tabindex="-1"></a><span class="in">`ggsave("drug_dosage_vs_weight_loss.pdf", width = 10, height = 15)`</span></span>
<span id="cb116-256"><a href="#cb116-256" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-257"><a href="#cb116-257" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-258"><a href="#cb116-258" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-259"><a href="#cb116-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-260"><a href="#cb116-260" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-261"><a href="#cb116-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-262"><a href="#cb116-262" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Solutions<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb116-263"><a href="#cb116-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-264"><a href="#cb116-264" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Mapping in ggplot refers to the scales that will be used to display the data (e.g. x, y, colour), not the type of plot you want to create. It is specified using the <span class="in">`aes()`</span> function, and when specified in the initial <span class="in">`ggplot()`</span> function call, is inherited by all subsequent layers/geoms.</span>
<span id="cb116-265"><a href="#cb116-265" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The correct way to create a scatterplot of the drug dosage and weight loss in the <span class="in">`mousezempic_dosage_data`</span> dataset is <span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) + geom_point()`</span>. This specifies the data and mapping in the <span class="in">`ggplot()`</span> function call, and adds a layer of points to the plot using <span class="in">`geom_point()`</span>. The <span class="in">`%&gt;%`</span> operator is not used in ggplot2, and the <span class="in">`x`</span> and <span class="in">`y`</span> mapping should be specified within the <span class="in">`aes()`</span> function. Also, remember that although ggplot2 is the name of the package, the function you use to initialise a plot is <span class="in">`ggplot()`</span>.</span>
<span id="cb116-266"><a href="#cb116-266" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>To programmatically save the plot created in question 2 as a .pdf file with dimensions of 10 by 15 cm, you would use the <span class="in">`ggsave()`</span> function with the arguments <span class="in">`ggsave("drug_dosage_vs_weight_loss.pdf", device = "pdf", width = 10, height = 15, units = "cm")`</span>. This specifies the filename, file type, dimensions, and units of the plot you want to save. Remember that by default, dimensions are in inches (boooo), so you need to specify the units as "cm" to save the plot with dimensions in centimetres.</span>
<span id="cb116-267"><a href="#cb116-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-268"><a href="#cb116-268" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-269"><a href="#cb116-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-270"><a href="#cb116-270" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-271"><a href="#cb116-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-272"><a href="#cb116-272" aria-hidden="true" tabindex="-1"></a><span class="fu">## Some commonly used geoms</span></span>
<span id="cb116-273"><a href="#cb116-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-274"><a href="#cb116-274" aria-hidden="true" tabindex="-1"></a>ggplot2 has (as of writing) almost 50 different geoms that you can use to represent your data. You can see the full list in the <span class="co">[</span><span class="ot">ggplot2 documentation</span><span class="co">](https://ggplot2.tidyverse.org/reference/#geoms)</span>, but some of the most commonly used geoms include:</span>
<span id="cb116-275"><a href="#cb116-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-276"><a href="#cb116-276" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_point()`</span> for visualising individual data points</span>
<span id="cb116-277"><a href="#cb116-277" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_density()`</span> and <span class="in">`geom_histogram()`</span> for visualising the distribution of a continuous variable</span>
<span id="cb116-278"><a href="#cb116-278" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_violin()`</span> and <span class="in">`geom_boxplot()`</span> for visualising the distribution of a continuous variable **across different categories**</span>
<span id="cb116-279"><a href="#cb116-279" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_bar()`</span> and <span class="in">`geom_col()`</span> for making bar plots</span>
<span id="cb116-280"><a href="#cb116-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`geom_h/vline()`</span> for adding horizontal and vertical lines to a plot</span>
<span id="cb116-281"><a href="#cb116-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-282"><a href="#cb116-282" aria-hidden="true" tabindex="-1"></a>In this section, we will briefly cover these geoms and how you might use them to visualise your data. It's not designed to be an exhaustive list, but hopefully it will help you get started with some of the most common types of plots you might want to create.</span>
<span id="cb116-283"><a href="#cb116-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-284"><a href="#cb116-284" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="How do I make a ... plot in ggplot2?"}</span>
<span id="cb116-285"><a href="#cb116-285" aria-hidden="true" tabindex="-1"></a>Often, you might come across a specific type of plot you want to make that is a bit more complex than the basic geoms we've covered here. If you know the name of the plot you're wanting to make, you can often find a tutorial/guide online by googling, or you could ask an AI assistant like ChatGPT. Particularly for specific types of data (e.g. clinical data, phylogenetic data), there are often field-specific packages that provide geoms or functions to make particular types of plots, like the <span class="co">[</span><span class="ot">ggtree package</span><span class="co">](https://yulab-smu.top/treedata-book/index.html)</span> for phylogenetic trees or the <span class="co">[</span><span class="ot">survminer package</span><span class="co">](https://rpkgs.datanovia.com/survminer/)</span> for survival plots.</span>
<span id="cb116-286"><a href="#cb116-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-287"><a href="#cb116-287" aria-hidden="true" tabindex="-1"></a>If the plot doesn't have a specifc name, you can try to break it down by thinking about the geoms you might need to use to represent the data, or try uploading a picture of a similar plot to ChatGPT.</span>
<span id="cb116-288"><a href="#cb116-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-289"><a href="#cb116-289" aria-hidden="true" tabindex="-1"></a>Whatever method you use, remember to add 'ggplot2' to your search query to get the most relevant results, as there are many different plotting packages in R!</span>
<span id="cb116-290"><a href="#cb116-290" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-291"><a href="#cb116-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-292"><a href="#cb116-292" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualising individual data points: geom_point</span></span>
<span id="cb116-293"><a href="#cb116-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-294"><a href="#cb116-294" aria-hidden="true" tabindex="-1"></a>Above, we saw how to use <span class="in">`geom_point()`</span> to create a scatterplot, but <span class="in">`geom_point()`</span> can be used in other ways too. For example, you can use it to create a dot plot, where the x axis is categorical and the y axis is continuous:</span>
<span id="cb116-295"><a href="#cb116-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-298"><a href="#cb116-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-299"><a href="#cb116-299" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-300"><a href="#cb116-300" aria-hidden="true" tabindex="-1"></a><span class="co"># make a dot plot of initial weight by mouse strain</span></span>
<span id="cb116-301"><a href="#cb116-301" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-302"><a href="#cb116-302" aria-hidden="true" tabindex="-1"></a><span class="co"># remember we add layers to a plot with +</span></span>
<span id="cb116-303"><a href="#cb116-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-304"><a href="#cb116-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-305"><a href="#cb116-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-306"><a href="#cb116-306" aria-hidden="true" tabindex="-1"></a>Notice how the points are stacked on top of one another for each strain. This is because the x axis is categorical, and ggplot2 doesn't know how to spread the points out. This can make it difficult to see the individual points, so when making a plot like this it's often useful to add the  <span class="in">`position = position_jitter()`</span> argument to <span class="in">`geom_point()`</span>:</span>
<span id="cb116-307"><a href="#cb116-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-310"><a href="#cb116-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-311"><a href="#cb116-311" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-312"><a href="#cb116-312" aria-hidden="true" tabindex="-1"></a><span class="co"># make a jittered dot plot of initial weight by mouse strain</span></span>
<span id="cb116-313"><a href="#cb116-313" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-314"><a href="#cb116-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>())</span>
<span id="cb116-315"><a href="#cb116-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-316"><a href="#cb116-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-317"><a href="#cb116-317" aria-hidden="true" tabindex="-1"></a>The <span class="in">`position_jitter()`</span> function adds a small amount of random noise to the x axis position of each point, which helps to spread them out and make it easier to see the individual points. Like most functions in ggplot2, <span class="in">`position_jitter()`</span> will try to guess an appropriate amount of jitter to add, but you can specify the amount as well:</span>
<span id="cb116-318"><a href="#cb116-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-321"><a href="#cb116-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-322"><a href="#cb116-322" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-323"><a href="#cb116-323" aria-hidden="true" tabindex="-1"></a><span class="co"># use less jitter so there is more distinction between the different mouse strains</span></span>
<span id="cb116-324"><a href="#cb116-324" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-325"><a href="#cb116-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>))</span>
<span id="cb116-326"><a href="#cb116-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-327"><a href="#cb116-327" aria-hidden="true" tabindex="-1"></a>The exact amount of jitter you need will depend heavily on your data, so it's often a good idea to experiment with different amounts to see what works best.</span>
<span id="cb116-328"><a href="#cb116-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-329"><a href="#cb116-329" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Beeswarm plots"}</span>
<span id="cb116-330"><a href="#cb116-330" aria-hidden="true" tabindex="-1"></a>Another way to spread out points in a dot plot is to use a beeswarm plot, in which points are spread out slightly along the x axis so that they don't overlap. The <span class="in">`ggbeeswarm`</span> package provides a <span class="in">`geom_beeswarm()`</span> function that you can use to create beeswarm plots in ggplot2 (rather than using <span class="in">`geom_point(position = position_jitter())`</span> like we did here). For more information, see the <span class="co">[</span><span class="ot">ggbeeswarm documentation</span><span class="co">](https://github.com/eclarke/ggbeeswarm/blob/main/README.md)</span>.</span>
<span id="cb116-331"><a href="#cb116-331" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-332"><a href="#cb116-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-333"><a href="#cb116-333" aria-hidden="true" tabindex="-1"></a>Beyond just scatterplots and dot plots, <span class="in">`geom_point()`</span> is also really useful to overlay additional data on top of other geoms. For example, you can use it to add individual data points to a boxplot or violin plot, as we will see shortly!</span>
<span id="cb116-334"><a href="#cb116-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-335"><a href="#cb116-335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualising the distribution of a continuous variable: geom_histogram / geom_density</span></span>
<span id="cb116-336"><a href="#cb116-336" aria-hidden="true" tabindex="-1"></a>As the number of data points increases, it can be difficult to see individual points. In this case, it can be useful to visualise the distribution of a continuous variable using a histogram or density plot.</span>
<span id="cb116-337"><a href="#cb116-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-338"><a href="#cb116-338" aria-hidden="true" tabindex="-1"></a>Histograms are created using the <span class="in">`geom_histogram()`</span> function. Seeing as only a single variable is being plotted, you only need to specify the <span class="in">`x`</span> aesthetic in the <span class="in">`aes()`</span> function.</span>
<span id="cb116-339"><a href="#cb116-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-340"><a href="#cb116-340" aria-hidden="true" tabindex="-1"></a>For example, let's create a histogram of the initial weight of the mice:</span>
<span id="cb116-343"><a href="#cb116-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-344"><a href="#cb116-344" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-345"><a href="#cb116-345" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-346"><a href="#cb116-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span>
<span id="cb116-347"><a href="#cb116-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-348"><a href="#cb116-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-349"><a href="#cb116-349" aria-hidden="true" tabindex="-1"></a>One of the most important arguments to <span class="in">`geom_histogram()`</span> is the <span class="in">`bins`</span> argument, which specifies the number of bins (bars) to use for the histogram. By default, it is 30, but you might want a smaller or larger value depending on the distribution of your data. For example, let's create a histogram with 15 bins:</span>
<span id="cb116-350"><a href="#cb116-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-353"><a href="#cb116-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-354"><a href="#cb116-354" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-355"><a href="#cb116-355" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-356"><a href="#cb116-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">15</span>)</span>
<span id="cb116-357"><a href="#cb116-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-358"><a href="#cb116-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-359"><a href="#cb116-359" aria-hidden="true" tabindex="-1"></a>Similarly to histograms, density plots are also used to visualise the distribution of a continuous variable, but they are smoothed out. To create a density plot in ggplot2, you can use the <span class="in">`geom_density()`</span> function:</span>
<span id="cb116-360"><a href="#cb116-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-363"><a href="#cb116-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-364"><a href="#cb116-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-365"><a href="#cb116-365" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-366"><a href="#cb116-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>()</span>
<span id="cb116-367"><a href="#cb116-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-368"><a href="#cb116-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-369"><a href="#cb116-369" aria-hidden="true" tabindex="-1"></a>Notice how the density plot is smoothed out compared to the histogram, and it is also scaled so that the area under the curve is equal to 1. This means that the y axis of a density plot represents the probability density of the data, rather than the count of data points in each bin.</span>
<span id="cb116-370"><a href="#cb116-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-371"><a href="#cb116-371" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualising the distribution of a continuous variable across categories: geom_boxplot / geom_violin</span></span>
<span id="cb116-372"><a href="#cb116-372" aria-hidden="true" tabindex="-1"></a>Often in biological data, you will want to visualise the distribution of a continuous variable across different categories. For example, we might want to see how the initial weight of the mice varies by strain. Two plot types that are useful for this are boxplots and violin plots.</span>
<span id="cb116-373"><a href="#cb116-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-374"><a href="#cb116-374" aria-hidden="true" tabindex="-1"></a>Boxplots allow you to easily see the median, quartiles, and any outliers in the data. To create a boxplot win ggplot2, you can use the <span class="in">`geom_boxplot()`</span> function:</span>
<span id="cb116-375"><a href="#cb116-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-378"><a href="#cb116-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-379"><a href="#cb116-379" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-380"><a href="#cb116-380" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-381"><a href="#cb116-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb116-382"><a href="#cb116-382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-383"><a href="#cb116-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-384"><a href="#cb116-384" aria-hidden="true" tabindex="-1"></a>It can sometimes be nice to add points to a boxplot to show the individual data points as well as the summary statistics. You can do this by adding a <span class="in">`geom_point()`</span> layer to the plot:</span>
<span id="cb116-385"><a href="#cb116-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-388"><a href="#cb116-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-389"><a href="#cb116-389" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-390"><a href="#cb116-390" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-391"><a href="#cb116-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-392"><a href="#cb116-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>))</span>
<span id="cb116-393"><a href="#cb116-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-394"><a href="#cb116-394" aria-hidden="true" tabindex="-1"></a>This plot shows the distribution of initial weight for each strain (with the boxplot), as well as the individual data points. Notice how the points are jittered to avoid overlapping, as we did earlier with the dot plot.</span>
<span id="cb116-395"><a href="#cb116-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-396"><a href="#cb116-396" aria-hidden="true" tabindex="-1"></a>However, when you have a lot of data points (as we do here), a boxplot with overlaid points can be a bit messy and hard to read. In this case, it might be better to use a violin plot instead, which shows the distribution of the data as a density plot:</span>
<span id="cb116-397"><a href="#cb116-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-400"><a href="#cb116-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-401"><a href="#cb116-401" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-402"><a href="#cb116-402" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-403"><a href="#cb116-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span>
<span id="cb116-404"><a href="#cb116-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-405"><a href="#cb116-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-406"><a href="#cb116-406" aria-hidden="true" tabindex="-1"></a>You can even combine <span class="in">`geom_violin()`</span> with <span class="in">`geom_boxplot()`</span> to show both the distribution of the data and the summary statistics:</span>
<span id="cb116-407"><a href="#cb116-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-410"><a href="#cb116-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-411"><a href="#cb116-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-412"><a href="#cb116-412" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-413"><a href="#cb116-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb116-414"><a href="#cb116-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span>
<span id="cb116-415"><a href="#cb116-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-416"><a href="#cb116-416" aria-hidden="true" tabindex="-1"></a>Notice how we specified the <span class="in">`width`</span> argument in <span class="in">`geom_boxplot()`</span> to make the boxplot narrower, so that it doesn't obscure the violin plot.</span>
<span id="cb116-417"><a href="#cb116-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-418"><a href="#cb116-418" aria-hidden="true" tabindex="-1"></a><span class="fu">### geom_bar / geom_col</span></span>
<span id="cb116-419"><a href="#cb116-419" aria-hidden="true" tabindex="-1"></a>The last pair of basic geoms we'll cover are <span class="in">`geom_bar()`</span> and <span class="in">`geom_col()`</span>, which are used to create bar plots. These are handy for visualising categorical data, such as the number of mice in each strain or the average weight loss for each dosage.</span>
<span id="cb116-420"><a href="#cb116-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-421"><a href="#cb116-421" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_bar()`</span> is used to create bar plots from counts of categorical data, while <span class="in">`geom_col()`</span> is used to create bar plots from pre-computed values. This means that if you have already calculated the counts or averages for each category, you should use <span class="in">`geom_col()`</span> instead of <span class="in">`geom_bar()`</span>.</span>
<span id="cb116-422"><a href="#cb116-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-423"><a href="#cb116-423" aria-hidden="true" tabindex="-1"></a>For example, if we wanted to create a bar plot of the number of mice in each strain with <span class="in">`geom_col()`</span>, we would first need to calculate the counts for each strain:</span>
<span id="cb116-424"><a href="#cb116-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-427"><a href="#cb116-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-428"><a href="#cb116-428" aria-hidden="true" tabindex="-1"></a><span class="co"># first count the number of mice per strain</span></span>
<span id="cb116-429"><a href="#cb116-429" aria-hidden="true" tabindex="-1"></a>mouse_counts <span class="ot">&lt;-</span> mousezempic_dosage_data <span class="sc">%&gt;%</span></span>
<span id="cb116-430"><a href="#cb116-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mouse_strain) <span class="sc">%&gt;%</span></span>
<span id="cb116-431"><a href="#cb116-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb116-432"><a href="#cb116-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-433"><a href="#cb116-433" aria-hidden="true" tabindex="-1"></a><span class="co"># then create the bar plot</span></span>
<span id="cb116-434"><a href="#cb116-434" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mouse_counts,</span>
<span id="cb116-435"><a href="#cb116-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb116-436"><a href="#cb116-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb116-437"><a href="#cb116-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-438"><a href="#cb116-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-439"><a href="#cb116-439" aria-hidden="true" tabindex="-1"></a>Whereas if we used <span class="in">`geom_bar()`</span>, we would not need to calculate the counts first:</span>
<span id="cb116-440"><a href="#cb116-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-443"><a href="#cb116-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-444"><a href="#cb116-444" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-445"><a href="#cb116-445" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-446"><a href="#cb116-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-447"><a href="#cb116-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb116-448"><a href="#cb116-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-449"><a href="#cb116-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-450"><a href="#cb116-450" aria-hidden="true" tabindex="-1"></a>Notice how we only specified the <span class="in">`x`</span> aesthetic in the <span class="in">`aes()`</span> function, and <span class="in">`geom_bar()`</span> automatically calculated the counts for each strain.</span>
<span id="cb116-451"><a href="#cb116-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-452"><a href="#cb116-452" aria-hidden="true" tabindex="-1"></a>The advantage of using <span class="in">`geom_bar()`</span> is that it is simpler and easier to read for plotting counts, but it can't be used for plotting pre-computed values. For example, if you wanted to plot the average weight loss for each strain, you would need to calculate the averages first with the dplyr functions we learned in @sec-session02 and use <span class="in">`geom_col()`</span>:</span>
<span id="cb116-453"><a href="#cb116-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-456"><a href="#cb116-456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-457"><a href="#cb116-457" aria-hidden="true" tabindex="-1"></a><span class="co"># first calculate the average weight loss for each strain</span></span>
<span id="cb116-458"><a href="#cb116-458" aria-hidden="true" tabindex="-1"></a>mouse_avg_weight_loss <span class="ot">&lt;-</span> mousezempic_dosage_data <span class="sc">%&gt;%</span></span>
<span id="cb116-459"><a href="#cb116-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mouse_strain) <span class="sc">%&gt;%</span></span>
<span id="cb116-460"><a href="#cb116-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_weight_loss =</span> <span class="fu">mean</span>(weight_lost_g))</span>
<span id="cb116-461"><a href="#cb116-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-462"><a href="#cb116-462" aria-hidden="true" tabindex="-1"></a><span class="co"># then create the bar plot</span></span>
<span id="cb116-463"><a href="#cb116-463" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mouse_avg_weight_loss,</span>
<span id="cb116-464"><a href="#cb116-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> avg_weight_loss)) <span class="sc">+</span></span>
<span id="cb116-465"><a href="#cb116-465" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb116-466"><a href="#cb116-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-467"><a href="#cb116-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-468"><a href="#cb116-468" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- </span><span class="al">###</span><span class="co"> geom_line</span></span>
<span id="cb116-469"><a href="#cb116-469" aria-hidden="true" tabindex="-1"></a><span class="co">Idk how useful geom_line is ? i feel like i use density more often</span></span>
<span id="cb116-470"><a href="#cb116-470" aria-hidden="true" tabindex="-1"></a><span class="co">As the name suggests, `geom_line()` is used to create line plots. These are useful for showing trends over time or across a continuous variable. Since we don't have a time variable in our dataset, let's use the `drug_dosage` variable to show how weight loss changes with increasing dosage:</span></span>
<span id="cb116-471"><a href="#cb116-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-474"><a href="#cb116-474" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-475"><a href="#cb116-475" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-476"><a href="#cb116-476" aria-hidden="true" tabindex="-1"></a><span class="co">ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +</span></span>
<span id="cb116-477"><a href="#cb116-477" aria-hidden="true" tabindex="-1"></a><span class="co">  geom_line()</span></span>
<span id="cb116-478"><a href="#cb116-478" aria-hidden="true" tabindex="-1"></a><span class="co">```</span></span>
<span id="cb116-479"><a href="#cb116-479" aria-hidden="true" tabindex="-1"></a><span class="co">(In reality the relationship between these variables is probably better represented as points on a scatterplot rather than as a line, but this is just an example of how you can use `geom_line()`).</span></span>
<span id="cb116-480"><a href="#cb116-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-481"><a href="#cb116-481" aria-hidden="true" tabindex="-1"></a><span class="co">It's also possible to combine `geom_line()` with `geom_point()` to show the individual data points as well as the connection between them:</span></span>
<span id="cb116-482"><a href="#cb116-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-485"><a href="#cb116-485" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-486"><a href="#cb116-486" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-487"><a href="#cb116-487" aria-hidden="true" tabindex="-1"></a><span class="co">ggplot(data = mousezempic_dosage_data, aes(x = drug_dose_g, y = weight_lost_g)) +</span></span>
<span id="cb116-488"><a href="#cb116-488" aria-hidden="true" tabindex="-1"></a><span class="co">  geom_line() +</span></span>
<span id="cb116-489"><a href="#cb116-489" aria-hidden="true" tabindex="-1"></a><span class="co">  geom_point()</span></span>
<span id="cb116-490"><a href="#cb116-490" aria-hidden="true" tabindex="-1"></a><span class="co">```</span></span>
<span id="cb116-491"><a href="#cb116-491" aria-hidden="true" tabindex="-1"></a><span class="co"> --&gt;</span></span>
<span id="cb116-492"><a href="#cb116-492" aria-hidden="true" tabindex="-1"></a><span class="fu">### geom_hline / geom_vline</span></span>
<span id="cb116-493"><a href="#cb116-493" aria-hidden="true" tabindex="-1"></a>The <span class="in">`geom_hline()`</span> and <span class="in">`geom_vline()`</span> functions are used to add horizontal and vertical lines to a plot, respectively. Although you'll probably never use them alone, they are great to add to your plots to highlight specific values or thresholds in your data. To use them, you need to specify the <span class="in">`yintercept`</span> (for <span class="in">`geom_hline()`</span>) or <span class="in">`xintercept`</span> (for <span class="in">`geom_vline()`</span>) argument, which specifies where to draw the line.</span>
<span id="cb116-494"><a href="#cb116-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-495"><a href="#cb116-495" aria-hidden="true" tabindex="-1"></a>For example, let's add a horizontal line to our scatterplot of drug dosage and weight loss at the 4g mark, which might represent a clinically significant amount of weight loss:</span>
<span id="cb116-496"><a href="#cb116-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-499"><a href="#cb116-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-500"><a href="#cb116-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-501"><a href="#cb116-501" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-502"><a href="#cb116-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-503"><a href="#cb116-503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>)</span>
<span id="cb116-504"><a href="#cb116-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-505"><a href="#cb116-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-506"><a href="#cb116-506" aria-hidden="true" tabindex="-1"></a>We could also add a vertical line at the 0.0025g mark to show the theorectical maximum dosage of the drug:</span>
<span id="cb116-507"><a href="#cb116-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-510"><a href="#cb116-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-511"><a href="#cb116-511" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-512"><a href="#cb116-512" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-513"><a href="#cb116-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-514"><a href="#cb116-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb116-515"><a href="#cb116-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">0.0025</span>)</span>
<span id="cb116-516"><a href="#cb116-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-517"><a href="#cb116-517" aria-hidden="true" tabindex="-1"></a>Notice how adding this line extends the x axis to include 0.0025, even though there are no data points at that value. This is because, by default, ggplot2 chooses axes limits for you that include all the data and any additional layers you add to the plot.</span>
<span id="cb116-518"><a href="#cb116-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-519"><a href="#cb116-519" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="Practice exercises"}</span>
<span id="cb116-520"><a href="#cb116-520" aria-hidden="true" tabindex="-1"></a>Try these practice questions to test your understanding</span>
<span id="cb116-521"><a href="#cb116-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-522"><a href="#cb116-522" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-523"><a href="#cb116-523" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> Which geom could you use to create a boxplot?</span>
<span id="cb116-524"><a href="#cb116-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-525"><a href="#cb116-525" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-526"><a href="#cb116-526" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-527"><a href="#cb116-527" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_boxplot()`</span></span>
<span id="cb116-528"><a href="#cb116-528" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-529"><a href="#cb116-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-530"><a href="#cb116-530" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-531"><a href="#cb116-531" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_box()`</span></span>
<span id="cb116-532"><a href="#cb116-532" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-533"><a href="#cb116-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-534"><a href="#cb116-534" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-535"><a href="#cb116-535" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_col()`</span></span>
<span id="cb116-536"><a href="#cb116-536" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-537"><a href="#cb116-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-538"><a href="#cb116-538" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-539"><a href="#cb116-539" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_violin()`</span></span>
<span id="cb116-540"><a href="#cb116-540" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-541"><a href="#cb116-541" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-542"><a href="#cb116-542" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-543"><a href="#cb116-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-544"><a href="#cb116-544" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-545"><a href="#cb116-545" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> Which of the following lines of code is a valid way to create a violin plot of the tail length of the mice by strain, with points overlaid?</span>
<span id="cb116-546"><a href="#cb116-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-547"><a href="#cb116-547" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-548"><a href="#cb116-548" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-549"><a href="#cb116-549" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin(geom_point(position = position_jitter(width = 0.2))) `</span></span>
<span id="cb116-550"><a href="#cb116-550" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-551"><a href="#cb116-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-552"><a href="#cb116-552" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-553"><a href="#cb116-553" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_point(position = position_jitter(width = 0.2))`</span></span>
<span id="cb116-554"><a href="#cb116-554" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-555"><a href="#cb116-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-556"><a href="#cb116-556" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-557"><a href="#cb116-557" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin()`</span></span>
<span id="cb116-558"><a href="#cb116-558" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-559"><a href="#cb116-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-560"><a href="#cb116-560" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-561"><a href="#cb116-561" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin() + geom_point(position = position_jitter(width = 0.2))`</span></span>
<span id="cb116-562"><a href="#cb116-562" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-563"><a href="#cb116-563" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-564"><a href="#cb116-564" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-565"><a href="#cb116-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-566"><a href="#cb116-566" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-567"><a href="#cb116-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-568"><a href="#cb116-568" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>What does this code do?</span>
<span id="cb116-569"><a href="#cb116-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-572"><a href="#cb116-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-573"><a href="#cb116-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-574"><a href="#cb116-574" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb116-575"><a href="#cb116-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb116-576"><a href="#cb116-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">60</span>)</span>
<span id="cb116-577"><a href="#cb116-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-578"><a href="#cb116-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-579"><a href="#cb116-579" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-580"><a href="#cb116-580" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-581"><a href="#cb116-581" aria-hidden="true" tabindex="-1"></a>Makes a box plot of the number of mice in each cage, with a horizontal line at 60.</span>
<span id="cb116-582"><a href="#cb116-582" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-583"><a href="#cb116-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-584"><a href="#cb116-584" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-585"><a href="#cb116-585" aria-hidden="true" tabindex="-1"></a>Makes a bar plot of the number of cages in the dataset, with a horizontal line at 60.</span>
<span id="cb116-586"><a href="#cb116-586" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-587"><a href="#cb116-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-588"><a href="#cb116-588" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-589"><a href="#cb116-589" aria-hidden="true" tabindex="-1"></a>Makes a bar plot of the number of mice in each cage, with a horizontal line at 60.</span>
<span id="cb116-590"><a href="#cb116-590" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-591"><a href="#cb116-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-592"><a href="#cb116-592" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-593"><a href="#cb116-593" aria-hidden="true" tabindex="-1"></a>Makes a bar plot of the number of mice in each cage</span>
<span id="cb116-594"><a href="#cb116-594" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-595"><a href="#cb116-595" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-596"><a href="#cb116-596" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-597"><a href="#cb116-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-598"><a href="#cb116-598" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-599"><a href="#cb116-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-600"><a href="#cb116-600" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Solutions<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb116-601"><a href="#cb116-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-602"><a href="#cb116-602" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The correct answer is <span class="in">`geom_boxplot()`</span>. This is the function used to create boxplots in ggplot2.</span>
<span id="cb116-603"><a href="#cb116-603" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The correct way to create a violin plot of the tail length of the mice by strain, with points overlaid, is <span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = mouse_strain, y = tail_length_mm)) + geom_violin() + geom_point(position = position_jitter(width = 0.2))`</span>. This specifies the data and mapping in the <span class="in">`ggplot()`</span> function call, adds a layer of violin plots using <span class="in">`geom_violin()`</span>, and then adds a layer of points using <span class="in">`geom_point()`</span> with jittered positions to avoid overlapping.</span>
<span id="cb116-604"><a href="#cb116-604" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>The code creates a bar plot of the number of mice in each cage, with a horizontal line at 60. The <span class="in">`geom_bar()`</span> function counts the number of mice in each cage and plots the counts as bars, while the <span class="in">`geom_hline()`</span> function adds a horizontal line at the y value of 60. This could be used to show a threshold e.g. for the maximum number of mice allowed in a cage.</span>
<span id="cb116-605"><a href="#cb116-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-606"><a href="#cb116-606" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-607"><a href="#cb116-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-608"><a href="#cb116-608" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-609"><a href="#cb116-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-610"><a href="#cb116-610" aria-hidden="true" tabindex="-1"></a><span class="fu">## Aesthetics and scales</span></span>
<span id="cb116-611"><a href="#cb116-611" aria-hidden="true" tabindex="-1"></a>Now that we've learned some of the common geoms we can use to physically represent our data, let's discuss the aesthetics that govern how these geoms look and the scales that map our data to these aesthetics.</span>
<span id="cb116-612"><a href="#cb116-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-613"><a href="#cb116-613" aria-hidden="true" tabindex="-1"></a><span class="fu">### Aesthetics</span></span>
<span id="cb116-614"><a href="#cb116-614" aria-hidden="true" tabindex="-1"></a>As described earlier, aesthetics are the visual properties of the geoms that we can control, such as colour, position, size and shape. We saw how the <span class="in">`colour`</span> aesthetic could be used in all layers of the plot to show the strain of each mouse, by specifying <span class="in">`colour = mouse_strain`</span> in the <span class="in">`aes()`</span> function:</span>
<span id="cb116-615"><a href="#cb116-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-618"><a href="#cb116-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-619"><a href="#cb116-619" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-620"><a href="#cb116-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-621"><a href="#cb116-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-622"><a href="#cb116-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb116-623"><a href="#cb116-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-624"><a href="#cb116-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-625"><a href="#cb116-625" aria-hidden="true" tabindex="-1"></a>It's also possible to specify aesthetics for specific geoms, rather than for the whole plot. For example, let's say we wanted to colour the points by mouse strain, but just have a single trendline for all of the data (rather than one for each strain, like we have above). We could do this by specifying the <span class="in">`colour`</span> aesthetic in the <span class="in">`geom_point()`</span> layer, rather than in the <span class="in">`ggplot()`</span> function:</span>
<span id="cb116-626"><a href="#cb116-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-629"><a href="#cb116-629" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-630"><a href="#cb116-630" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-631"><a href="#cb116-631" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-632"><a href="#cb116-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-633"><a href="#cb116-633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-634"><a href="#cb116-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span>
<span id="cb116-635"><a href="#cb116-635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-636"><a href="#cb116-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-637"><a href="#cb116-637" aria-hidden="true" tabindex="-1"></a>This allows us to have different aesthetics for different layers of the plot, giving us the power to create some really complex visualisations.</span>
<span id="cb116-638"><a href="#cb116-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-639"><a href="#cb116-639" aria-hidden="true" tabindex="-1"></a>Different geoms can accept different aesthetics. For example, let's try using the <span class="in">`colour`</span> aesthetic to colour a boxplot of tail length by mouse strain:</span>
<span id="cb116-640"><a href="#cb116-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-643"><a href="#cb116-643" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-644"><a href="#cb116-644" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-645"><a href="#cb116-645" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-646"><a href="#cb116-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-647"><a href="#cb116-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb116-648"><a href="#cb116-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-649"><a href="#cb116-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-650"><a href="#cb116-650" aria-hidden="true" tabindex="-1"></a>Notice how the outline of the boxplot is coloured by strain, but the fill is not. For geoms that show an area of some sort (like boxplots, histograms, violin plots or bar charts), they have both a <span class="in">`colour`</span> aesthetic that controls the colour of the outline of the shape, and a <span class="in">`fill`</span> aesthetic that controls the fill colour. So if we wanted the boxplot to be filled with the colour of the strain, we should use the <span class="in">`fill`</span> aesthetic instead:</span>
<span id="cb116-651"><a href="#cb116-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-654"><a href="#cb116-654" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-655"><a href="#cb116-655" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-656"><a href="#cb116-656" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-657"><a href="#cb116-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> tail_length_mm, <span class="at">fill =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-658"><a href="#cb116-658" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb116-659"><a href="#cb116-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-660"><a href="#cb116-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-661"><a href="#cb116-661" aria-hidden="true" tabindex="-1"></a>You can see all of the aesthetics that a geom accepts by checking its help page (e.g. <span class="in">`?geom_boxplot`</span>) and reading the "Aesthetics" section.</span>
<span id="cb116-662"><a href="#cb116-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-663"><a href="#cb116-663" aria-hidden="true" tabindex="-1"></a><span class="fu">### Combining multiple aesthetics</span></span>
<span id="cb116-664"><a href="#cb116-664" aria-hidden="true" tabindex="-1"></a>Notice how in the last example, we used mapped the same variable (<span class="in">`mouse_strain`</span>) to both the <span class="in">`x`</span> and <span class="in">`fill`</span> aesthetics. It's often helpful to show the same variable through multiple aesthetics, as it can convey the information more clearly. As another example, for the scatterplot example we used earlier, we could also use the <span class="in">`shape`</span> aesthetic to show the strain of each mouse:</span>
<span id="cb116-665"><a href="#cb116-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-668"><a href="#cb116-668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-669"><a href="#cb116-669" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-670"><a href="#cb116-670" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-671"><a href="#cb116-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain, <span class="at">shape =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-672"><a href="#cb116-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-673"><a href="#cb116-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-674"><a href="#cb116-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-675"><a href="#cb116-675" aria-hidden="true" tabindex="-1"></a>Now we can see the strain of each mouse through both colour and shape, which makes it even easier to distinguish between the different strains.</span>
<span id="cb116-676"><a href="#cb116-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-677"><a href="#cb116-677" aria-hidden="true" tabindex="-1"></a>Of course, we may instead want to use aesthetics to add additional variables to our visualisation. To illustrate this, let's make a scatterplot that visualises the initial weight and tail length of each mouse, but also shows the drug dosage, cage number and mouse strain:</span>
<span id="cb116-678"><a href="#cb116-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-681"><a href="#cb116-681" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-682"><a href="#cb116-682" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-683"><a href="#cb116-683" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-684"><a href="#cb116-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">size =</span> drug_dose_g, <span class="at">colour =</span> mouse_strain, <span class="at">shape =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb116-685"><a href="#cb116-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-686"><a href="#cb116-686" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-687"><a href="#cb116-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-688"><a href="#cb116-688" aria-hidden="true" tabindex="-1"></a>Looks pretty crazy right? There's no limit to the number of aesthetics you can use in a single plot, but it's important to remember that the more aesthetics you add, the harder it is to interpret. Try to keep it simple and only add aesthetics that are necessary to convey key information.</span>
<span id="cb116-689"><a href="#cb116-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-690"><a href="#cb116-690" aria-hidden="true" tabindex="-1"></a><span class="fu">### Scales</span></span>
<span id="cb116-691"><a href="#cb116-691" aria-hidden="true" tabindex="-1"></a>Scales control how particular data values/variables are mapped to aesthetics. For example, when we specify <span class="in">`colour = mouse_strain`</span>, ggplot2 automatically chooses a colour palette to use for each strain. Scales are specified using the <span class="in">`scale_*`</span> functions, where <span class="in">`*`</span> is the name of the aesthetic you want to control (e.g. <span class="in">`scale_colour`</span>, <span class="in">`scale_size`</span>, etc.) and the arguments control how data will be visually represented e.g. the colour palette used for the <span class="in">`colour`</span> aesthetic, or the range of size of the points for the <span class="in">`size`</span> aesthetic. You add scale functions to your plot using the <span class="in">`+`</span> operator, just like you do with geoms.</span>
<span id="cb116-692"><a href="#cb116-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-693"><a href="#cb116-693" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Colours</span></span>
<span id="cb116-694"><a href="#cb116-694" aria-hidden="true" tabindex="-1"></a>One thing you'll often want to do is change the colour palette. You can do this manually, using either the <span class="in">`scale_colour_manual()`</span> function (for categorical variables) or the <span class="in">`scale_colour_gradient()`</span> function (for continuous variables). For example, if we wanted to use a different colour palette for the mouse strains in our scatterplot, we would use <span class="in">`scale_colour_manual()`</span> as follows:</span>
<span id="cb116-695"><a href="#cb116-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-698"><a href="#cb116-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-699"><a href="#cb116-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-700"><a href="#cb116-700" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-701"><a href="#cb116-701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-702"><a href="#cb116-702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-703"><a href="#cb116-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>))</span>
<span id="cb116-704"><a href="#cb116-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-705"><a href="#cb116-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-706"><a href="#cb116-706" aria-hidden="true" tabindex="-1"></a>When using <span class="in">`scale_colour_manual()`</span>, you need to provide to the <span class="in">`values`</span> argument a vector of colours that matches the number of levels in the variable you're mapping to colour. In the example above, we have three mouse strains, so we need to provide three colours in the <span class="in">`values`</span> argument.</span>
<span id="cb116-707"><a href="#cb116-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-708"><a href="#cb116-708" aria-hidden="true" tabindex="-1"></a>R has a range of built-in colours that you can use, such as "red", "blue", "green", etc., but you can also use <span class="co">[</span><span class="ot">hex codes</span><span class="co">](https://www.w3schools.com/html/html_colors_hex.asp)</span> to specify colours:</span>
<span id="cb116-709"><a href="#cb116-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-712"><a href="#cb116-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-713"><a href="#cb116-713" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-714"><a href="#cb116-714" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-715"><a href="#cb116-715" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-716"><a href="#cb116-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-717"><a href="#cb116-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#f45c2e"</span>, <span class="st">"#912247"</span>, <span class="st">"#039f22"</span>))</span>
<span id="cb116-718"><a href="#cb116-718" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-719"><a href="#cb116-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-720"><a href="#cb116-720" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Colour highlighting in RStudio"}</span>
<span id="cb116-721"><a href="#cb116-721" aria-hidden="true" tabindex="-1"></a>To help you see the colours you're using, RStudio will highlight the colour names and hex codes when you type them in your R script panel:</span>
<span id="cb116-722"><a href="#cb116-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-723"><a href="#cb116-723" aria-hidden="true" tabindex="-1"></a><span class="al">![RStudio colour highlighting](images/S03F04_colours.png)</span></span>
<span id="cb116-724"><a href="#cb116-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-725"><a href="#cb116-725" aria-hidden="true" tabindex="-1"></a>If it doesn't do this automatically, you can turn it on by going to <span class="in">`Tools`</span> &gt; <span class="in">`Global Options`</span> &gt; <span class="in">`Code`</span> &gt; <span class="in">`Display`</span> and checking the "Enable preview of named and hexadecimal colours" option.</span>
<span id="cb116-726"><a href="#cb116-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-727"><a href="#cb116-727" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-728"><a href="#cb116-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-729"><a href="#cb116-729" aria-hidden="true" tabindex="-1"></a>So far, we've only used colour to visualise categorical variables, but it can also be used to visualise continuous variables. As an example, let's colour each point in our scatterplot of initial weight and tail length by the drug dosage:</span>
<span id="cb116-730"><a href="#cb116-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-733"><a href="#cb116-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-734"><a href="#cb116-734" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-735"><a href="#cb116-735" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-736"><a href="#cb116-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> drug_dose_g)) <span class="sc">+</span></span>
<span id="cb116-737"><a href="#cb116-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-738"><a href="#cb116-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-739"><a href="#cb116-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-740"><a href="#cb116-740" aria-hidden="true" tabindex="-1"></a>The points are now coloured based on the drug dosage, using a default gradient of blue colours. You can change the colour of the gradient using the <span class="in">`scale_colour_gradient()`</span> function, which allows you to specify the colours to use for the low and high ends of the gradient:</span>
<span id="cb116-741"><a href="#cb116-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-744"><a href="#cb116-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-745"><a href="#cb116-745" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-746"><a href="#cb116-746" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-747"><a href="#cb116-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> drug_dose_g)) <span class="sc">+</span></span>
<span id="cb116-748"><a href="#cb116-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-749"><a href="#cb116-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_gradient</span>(<span class="at">low =</span> <span class="st">"yellow"</span>, <span class="at">high =</span> <span class="st">"red"</span>)</span>
<span id="cb116-750"><a href="#cb116-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-751"><a href="#cb116-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-752"><a href="#cb116-752" aria-hidden="true" tabindex="-1"></a>We now have a gradient from yellow to red.</span>
<span id="cb116-753"><a href="#cb116-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-754"><a href="#cb116-754" aria-hidden="true" tabindex="-1"></a>Instead of specifying colours manually, there are also a range of pre-defined colour palettes you can use, such as <span class="in">`scale_colour_brewer()`</span> or <span class="in">`scale_colour_viridis()`</span>. Check out their help pages to learn more about them, or try the <span class="co">[</span><span class="ot">paleteer package</span><span class="co">](https://r-graph-gallery.com/package/paletteer.html)</span> for a huge range of other pre-defined colour palettes.</span>
<span id="cb116-755"><a href="#cb116-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-756"><a href="#cb116-756" aria-hidden="true" tabindex="-1"></a><span class="fu">#### The x and y axes</span></span>
<span id="cb116-757"><a href="#cb116-757" aria-hidden="true" tabindex="-1"></a>Scales are also used to control the x and y axes. In particular, it can be handy to specify the limits of the axes, or to apply some sort of transformation to the data.</span>
<span id="cb116-758"><a href="#cb116-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-759"><a href="#cb116-759" aria-hidden="true" tabindex="-1"></a>By default, ggplot2 will automatically choose the limits of the x and y axes based on the data you provide. For example, look at the scatterplots of initial weight and tail length we created earlier, and you'll see that the origin (0,0) is not shown because there are no data points near there. If we wanted to, we could change the limits of the axes using the <span class="in">`xlim()`</span> and <span class="in">`ylim()`</span> functions to include the origin:</span>
<span id="cb116-760"><a href="#cb116-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-763"><a href="#cb116-763" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-764"><a href="#cb116-764" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-765"><a href="#cb116-765" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-766"><a href="#cb116-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-767"><a href="#cb116-767" aria-hidden="true" tabindex="-1"></a>  <span class="co"># specify axis limits like xlim(min, max)</span></span>
<span id="cb116-768"><a href="#cb116-768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb116-769"><a href="#cb116-769" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if we want to use the automatic limit, use NA instead of a max value</span></span>
<span id="cb116-770"><a href="#cb116-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="cn">NA</span>)</span>
<span id="cb116-771"><a href="#cb116-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-772"><a href="#cb116-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-773"><a href="#cb116-773" aria-hidden="true" tabindex="-1"></a>Notice how different this makes the plot look! Choosing appropriate axis limits is important for accurately conveying the data, so it's worth spending some time thinking about what limits to use.</span>
<span id="cb116-774"><a href="#cb116-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-775"><a href="#cb116-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-776"><a href="#cb116-776" aria-hidden="true" tabindex="-1"></a>By default, ggplot2 uses a linear scale for both axes, but you can change this to a logarithmic scale using the <span class="in">`scale_x_log10()`</span> or <span class="in">`scale_y_log10()`</span> functions. This is useful when you have data that spans several orders of magnitude.</span>
<span id="cb116-777"><a href="#cb116-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-778"><a href="#cb116-778" aria-hidden="true" tabindex="-1"></a>We don't have anything like this in our <span class="in">`mousezempic_dosage_data`</span> dataset, so let's use the <span class="in">`diamonds`</span> dataset that comes with ggplot2 to demonstrate this. The <span class="in">`diamonds`</span> dataset contains information about the price and carat weight of diamonds, both of which are continuous variables that span several orders of magnitude. Let's create a scatterplot of the price and carat of the diamonds:</span>
<span id="cb116-779"><a href="#cb116-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-782"><a href="#cb116-782" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-783"><a href="#cb116-783" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">y =</span> price, <span class="at">x =</span> carat)) <span class="sc">+</span></span>
<span id="cb116-784"><a href="#cb116-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-785"><a href="#cb116-785" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-786"><a href="#cb116-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-787"><a href="#cb116-787" aria-hidden="true" tabindex="-1"></a>To linearise this relationship, we can apply a log10 transformation to the x and y axes using the <span class="in">`scale_x_log10()`</span> and <span class="in">`scale_y_log10()`</span> functions:</span>
<span id="cb116-788"><a href="#cb116-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-791"><a href="#cb116-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-792"><a href="#cb116-792" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds, <span class="fu">aes</span>(<span class="at">y =</span> price, <span class="at">x =</span> carat)) <span class="sc">+</span></span>
<span id="cb116-793"><a href="#cb116-793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb116-794"><a href="#cb116-794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb116-795"><a href="#cb116-795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span>
<span id="cb116-796"><a href="#cb116-796" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-797"><a href="#cb116-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-798"><a href="#cb116-798" aria-hidden="true" tabindex="-1"></a>Notice how the points are now more evenly distributed across the plot, and we can see the relationship between carat and price more clearly.</span>
<span id="cb116-799"><a href="#cb116-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-800"><a href="#cb116-800" aria-hidden="true" tabindex="-1"></a><span class="fu">### Positions</span></span>
<span id="cb116-801"><a href="#cb116-801" aria-hidden="true" tabindex="-1"></a>Positions aren't really an aesthetic, but they are a way to control how geoms are displayed, particularly when parts of that geom overlap. We saw the position argument earlier in the <span class="in">`geom_point()`</span> function, where we used <span class="in">`position = position_jitter()`</span> to spread out the points in a dot plot. This is a common use of the position argument, but there are other ways it is helpful too.</span>
<span id="cb116-802"><a href="#cb116-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-803"><a href="#cb116-803" aria-hidden="true" tabindex="-1"></a>For example, when we are using <span class="in">`geom_bar()`</span> to create a bar plot that is coloured by a categorical variable, the bars will be stacked on top of each other by default. Let's illustrate this by creating a bar plot of the number of mice in each strain, coloured by the sex of the mouse:</span>
<span id="cb116-804"><a href="#cb116-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-807"><a href="#cb116-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-808"><a href="#cb116-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-809"><a href="#cb116-809" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-810"><a href="#cb116-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb116-811"><a href="#cb116-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb116-812"><a href="#cb116-812" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-813"><a href="#cb116-813" aria-hidden="true" tabindex="-1"></a>Having the bars stacked up is useful when you want to see the total count for each strain, but it can make it difficult to see the individual counts for sex. Instead, we can use the <span class="in">`position = "dodge"`</span> argument in <span class="in">`geom_bar()`</span> to place the bars side by side:</span>
<span id="cb116-814"><a href="#cb116-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-817"><a href="#cb116-817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-818"><a href="#cb116-818" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-819"><a href="#cb116-819" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-820"><a href="#cb116-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">fill =</span> sex)) <span class="sc">+</span></span>
<span id="cb116-821"><a href="#cb116-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"dodge"</span>)</span>
<span id="cb116-822"><a href="#cb116-822" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-823"><a href="#cb116-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-824"><a href="#cb116-824" aria-hidden="true" tabindex="-1"></a>Notice how there is now a bar for each sex in each strain, and it's easier to examine the sex distribution of each strain (but equally harder to appreciate the total number of mice in each strain!). There's no right or wrong way to lay out the bars, but it's worth trying both and seeing which one works best for the message you want to convey.</span>
<span id="cb116-825"><a href="#cb116-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-826"><a href="#cb116-826" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="Practice exercises"}</span>
<span id="cb116-827"><a href="#cb116-827" aria-hidden="true" tabindex="-1"></a>Try these practice questions to test your understanding</span>
<span id="cb116-828"><a href="#cb116-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-829"><a href="#cb116-829" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-830"><a href="#cb116-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-831"><a href="#cb116-831" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> What kind of plot would the following code make?</span>
<span id="cb116-832"><a href="#cb116-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-835"><a href="#cb116-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-836"><a href="#cb116-836" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-837"><a href="#cb116-837" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-838"><a href="#cb116-838" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-839"><a href="#cb116-839" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb116-840"><a href="#cb116-840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain), <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.3</span>))</span>
<span id="cb116-841"><a href="#cb116-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-842"><a href="#cb116-842" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-843"><a href="#cb116-843" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-844"><a href="#cb116-844" aria-hidden="true" tabindex="-1"></a>A violin plot of tail length by mouse strain, with points overlaid</span>
<span id="cb116-845"><a href="#cb116-845" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-846"><a href="#cb116-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-847"><a href="#cb116-847" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-848"><a href="#cb116-848" aria-hidden="true" tabindex="-1"></a>A violin plot of tail length by mouse strain, with points overlaid. The points are jittered to avoid overlapping. The points and the violin plots are both coloured by mouse strain.</span>
<span id="cb116-849"><a href="#cb116-849" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-850"><a href="#cb116-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-851"><a href="#cb116-851" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-852"><a href="#cb116-852" aria-hidden="true" tabindex="-1"></a>A dot plot of tail length by mouse strain. The points are jittered to avoid overlapping and are coloured by mouse strain.</span>
<span id="cb116-853"><a href="#cb116-853" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-854"><a href="#cb116-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-855"><a href="#cb116-855" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-856"><a href="#cb116-856" aria-hidden="true" tabindex="-1"></a>A violin plot of tail length by mouse strain, with points overlaid. The points are jittered to avoid overlapping and are coloured by mouse strain. The violin plot is not coloured.</span>
<span id="cb116-857"><a href="#cb116-857" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-858"><a href="#cb116-858" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-859"><a href="#cb116-859" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-860"><a href="#cb116-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-861"><a href="#cb116-861" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-862"><a href="#cb116-862" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> I would like to make a scatterplot of initial weight and tail length, but I also want to show the weight lost by each mouse using colour with the viridis palette. Which of the following lines of code would do this?</span>
<span id="cb116-863"><a href="#cb116-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-864"><a href="#cb116-864" aria-hidden="true" tabindex="-1"></a>Hint: You can use the <span class="in">`scale_colour_viridis_c()`</span> function to apply the viridis colour palette to a continuous variable.</span>
<span id="cb116-865"><a href="#cb116-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-866"><a href="#cb116-866" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-867"><a href="#cb116-867" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-868"><a href="#cb116-868" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point() + scale_colour_viridis_c()`</span></span>
<span id="cb116-869"><a href="#cb116-869" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-870"><a href="#cb116-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-871"><a href="#cb116-871" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-872"><a href="#cb116-872" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point()`</span></span>
<span id="cb116-873"><a href="#cb116-873" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-874"><a href="#cb116-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-875"><a href="#cb116-875" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-876"><a href="#cb116-876" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + scale_colour_viridis_c()`</span></span>
<span id="cb116-877"><a href="#cb116-877" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-878"><a href="#cb116-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-879"><a href="#cb116-879" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-880"><a href="#cb116-880" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point(scale_colour_viridis_c())`</span></span>
<span id="cb116-881"><a href="#cb116-881" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-882"><a href="#cb116-882" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-883"><a href="#cb116-883" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-884"><a href="#cb116-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-885"><a href="#cb116-885" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-886"><a href="#cb116-886" aria-hidden="true" tabindex="-1"></a>3<span class="sc">\.</span> How can I make a histogram of the tail length of the mice, with 10 bins and coloured by mouse strain, with the different strains side by side?</span>
<span id="cb116-887"><a href="#cb116-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-888"><a href="#cb116-888" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-889"><a href="#cb116-889" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-890"><a href="#cb116-890" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10)`</span></span>
<span id="cb116-891"><a href="#cb116-891" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-892"><a href="#cb116-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-893"><a href="#cb116-893" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-894"><a href="#cb116-894" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10, position = "dodge")`</span></span>
<span id="cb116-895"><a href="#cb116-895" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-896"><a href="#cb116-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-897"><a href="#cb116-897" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-898"><a href="#cb116-898" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10, position = "stack")`</span></span>
<span id="cb116-899"><a href="#cb116-899" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-900"><a href="#cb116-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-901"><a href="#cb116-901" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-902"><a href="#cb116-902" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm)) + geom_histogram(bins = 10)`</span></span>
<span id="cb116-903"><a href="#cb116-903" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-904"><a href="#cb116-904" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-905"><a href="#cb116-905" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-906"><a href="#cb116-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-907"><a href="#cb116-907" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-908"><a href="#cb116-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-909"><a href="#cb116-909" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Solutions<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb116-910"><a href="#cb116-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-911"><a href="#cb116-911" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The correct answer is "A violin plot of tail length by mouse strain, with points overlaid. The points are jittered to avoid overlapping and are coloured by mouse strain. The violin plot is not coloured." Note that because we specified the <span class="in">`aes(colour = mouse_strain)`</span> argument within <span class="in">`geom_point()`</span> and not in the <span class="in">`ggplot()`</span> function, **only the points will be coloured by mouse strain**, while the violin plot will not be coloured.</span>
<span id="cb116-912"><a href="#cb116-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-913"><a href="#cb116-913" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The correct answer is <span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = initial_weight_g, y = tail_length_mm, colour = weight_lost_g)) + geom_point() + scale_colour_viridis_c()`</span>. This code creates a scatterplot of initial weight and tail length, with the points coloured by weight lost using the viridis colour palette. Remember that we add scales to the plot using the <span class="in">`+`</span> operator, just like we do with geoms, and that we need to specify the <span class="in">`colour`</span> aesthetic in the <span class="in">`aes()`</span> function to map the weight lost to colour.</span>
<span id="cb116-914"><a href="#cb116-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-915"><a href="#cb116-915" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>The correct answer is <span class="in">`ggplot(data = mousezempic_dosage_data, aes(x = tail_length_mm, fill = mouse_strain)) + geom_histogram(bins = 10, position = "dodge")`</span>. Remember that the <span class="in">`position = "dodge"`</span> argument in <span class="in">`geom_histogram()`</span> specifies that the bars should be placed side by side rather than stacked on top of each other (the default behaviour). Also note that histograms, like bar plots, use the <span class="in">`fill`</span> aesthetic to colour the entire bars (the <span class="in">`colour`</span> aesthetic is only used to colour the outline of the bars).</span>
<span id="cb116-916"><a href="#cb116-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-917"><a href="#cb116-917" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-918"><a href="#cb116-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-919"><a href="#cb116-919" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-920"><a href="#cb116-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-921"><a href="#cb116-921" aria-hidden="true" tabindex="-1"></a><span class="fu">## Making a plot pretty</span></span>
<span id="cb116-922"><a href="#cb116-922" aria-hidden="true" tabindex="-1"></a>Now that we've covered the basics of creating plots in ggplot2, let's talk about how to make them look good! Of course there are countless ways to customise the appearance of a plot in ggplot2. We'll cover a few of the most common ones here to give you a starting point, but if you're wanting to do something specific, you can often find a solution online, by using AI or by <span class="co">[</span><span class="ot">reading the ggplot2 documentation</span><span class="co">](https://ggplot2-book.org/themes.html)</span>.</span>
<span id="cb116-923"><a href="#cb116-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-924"><a href="#cb116-924" aria-hidden="true" tabindex="-1"></a><span class="fu">### Labels and text</span></span>
<span id="cb116-925"><a href="#cb116-925" aria-hidden="true" tabindex="-1"></a>One thing you'll want to do is add labels to your plot, such as a title, axis labels and/or a caption. You can do this quickly and easily with the <span class="in">`labs()`</span> function. For example, let's add labels to our scatterplot:</span>
<span id="cb116-926"><a href="#cb116-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-929"><a href="#cb116-929" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-930"><a href="#cb116-930" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-931"><a href="#cb116-931" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-932"><a href="#cb116-932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-933"><a href="#cb116-933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-934"><a href="#cb116-934" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add labels to the plot</span></span>
<span id="cb116-935"><a href="#cb116-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-936"><a href="#cb116-936" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-937"><a href="#cb116-937" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb116-938"><a href="#cb116-938" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Data from the mousezempic_dosage_data dataset"</span>)</span>
<span id="cb116-939"><a href="#cb116-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-940"><a href="#cb116-940" aria-hidden="true" tabindex="-1"></a>You don't need to specify all of these labels (just omit the ones you don't want).</span>
<span id="cb116-941"><a href="#cb116-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-942"><a href="#cb116-942" aria-hidden="true" tabindex="-1"></a>It's also possible to change the way that the axes are labelled. You can do this by adding the <span class="in">`labels`</span> argument to the appropriate x or y scale functions. For example, if we made the following plot of drug dosage and weight loss:</span>
<span id="cb116-943"><a href="#cb116-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-946"><a href="#cb116-946" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-947"><a href="#cb116-947" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-948"><a href="#cb116-948" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-949"><a href="#cb116-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-950"><a href="#cb116-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb116-951"><a href="#cb116-951" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-952"><a href="#cb116-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-953"><a href="#cb116-953" aria-hidden="true" tabindex="-1"></a>We could use the <span class="in">`scale_x_continuous()`</span> function to label the x axis in scientific notation:</span>
<span id="cb116-954"><a href="#cb116-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-957"><a href="#cb116-957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-958"><a href="#cb116-958" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-959"><a href="#cb116-959" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-960"><a href="#cb116-960" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-961"><a href="#cb116-961" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-962"><a href="#cb116-962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">label_scientific</span>()) <span class="sc">+</span></span>
<span id="cb116-963"><a href="#cb116-963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb116-964"><a href="#cb116-964" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between drug dosage and weight loss"</span>,</span>
<span id="cb116-965"><a href="#cb116-965" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb116-966"><a href="#cb116-966" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>)</span>
<span id="cb116-967"><a href="#cb116-967" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-968"><a href="#cb116-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-969"><a href="#cb116-969" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Accessing functions using ::"}</span>
<span id="cb116-970"><a href="#cb116-970" aria-hidden="true" tabindex="-1"></a>You may have noticed that we used <span class="in">`scales::label_scientific()`</span> to access the <span class="in">`label_scientific()`</span> function. This is because we haven't loaded <span class="in">`scales`</span> package (i.e. we haven't run <span class="in">`library(scales)`</span>), so we need to specify the package name to access the function. You can do this for any function in R by using the <span class="in">`package::function()`</span> syntax.</span>
<span id="cb116-971"><a href="#cb116-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-972"><a href="#cb116-972" aria-hidden="true" tabindex="-1"></a>This is useful when you only need one function from a package, although if you need to use a lot of different functions (like we do with the tidyverse packages in this course), it's easier to load the package with <span class="in">`library()`</span> instead.</span>
<span id="cb116-973"><a href="#cb116-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-974"><a href="#cb116-974" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-975"><a href="#cb116-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-976"><a href="#cb116-976" aria-hidden="true" tabindex="-1"></a>There are a range of other functions you can use to label the axes, beyond just <span class="in">`scales::label_scientific()`</span>. One that is particularly handy is <span class="in">`scales::label_comma()`</span> which adds commas to large numbers (rather than using scientific notation, e.g. 1,000,000 instead of 1e6) so that they are easier to read. You can check out the full list of label functions in the <span class="co">[</span><span class="ot">ggplot2 book</span><span class="co">](https://ggplot2-book.org/scales-position.html#sec-position-continuous-labels)</span>.</span>
<span id="cb116-977"><a href="#cb116-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-978"><a href="#cb116-978" aria-hidden="true" tabindex="-1"></a><span class="fu">### Themes</span></span>
<span id="cb116-979"><a href="#cb116-979" aria-hidden="true" tabindex="-1"></a>Themes are a way to control the non-data appearance of a plot (e.g. font, background colour, grid lines, etc.)</span>
<span id="cb116-980"><a href="#cb116-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-981"><a href="#cb116-981" aria-hidden="true" tabindex="-1"></a>There are a number of pre-set theme functions in ggplot2, such as <span class="in">`theme_bw()`</span>, <span class="in">`theme_minimal()`</span> and <span class="in">`theme_classic()`</span>. You can add these to your plot with the <span class="in">`+`</span> operator to quickly change its appearance. For example, let's use the <span class="in">`theme_minimal()`</span> function to create a scatterplot with a simple white background:</span>
<span id="cb116-982"><a href="#cb116-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-985"><a href="#cb116-985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-986"><a href="#cb116-986" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-987"><a href="#cb116-987" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-988"><a href="#cb116-988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-989"><a href="#cb116-989" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-990"><a href="#cb116-990" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-991"><a href="#cb116-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-992"><a href="#cb116-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-993"><a href="#cb116-993" aria-hidden="true" tabindex="-1"></a>One common edit you might want to make to a theme is to change the font size, so that the text is easier to read. You can do this by setting the <span class="in">`base_size`</span> argument in the <span class="in">`theme_*()`</span> function. For example, let's increase the font size in our previous plot to 16 points:</span>
<span id="cb116-994"><a href="#cb116-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-997"><a href="#cb116-997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-998"><a href="#cb116-998" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-999"><a href="#cb116-999" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1000"><a href="#cb116-1000" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1001"><a href="#cb116-1001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1002"><a href="#cb116-1002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>)</span>
<span id="cb116-1003"><a href="#cb116-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1004"><a href="#cb116-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1005"><a href="#cb116-1005" aria-hidden="true" tabindex="-1"></a>To modify other parts of the theme, you can use the <span class="in">`theme()`</span> function to specify the elements you want to change. Make sure you put the <span class="in">`theme()`</span> function after your theme preset, if any (e.g. <span class="in">`theme_minimal()`</span>) as it will override the default settings.</span>
<span id="cb116-1006"><a href="#cb116-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1007"><a href="#cb116-1007" aria-hidden="true" tabindex="-1"></a>There are more than 40 different plot elements you can modify using the <span class="in">`theme()`</span> function, such as <span class="in">`axis.text`</span>, <span class="in">`axis.title`</span>, <span class="in">`plot.title`</span>, <span class="in">`legend.position`</span>, etc. It's impossible to remember them all, so you can refer to the <span class="co">[</span><span class="ot">ggplot2 documentation</span><span class="co">](https://ggplot2-book.org/themes.html#sec-theme-elements)</span>, search online or ask ChatGPT.</span>
<span id="cb116-1008"><a href="#cb116-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1009"><a href="#cb116-1009" aria-hidden="true" tabindex="-1"></a>In general though, to set the value of a plot element, you need to know its name, and the name of the function that sets it. Usually this will be <span class="in">`element_text()`</span> (for text), <span class="in">`element_line()`</span> (for lines) or <span class="in">`element_rect()`</span> (for rectangles). As an example, let's change the colour of our plot title to red, make it bold size 20 and change the plot background colour to pink:</span>
<span id="cb116-1010"><a href="#cb116-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1013"><a href="#cb116-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1014"><a href="#cb116-1014" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1015"><a href="#cb116-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1016"><a href="#cb116-1016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1017"><a href="#cb116-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1018"><a href="#cb116-1018" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a title to the plot</span></span>
<span id="cb116-1019"><a href="#cb116-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relationship between initial weight &amp; tail length"</span>) <span class="sc">+</span></span>
<span id="cb116-1020"><a href="#cb116-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1021"><a href="#cb116-1021" aria-hidden="true" tabindex="-1"></a>  <span class="co"># place the theme function after the theme preset</span></span>
<span id="cb116-1022"><a href="#cb116-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb116-1023"><a href="#cb116-1023" aria-hidden="true" tabindex="-1"></a>    <span class="co"># use setting functions like element_text() to set the value of a plot element</span></span>
<span id="cb116-1024"><a href="#cb116-1024" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour =</span> <span class="st">"red"</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb116-1025"><a href="#cb116-1025" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"pink"</span>)</span>
<span id="cb116-1026"><a href="#cb116-1026" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb116-1027"><a href="#cb116-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1028"><a href="#cb116-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1029"><a href="#cb116-1029" aria-hidden="true" tabindex="-1"></a>If your plot has a legend, you can also modify its appearance using the <span class="in">`theme()`</span> function. For example, in our colour-coded scatterplot of tail length and initial weight, let's move it to the bottom of the plot:</span>
<span id="cb116-1030"><a href="#cb116-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1033"><a href="#cb116-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1034"><a href="#cb116-1034" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1035"><a href="#cb116-1035" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1036"><a href="#cb116-1036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1037"><a href="#cb116-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1038"><a href="#cb116-1038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-1039"><a href="#cb116-1039" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1040"><a href="#cb116-1040" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb116-1041"><a href="#cb116-1041" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb116-1042"><a href="#cb116-1042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1043"><a href="#cb116-1043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb116-1044"><a href="#cb116-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1045"><a href="#cb116-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1046"><a href="#cb116-1046" aria-hidden="true" tabindex="-1"></a>You can remove the legend altogether by setting <span class="in">`legend.position = "none"`</span> in the <span class="in">`theme()`</span> function. This is useful when you have a lot of data points and the legend takes up too much space, or when the legend is not needed to interpret the plot.</span>
<span id="cb116-1047"><a href="#cb116-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1050"><a href="#cb116-1050" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1051"><a href="#cb116-1051" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1052"><a href="#cb116-1052" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1053"><a href="#cb116-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1054"><a href="#cb116-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1055"><a href="#cb116-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-1056"><a href="#cb116-1056" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1057"><a href="#cb116-1057" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb116-1058"><a href="#cb116-1058" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb116-1059"><a href="#cb116-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1060"><a href="#cb116-1060" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb116-1061"><a href="#cb116-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1062"><a href="#cb116-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1063"><a href="#cb116-1063" aria-hidden="true" tabindex="-1"></a><span class="fu">### Changing colours/sizes/shapes</span></span>
<span id="cb116-1064"><a href="#cb116-1064" aria-hidden="true" tabindex="-1"></a>Earlier, we saw how to map variables in our data to aesthetics like colour, size and shape. But you can also set these aesthetics manually to make the plot prettier, rather than to show something about the data. For example, if we wanted to make all the points in our scatterplot violet, we could do this by setting the <span class="in">`colour`</span> aesthetic directly in the <span class="in">`geom_point()`</span> layer, rather than in the <span class="in">`aes()`</span> function:</span>
<span id="cb116-1065"><a href="#cb116-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1068"><a href="#cb116-1068" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1069"><a href="#cb116-1069" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1070"><a href="#cb116-1070" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1071"><a href="#cb116-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1072"><a href="#cb116-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"violet"</span>)</span>
<span id="cb116-1073"><a href="#cb116-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1074"><a href="#cb116-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1075"><a href="#cb116-1075" aria-hidden="true" tabindex="-1"></a>This will make all the points violet, regardless of the strain of the mouse. You can do this for any aesthetic, such as size or shape. For example, let's make all the points in our scatterplot size 3 and shape 17:</span>
<span id="cb116-1076"><a href="#cb116-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1079"><a href="#cb116-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1080"><a href="#cb116-1080" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1081"><a href="#cb116-1081" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1082"><a href="#cb116-1082" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1083"><a href="#cb116-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">17</span>, <span class="at">colour =</span> <span class="st">"violet"</span>)</span>
<span id="cb116-1084"><a href="#cb116-1084" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1085"><a href="#cb116-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1086"><a href="#cb116-1086" aria-hidden="true" tabindex="-1"></a>Now, all of our plots have changed to violet triangles! <span class="co">[</span><span class="ot">You can see the full list of point shapes here</span><span class="co">](https://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r)</span> to help you customise your plot.</span>
<span id="cb116-1087"><a href="#cb116-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1088"><a href="#cb116-1088" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="Practice exercises"}</span>
<span id="cb116-1089"><a href="#cb116-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1090"><a href="#cb116-1090" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-1091"><a href="#cb116-1091" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> I've made the following plot:</span>
<span id="cb116-1092"><a href="#cb116-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1095"><a href="#cb116-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1096"><a href="#cb116-1096" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1097"><a href="#cb116-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> weight_lost_g, <span class="at">fill =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1098"><a href="#cb116-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span>
<span id="cb116-1099"><a href="#cb116-1099" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1100"><a href="#cb116-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1101"><a href="#cb116-1101" aria-hidden="true" tabindex="-1"></a>Which of the following could I use to add labels to the plot?</span>
<span id="cb116-1102"><a href="#cb116-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1103"><a href="#cb116-1103" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-1104"><a href="#cb116-1104" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-1105"><a href="#cb116-1105" aria-hidden="true" tabindex="-1"></a><span class="in">`labs(title = "Weight lost by cage number and mouse strain", x = "Cage number", y = "Weight lost (g)")`</span></span>
<span id="cb116-1106"><a href="#cb116-1106" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1107"><a href="#cb116-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1108"><a href="#cb116-1108" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1109"><a href="#cb116-1109" aria-hidden="true" tabindex="-1"></a><span class="in">`labels(title = "Weight lost by cage number and mouse strain", x = "Cage number", y = "Weight lost (g)")`</span></span>
<span id="cb116-1110"><a href="#cb116-1110" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1111"><a href="#cb116-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1112"><a href="#cb116-1112" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1113"><a href="#cb116-1113" aria-hidden="true" tabindex="-1"></a><span class="in">`labels(title = "Weight lost", x = "Cage number", y = "Weight lost (g)")`</span></span>
<span id="cb116-1114"><a href="#cb116-1114" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1115"><a href="#cb116-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1116"><a href="#cb116-1116" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1117"><a href="#cb116-1117" aria-hidden="true" tabindex="-1"></a><span class="in">`labels(x = "Cage number", y = "Weight lost (g)")`</span></span>
<span id="cb116-1118"><a href="#cb116-1118" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1119"><a href="#cb116-1119" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1120"><a href="#cb116-1120" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1121"><a href="#cb116-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1122"><a href="#cb116-1122" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-1123"><a href="#cb116-1123" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> I'm trying to change move my plot legend to the top and change the font of my title to bold, but it's not working. What am I doing wrong?</span>
<span id="cb116-1124"><a href="#cb116-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1127"><a href="#cb116-1127" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1128"><a href="#cb116-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1129"><a href="#cb116-1129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1130"><a href="#cb116-1130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1131"><a href="#cb116-1131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-1132"><a href="#cb116-1132" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1133"><a href="#cb116-1133" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>,</span>
<span id="cb116-1134"><a href="#cb116-1134" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb116-1135"><a href="#cb116-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>, <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)) <span class="sc">+</span></span>
<span id="cb116-1136"><a href="#cb116-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb116-1137"><a href="#cb116-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1138"><a href="#cb116-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1139"><a href="#cb116-1139" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-1140"><a href="#cb116-1140" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1141"><a href="#cb116-1141" aria-hidden="true" tabindex="-1"></a>You need to use the pipe operator to combine the two <span class="in">`theme()`</span> functions</span>
<span id="cb116-1142"><a href="#cb116-1142" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1143"><a href="#cb116-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1144"><a href="#cb116-1144" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1145"><a href="#cb116-1145" aria-hidden="true" tabindex="-1"></a>You can't use the <span class="in">`theme_bw()`</span> function and the <span class="in">`theme()`</span> function in the same plot</span>
<span id="cb116-1146"><a href="#cb116-1146" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1147"><a href="#cb116-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1148"><a href="#cb116-1148" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1149"><a href="#cb116-1149" aria-hidden="true" tabindex="-1"></a>You need to specify the <span class="in">`legend.position`</span> and <span class="in">`plot.title`</span> arguments in the <span class="in">`theme_bw()`</span> function, not the <span class="in">`theme()`</span> function.</span>
<span id="cb116-1150"><a href="#cb116-1150" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1151"><a href="#cb116-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1152"><a href="#cb116-1152" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-1153"><a href="#cb116-1153" aria-hidden="true" tabindex="-1"></a>You need to put the <span class="in">`theme()`</span> function after the <span class="in">`theme_bw()`</span> function, because currently the <span class="in">`theme_bw()`</span> function is overriding the <span class="in">`theme()`</span> function.</span>
<span id="cb116-1154"><a href="#cb116-1154" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1155"><a href="#cb116-1155" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1156"><a href="#cb116-1156" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1157"><a href="#cb116-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1158"><a href="#cb116-1158" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-1159"><a href="#cb116-1159" aria-hidden="true" tabindex="-1"></a>3<span class="sc">\.</span> I have the following code to make a boxplot of the initial weight of the mice by strain:</span>
<span id="cb116-1160"><a href="#cb116-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1163"><a href="#cb116-1163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1164"><a href="#cb116-1164" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1165"><a href="#cb116-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> initial_weight_g)) <span class="sc">+</span></span>
<span id="cb116-1166"><a href="#cb116-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb116-1167"><a href="#cb116-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1168"><a href="#cb116-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1169"><a href="#cb116-1169" aria-hidden="true" tabindex="-1"></a>How can I add points over the top of the boxplot, that are jittered to avoid overlap, size 0.5 and square shaped? Hint: find the shape number for squares <span class="co">[</span><span class="ot">here</span><span class="co">](https://www.sthda.com/english/wiki/r-plot-pch-symbols-the-different-point-shapes-available-in-r)</span>.</span>
<span id="cb116-1170"><a href="#cb116-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1171"><a href="#cb116-1171" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-1172"><a href="#cb116-1172" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1173"><a href="#cb116-1173" aria-hidden="true" tabindex="-1"></a>Add <span class="in">`geom_point(position = position_jitter(width = 0.2))`</span> to the plot code above with the <span class="in">`+`</span> operator and specify the size and shape in the <span class="in">`aes()`</span> function</span>
<span id="cb116-1174"><a href="#cb116-1174" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1175"><a href="#cb116-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1176"><a href="#cb116-1176" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-1177"><a href="#cb116-1177" aria-hidden="true" tabindex="-1"></a>Add <span class="in">`geom_point(size = 0.5, shape = 15, position = position_jitter(width = 0.2))`</span> to the plot code above with the <span class="in">`+`</span> operator</span>
<span id="cb116-1178"><a href="#cb116-1178" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1179"><a href="#cb116-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1180"><a href="#cb116-1180" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1181"><a href="#cb116-1181" aria-hidden="true" tabindex="-1"></a>It's not possible to add points to a boxplot</span>
<span id="cb116-1182"><a href="#cb116-1182" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1183"><a href="#cb116-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1184"><a href="#cb116-1184" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1185"><a href="#cb116-1185" aria-hidden="true" tabindex="-1"></a>Add <span class="in">`geom_point()`</span> to the plot code above with the <span class="in">`+`</span> operator</span>
<span id="cb116-1186"><a href="#cb116-1186" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1187"><a href="#cb116-1187" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1188"><a href="#cb116-1188" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1189"><a href="#cb116-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1190"><a href="#cb116-1190" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-1191"><a href="#cb116-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1192"><a href="#cb116-1192" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Solutions<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb116-1193"><a href="#cb116-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1194"><a href="#cb116-1194" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb116-1195"><a href="#cb116-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1196"><a href="#cb116-1196" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The correct answer is <span class="in">`labs(title = "Weight lost by cage number and mouse strain", x = "Cage number", y = "Weight lost (g)")`</span>. This will add a title and axis labels to the plot. The <span class="in">`labels()`</span> function does not exist in ggplot2, so the second option is incorrect. The third and fourth options are also incorrect because they do not include an title informative title.</span>
<span id="cb116-1197"><a href="#cb116-1197" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>The correct answer is "You need to put the <span class="in">`theme()`</span> function after the <span class="in">`theme_bw()`</span> function, because currently the <span class="in">`theme_bw()`</span> function is overriding the <span class="in">`theme()`</span> function." The <span class="in">`theme_bw()`</span> function sets the default theme for the plot, so if you want to modify it, you need to put the <span class="in">`theme()`</span> function after it. The other options are incorrect because you can use the <span class="in">`theme()`</span> function and the <span class="in">`theme_bw()`</span> function together, and you don't need to specify the <span class="in">`legend.position`</span> and <span class="in">`plot.title`</span> arguments in the <span class="in">`theme_bw()`</span> function. You always use <span class="in">`+`</span> when adding a new layer to a plot, so you don't need to use the pipe operator.</span>
<span id="cb116-1198"><a href="#cb116-1198" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>The correct answer is "Add <span class="in">`geom_point(size = 0.5, shape = 15, position = position_jitter(width = 0.2))`</span> to the plot code above with the <span class="in">`+`</span> operator." This will add points to the boxplot that are size 0.5 and square shaped. The first option is incorrect because you need to specify the size and shape in the <span class="in">`geom_point()`</span> function, not in the <span class="in">`aes()`</span> function (as the size and shape here don't represent anything in the data, they are just used to style the plot). The third option is incorrect because it is possible to add points to a boxplot, and the fourth option is incorrect because it does not specify the size or shape of the points, or the jitter.</span>
<span id="cb116-1199"><a href="#cb116-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1200"><a href="#cb116-1200" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb116-1201"><a href="#cb116-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1202"><a href="#cb116-1202" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-1203"><a href="#cb116-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1204"><a href="#cb116-1204" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1205"><a href="#cb116-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1206"><a href="#cb116-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1207"><a href="#cb116-1207" aria-hidden="true" tabindex="-1"></a><span class="fu">## Making many similar plots with facets</span></span>
<span id="cb116-1208"><a href="#cb116-1208" aria-hidden="true" tabindex="-1"></a>Faceting is a powerful way to create multiple plots that each show subsets of your data. This is useful when you want to compare different groups or categories.</span>
<span id="cb116-1209"><a href="#cb116-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1210"><a href="#cb116-1210" aria-hidden="true" tabindex="-1"></a>Before, we saw how to do this by using aesthetics such as colour to distinguish between groups. For example, let's consider the relationship between weight lost and drug dosage in our <span class="in">`mousezempic_dosage_data`</span> dataset. We could use what we've learned so far to create a scatterplot of weight lost vs drug dosage, and colour the points by mouse strain:</span>
<span id="cb116-1211"><a href="#cb116-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1214"><a href="#cb116-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1215"><a href="#cb116-1215" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1216"><a href="#cb116-1216" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1217"><a href="#cb116-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1218"><a href="#cb116-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1219"><a href="#cb116-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb116-1220"><a href="#cb116-1220" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb116-1221"><a href="#cb116-1221" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>)</span>
<span id="cb116-1222"><a href="#cb116-1222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1223"><a href="#cb116-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1224"><a href="#cb116-1224" aria-hidden="true" tabindex="-1"></a>Notice how the points for the CD-1 and BALB/c strains are sitting pretty much on top of each other. This makes it difficult to see the differences between the strains, so it might be better to create separate plots for each strain. This is where faceting comes in!</span>
<span id="cb116-1225"><a href="#cb116-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1226"><a href="#cb116-1226" aria-hidden="true" tabindex="-1"></a>When we want to facet our data by a single variable, we can use the <span class="in">`facet_wrap()`</span> function. This will create a series of plots, with each plot showing a different subset of the data according to that variable.</span>
<span id="cb116-1227"><a href="#cb116-1227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1228"><a href="#cb116-1228" aria-hidden="true" tabindex="-1"></a>Let's repeat our previous plot, but this time we'll facet it by mouse strain:</span>
<span id="cb116-1229"><a href="#cb116-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1232"><a href="#cb116-1232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1233"><a href="#cb116-1233" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1234"><a href="#cb116-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1235"><a href="#cb116-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1236"><a href="#cb116-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1237"><a href="#cb116-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb116-1238"><a href="#cb116-1238" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb116-1239"><a href="#cb116-1239" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb116-1240"><a href="#cb116-1240" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain</span></span>
<span id="cb116-1241"><a href="#cb116-1241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mouse_strain)</span>
<span id="cb116-1242"><a href="#cb116-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1243"><a href="#cb116-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1244"><a href="#cb116-1244" aria-hidden="true" tabindex="-1"></a>You use the facet_wrap() function by specifying the variable you want to facet by with a <span class="in">`~`</span>.</span>
<span id="cb116-1245"><a href="#cb116-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1246"><a href="#cb116-1246" aria-hidden="true" tabindex="-1"></a>By default, all of the facets will have the same x and y axis limits, which is useful when you want to compare the data across all of them. However, if you want to allow each facet to have its own x and y axis limits, you can set the <span class="in">`scales`</span> argument to <span class="in">`"free"`</span>:</span>
<span id="cb116-1247"><a href="#cb116-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1250"><a href="#cb116-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1251"><a href="#cb116-1251" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1252"><a href="#cb116-1252" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1253"><a href="#cb116-1253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1254"><a href="#cb116-1254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1255"><a href="#cb116-1255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb116-1256"><a href="#cb116-1256" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb116-1257"><a href="#cb116-1257" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb116-1258"><a href="#cb116-1258" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain</span></span>
<span id="cb116-1259"><a href="#cb116-1259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mouse_strain, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb116-1260"><a href="#cb116-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1261"><a href="#cb116-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1262"><a href="#cb116-1262" aria-hidden="true" tabindex="-1"></a>This makes it easier to see patterns within each strain, but it makes it harder to compare the strains to each other. So it's a trade-off between clarity and comparability.</span>
<span id="cb116-1263"><a href="#cb116-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1264"><a href="#cb116-1264" aria-hidden="true" tabindex="-1"></a>Two other useful arguments to <span class="in">`facet_wrap()`</span> are <span class="in">`nrow`</span> and <span class="in">`ncol`</span>, which allow you to specify the number of rows or columns to use for the facets. For example, if we wanted our three facets to be arranged in a single column, we could set <span class="in">`ncol = 1`</span>:</span>
<span id="cb116-1265"><a href="#cb116-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1268"><a href="#cb116-1268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1269"><a href="#cb116-1269" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1270"><a href="#cb116-1270" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1271"><a href="#cb116-1271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1272"><a href="#cb116-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1273"><a href="#cb116-1273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb116-1274"><a href="#cb116-1274" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb116-1275"><a href="#cb116-1275" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb116-1276"><a href="#cb116-1276" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain</span></span>
<span id="cb116-1277"><a href="#cb116-1277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> mouse_strain, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb116-1278"><a href="#cb116-1278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1279"><a href="#cb116-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1280"><a href="#cb116-1280" aria-hidden="true" tabindex="-1"></a>Play around with different layouts to see what works best for your data!</span>
<span id="cb116-1281"><a href="#cb116-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1282"><a href="#cb116-1282" aria-hidden="true" tabindex="-1"></a>It's also possible to facet by two variables, using the <span class="in">`facet_grid()`</span> function. In this case, you need to specify the two column names to facet by, separated by a <span class="in">`~`</span>. For example, if we wanted to facet our previous plot by both mouse strain and cage number, we could do this:</span>
<span id="cb116-1283"><a href="#cb116-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1286"><a href="#cb116-1286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1287"><a href="#cb116-1287" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1288"><a href="#cb116-1288" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1289"><a href="#cb116-1289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> drug_dose_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1290"><a href="#cb116-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1291"><a href="#cb116-1291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost vs drug dosage for each mouse strain"</span>,</span>
<span id="cb116-1292"><a href="#cb116-1292" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb116-1293"><a href="#cb116-1293" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb116-1294"><a href="#cb116-1294" aria-hidden="true" tabindex="-1"></a>  <span class="co"># facet the plot by mouse strain and cage number</span></span>
<span id="cb116-1295"><a href="#cb116-1295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(mouse_strain <span class="sc">~</span> cage_number)</span>
<span id="cb116-1296"><a href="#cb116-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1297"><a href="#cb116-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1298"><a href="#cb116-1298" aria-hidden="true" tabindex="-1"></a>There is now a separate plot for each combination of mouse strain and cage number. Notice how some of the plots are empty, because there are no data points for that combination of mouse strain and cage number.</span>
<span id="cb116-1299"><a href="#cb116-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1300"><a href="#cb116-1300" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="Practice exercises"}</span>
<span id="cb116-1301"><a href="#cb116-1301" aria-hidden="true" tabindex="-1"></a>Try these practice questions to test your understanding</span>
<span id="cb116-1302"><a href="#cb116-1302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1303"><a href="#cb116-1303" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-1304"><a href="#cb116-1304" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> Using the <span class="in">`mtcars`</span> dataset, create a scatterplot of <span class="in">`mpg`</span> vs <span class="in">`hp`</span>, faceted by <span class="in">`cyl`</span>, with the same x and y axes across each facet.</span>
<span id="cb116-1305"><a href="#cb116-1305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1306"><a href="#cb116-1306" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-1307"><a href="#cb116-1307" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1308"><a href="#cb116-1308" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(hp ~ mpg)`</span></span>
<span id="cb116-1309"><a href="#cb116-1309" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1310"><a href="#cb116-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1311"><a href="#cb116-1311" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-1312"><a href="#cb116-1312" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(~ cyl)`</span></span>
<span id="cb116-1313"><a href="#cb116-1313" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1314"><a href="#cb116-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1315"><a href="#cb116-1315" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1316"><a href="#cb116-1316" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(~ hp)`</span></span>
<span id="cb116-1317"><a href="#cb116-1317" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1318"><a href="#cb116-1318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1319"><a href="#cb116-1319" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1320"><a href="#cb116-1320" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_grid(~ cyl)`</span></span>
<span id="cb116-1321"><a href="#cb116-1321" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1322"><a href="#cb116-1322" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1323"><a href="#cb116-1323" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1324"><a href="#cb116-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1325"><a href="#cb116-1325" aria-hidden="true" tabindex="-1"></a>::: question</span>
<span id="cb116-1326"><a href="#cb116-1326" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> What does the following code do?</span>
<span id="cb116-1327"><a href="#cb116-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1330"><a href="#cb116-1330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1331"><a href="#cb116-1331" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-1332"><a href="#cb116-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1333"><a href="#cb116-1333" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1334"><a href="#cb116-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-1335"><a href="#cb116-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(mouse_strain <span class="sc">~</span> sex, <span class="at">scales =</span> <span class="st">"free"</span>)</span>
<span id="cb116-1336"><a href="#cb116-1336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1337"><a href="#cb116-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1338"><a href="#cb116-1338" aria-hidden="true" tabindex="-1"></a>::: choices</span>
<span id="cb116-1339"><a href="#cb116-1339" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1340"><a href="#cb116-1340" aria-hidden="true" tabindex="-1"></a>Creates a scatterplot of the tail length for each unique combination of 'sex' and 'mouse strain', with the y axis limits set independently for each facet.</span>
<span id="cb116-1341"><a href="#cb116-1341" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1342"><a href="#cb116-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1343"><a href="#cb116-1343" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1344"><a href="#cb116-1344" aria-hidden="true" tabindex="-1"></a>Creates a boxplot of the tail length for each unique combination of 'sex' and 'mouse strain'.</span>
<span id="cb116-1345"><a href="#cb116-1345" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1346"><a href="#cb116-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1347"><a href="#cb116-1347" aria-hidden="true" tabindex="-1"></a>::: choice</span>
<span id="cb116-1348"><a href="#cb116-1348" aria-hidden="true" tabindex="-1"></a>Creates boxplots of the tail length of mice, in mm.</span>
<span id="cb116-1349"><a href="#cb116-1349" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1350"><a href="#cb116-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1351"><a href="#cb116-1351" aria-hidden="true" tabindex="-1"></a>::: {.choice .correct-choice}</span>
<span id="cb116-1352"><a href="#cb116-1352" aria-hidden="true" tabindex="-1"></a>Creates a boxplot of the tail length for each unique combination of 'sex' and 'mouse strain', with the y axis limits set independently for each facet.</span>
<span id="cb116-1353"><a href="#cb116-1353" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1354"><a href="#cb116-1354" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1355"><a href="#cb116-1355" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1356"><a href="#cb116-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1357"><a href="#cb116-1357" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-1358"><a href="#cb116-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1359"><a href="#cb116-1359" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Solutions<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb116-1360"><a href="#cb116-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1361"><a href="#cb116-1361" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb116-1362"><a href="#cb116-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1363"><a href="#cb116-1363" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>The correct answer is <span class="in">`ggplot(mtcars, aes(x = hp, y = mpg)) + geom_point() + facet_wrap(~ cyl)`</span>. This code creates a scatterplot of <span class="in">`mpg`</span> vs <span class="in">`hp`</span>, faceted by <span class="in">`cyl`</span>, with the same x and y axes across each facet. The other options are incorrect because they either use the wrong variable to facet by or use the wrong function to create the facets (since we are faceting by a single variable, we should  use <span class="in">`facet_wrap()`</span>).</span>
<span id="cb116-1364"><a href="#cb116-1364" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>This code creates a boxplot of the tail length for each unique combination of 'sex' and 'mouse strain', with the y axis limits set independently for each facet (with the <span class="in">`scales = "free"`</span> argument).</span>
<span id="cb116-1365"><a href="#cb116-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1366"><a href="#cb116-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1367"><a href="#cb116-1367" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">p</span><span class="dt">&gt;</span></span>
<span id="cb116-1368"><a href="#cb116-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1369"><a href="#cb116-1369" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-1370"><a href="#cb116-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1371"><a href="#cb116-1371" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1372"><a href="#cb116-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1373"><a href="#cb116-1373" aria-hidden="true" tabindex="-1"></a><span class="fu">## Laying out multiple plots into a single figure</span></span>
<span id="cb116-1374"><a href="#cb116-1374" aria-hidden="true" tabindex="-1"></a>Faceting is a great way to create multiple versions of the same plot, but sometimes you want to create completely different plots and lay them out together. For example, let's say we are interested in the tail length variable from our <span class="in">`mousezempic_dosage_data`</span> dataset. We might want to create a scatterplot of initial weight vs tail length, and a boxplot of tail length by cage number, and lay them out together.</span>
<span id="cb116-1375"><a href="#cb116-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1376"><a href="#cb116-1376" aria-hidden="true" tabindex="-1"></a>We can do this using the <span class="in">`patchwork`</span> package, which allows you to combine multiple ggplot2 plots into a single figure. To use it, you first need to load the package:</span>
<span id="cb116-1377"><a href="#cb116-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1380"><a href="#cb116-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1381"><a href="#cb116-1381" aria-hidden="true" tabindex="-1"></a><span class="co"># if you get an error saying that the package is not installed, uncomment and then run the following line to install it</span></span>
<span id="cb116-1382"><a href="#cb116-1382" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("patchwork")</span></span>
<span id="cb116-1383"><a href="#cb116-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1384"><a href="#cb116-1384" aria-hidden="true" tabindex="-1"></a><span class="co"># otherwise just load the package</span></span>
<span id="cb116-1385"><a href="#cb116-1385" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb116-1386"><a href="#cb116-1386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1387"><a href="#cb116-1387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1388"><a href="#cb116-1388" aria-hidden="true" tabindex="-1"></a>The patchwork package changes the way that the <span class="in">`+`</span> operator works, so that it can be used to combine multiple plots together, as well as to add layers to plots like we've seen so far. To use it, you just create your plots as normal, but **assign them to variables**. Then, you can use the <span class="in">`+`</span> operator to combine them.</span>
<span id="cb116-1389"><a href="#cb116-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1390"><a href="#cb116-1390" aria-hidden="true" tabindex="-1"></a>Returning to the example above, we can create our plots and assign them to variables. We'll also use this as an opportunity to revise some of the things we've learned so far, such as adding labels and changing the theme:</span>
<span id="cb116-1391"><a href="#cb116-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1394"><a href="#cb116-1394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1395"><a href="#cb116-1395" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1396"><a href="#cb116-1396" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1397"><a href="#cb116-1397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> tail_length_mm, <span class="at">fill =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb116-1398"><a href="#cb116-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb116-1399"><a href="#cb116-1399" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add labels</span></span>
<span id="cb116-1400"><a href="#cb116-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Tail length by cage number"</span>,</span>
<span id="cb116-1401"><a href="#cb116-1401" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cage number"</span>,</span>
<span id="cb116-1402"><a href="#cb116-1402" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb116-1403"><a href="#cb116-1403" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the theme</span></span>
<span id="cb116-1404"><a href="#cb116-1404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1405"><a href="#cb116-1405" aria-hidden="true" tabindex="-1"></a>  <span class="co"># remove the legend, because we will use the same colour for the points and the plot, don't need both legends</span></span>
<span id="cb116-1406"><a href="#cb116-1406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb116-1407"><a href="#cb116-1407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1408"><a href="#cb116-1408" aria-hidden="true" tabindex="-1"></a>tail_weight_scatterplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1409"><a href="#cb116-1409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> cage_number)) <span class="sc">+</span></span>
<span id="cb116-1410"><a href="#cb116-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-1411"><a href="#cb116-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-1412"><a href="#cb116-1412" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1413"><a href="#cb116-1413" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb116-1414"><a href="#cb116-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1415"><a href="#cb116-1415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1416"><a href="#cb116-1416" aria-hidden="true" tabindex="-1"></a>Notice how there is no output from these lines of code, because we are not printing the plots to the console (just assigning them).</span>
<span id="cb116-1417"><a href="#cb116-1417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1418"><a href="#cb116-1418" aria-hidden="true" tabindex="-1"></a>Now, we can use the <span class="in">`+`</span> operator to combine the two plots together into a single figure:</span>
<span id="cb116-1419"><a href="#cb116-1419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1422"><a href="#cb116-1422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1423"><a href="#cb116-1423" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1424"><a href="#cb116-1424" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="sc">+</span> tail_weight_scatterplot</span>
<span id="cb116-1425"><a href="#cb116-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1426"><a href="#cb116-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1427"><a href="#cb116-1427" aria-hidden="true" tabindex="-1"></a>This will create a single figure with the boxplot on the left and the scatterplot on the right (following the order in which we specified them).</span>
<span id="cb116-1428"><a href="#cb116-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1429"><a href="#cb116-1429" aria-hidden="true" tabindex="-1"></a>If we want to stack our plots on top of eachother in a column, we can use the <span class="in">`\`</span> operator. For example:</span>
<span id="cb116-1430"><a href="#cb116-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1433"><a href="#cb116-1433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1434"><a href="#cb116-1434" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb116-1435"><a href="#cb116-1435" aria-hidden="true" tabindex="-1"></a><span class="co"># put the boxplot on top of the scatterplot</span></span>
<span id="cb116-1436"><a href="#cb116-1436" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="sc">/</span> tail_weight_scatterplot</span>
<span id="cb116-1437"><a href="#cb116-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1438"><a href="#cb116-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1439"><a href="#cb116-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1440"><a href="#cb116-1440" aria-hidden="true" tabindex="-1"></a>The patchwork package has several other ways to lay out plots, particularly for more complex layouts. For more information, check out the <span class="co">[</span><span class="ot">patchwork documentation</span><span class="co">](https://patchwork.data-imaginist.com/articles/patchwork.html#controlling-layout)</span>.</span>
<span id="cb116-1441"><a href="#cb116-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1442"><a href="#cb116-1442" aria-hidden="true" tabindex="-1"></a>Another useful feature of the patchwork package is that you can add annotations to your plots, such 'A' or 'B' to indicate which plot is which. You can do this using the <span class="in">`plot_annotation()`</span> function, with the <span class="in">`tag_levels = "A"`</span> argument. We can add this to the plot with the <span class="in">`+`</span> operator, just like we do with layers in a singular ggplot.</span>
<span id="cb116-1443"><a href="#cb116-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1444"><a href="#cb116-1444" aria-hidden="true" tabindex="-1"></a>For example, if we wanted to identify our two plots as 'A' and 'B':</span>
<span id="cb116-1445"><a href="#cb116-1445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1448"><a href="#cb116-1448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1449"><a href="#cb116-1449" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-1450"><a href="#cb116-1450" aria-hidden="true" tabindex="-1"></a>tail_cage_boxplot <span class="sc">+</span> tail_weight_scatterplot <span class="sc">+</span></span>
<span id="cb116-1451"><a href="#cb116-1451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb116-1452"><a href="#cb116-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1453"><a href="#cb116-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1454"><a href="#cb116-1454" aria-hidden="true" tabindex="-1"></a>This allows you to make entire figures within R!</span>
<span id="cb116-1455"><a href="#cb116-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1456"><a href="#cb116-1456" aria-hidden="true" tabindex="-1"></a>Once you've decided on your layout and added your annotations, you probably want to save it to a file. You can do this using the <span class="in">`ggsave()`</span> function, just like you would for a single plot:</span>
<span id="cb116-1457"><a href="#cb116-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1460"><a href="#cb116-1460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1461"><a href="#cb116-1461" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval : false</span></span>
<span id="cb116-1462"><a href="#cb116-1462" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> tail_cage_boxplot <span class="sc">+</span> tail_weight_scatterplot</span>
<span id="cb116-1463"><a href="#cb116-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1464"><a href="#cb116-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"combined_plot.png"</span>, <span class="at">plot =</span> combined_plot, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb116-1465"><a href="#cb116-1465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1466"><a href="#cb116-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1467"><a href="#cb116-1467" aria-hidden="true" tabindex="-1"></a>::: {.callout-important title="Practice exercises"}</span>
<span id="cb116-1468"><a href="#cb116-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1469"><a href="#cb116-1469" aria-hidden="true" tabindex="-1"></a>Try this practice question to test your understanding!</span>
<span id="cb116-1470"><a href="#cb116-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1471"><a href="#cb116-1471" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> Using the <span class="in">`mtcars`</span> dataset, create a scatterplot of <span class="in">`mpg`</span> vs <span class="in">`hp`</span>, and a boxplot of <span class="in">`mpg`</span> by <span class="in">`cyl`</span>, and lay them out together in a single figure. Add labels to each plot and remove the legend from the boxplot. Use your creativity to make the plots look nice!</span>
<span id="cb116-1472"><a href="#cb116-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1473"><a href="#cb116-1473" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-1474"><a href="#cb116-1474" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Solution<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb116-1475"><a href="#cb116-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1476"><a href="#cb116-1476" aria-hidden="true" tabindex="-1"></a>First, we create the scatterplot and boxplot, remembering to assign them to variables:</span>
<span id="cb116-1477"><a href="#cb116-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1480"><a href="#cb116-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1481"><a href="#cb116-1481" aria-hidden="true" tabindex="-1"></a>mpg_hp_scatterplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars,</span>
<span id="cb116-1482"><a href="#cb116-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> hp, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb116-1483"><a href="#cb116-1483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"purple"</span>) <span class="sc">+</span></span>
<span id="cb116-1484"><a href="#cb116-1484" aria-hidden="true" tabindex="-1"></a>  <span class="co"># to know what the column names are, I looked at the</span></span>
<span id="cb116-1485"><a href="#cb116-1485" aria-hidden="true" tabindex="-1"></a>  <span class="co"># help page for the mtcars dataset by running ?mtcars</span></span>
<span id="cb116-1486"><a href="#cb116-1486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MPG vs HP"</span>,</span>
<span id="cb116-1487"><a href="#cb116-1487" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Horsepower (hp)"</span>,</span>
<span id="cb116-1488"><a href="#cb116-1488" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon (mpg)"</span>) <span class="sc">+</span></span>
<span id="cb116-1489"><a href="#cb116-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1490"><a href="#cb116-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1491"><a href="#cb116-1491" aria-hidden="true" tabindex="-1"></a>mpg_cyl_boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mtcars,</span>
<span id="cb116-1492"><a href="#cb116-1492" aria-hidden="true" tabindex="-1"></a>  <span class="co"># change the cyl column to a character variable</span></span>
<span id="cb116-1493"><a href="#cb116-1493" aria-hidden="true" tabindex="-1"></a>  <span class="co"># because even though it's a number, it represents a category</span></span>
<span id="cb116-1494"><a href="#cb116-1494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.character</span>(cyl), <span class="at">y =</span> mpg, <span class="at">colour =</span> <span class="fu">as.character</span>(cyl))) <span class="sc">+</span></span>
<span id="cb116-1495"><a href="#cb116-1495" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use lwd = 1.5 to make the line thicker so it's easier to see</span></span>
<span id="cb116-1496"><a href="#cb116-1496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">lwd =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb116-1497"><a href="#cb116-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"MPG by number of cylinders"</span>,</span>
<span id="cb116-1498"><a href="#cb116-1498" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Number of cylinders"</span>,</span>
<span id="cb116-1499"><a href="#cb116-1499" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Miles per gallon (mpg)"</span>) <span class="sc">+</span></span>
<span id="cb116-1500"><a href="#cb116-1500" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use the viridis colour palette for the boxplot</span></span>
<span id="cb116-1501"><a href="#cb116-1501" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note it's scale_colour_viridis_d() because this is discrete data</span></span>
<span id="cb116-1502"><a href="#cb116-1502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>() <span class="sc">+</span></span>
<span id="cb116-1503"><a href="#cb116-1503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1504"><a href="#cb116-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb116-1505"><a href="#cb116-1505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1506"><a href="#cb116-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1507"><a href="#cb116-1507" aria-hidden="true" tabindex="-1"></a>Then, we combine the two plots together with the <span class="in">`+`</span> operator. To add the labels, we can use the <span class="in">`plot_annotation()`</span> function:</span>
<span id="cb116-1508"><a href="#cb116-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1511"><a href="#cb116-1511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1512"><a href="#cb116-1512" aria-hidden="true" tabindex="-1"></a>mpg_hp_scatterplot <span class="sc">+</span> mpg_cyl_boxplot <span class="sc">+</span></span>
<span id="cb116-1513"><a href="#cb116-1513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb116-1514"><a href="#cb116-1514" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1515"><a href="#cb116-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1516"><a href="#cb116-1516" aria-hidden="true" tabindex="-1"></a>Of course, your plots might look quite different, depending on how you choose to style them. The important thing is that you create a scatterplot of <span class="in">`mpg`</span> vs <span class="in">`hp`</span>, and a boxplot of <span class="in">`mpg`</span> by <span class="in">`cyl`</span>, and lay them out together in a single figure.</span>
<span id="cb116-1517"><a href="#cb116-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1518"><a href="#cb116-1518" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-1519"><a href="#cb116-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1520"><a href="#cb116-1520" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb116-1521"><a href="#cb116-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1522"><a href="#cb116-1522" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary</span></span>
<span id="cb116-1523"><a href="#cb116-1523" aria-hidden="true" tabindex="-1"></a>Today, we've covered a lot of ground in ggplot2! Here's a quick summary of what we've learned:</span>
<span id="cb116-1524"><a href="#cb116-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1525"><a href="#cb116-1525" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How to use the <span class="in">`ggplot(aes(x = ..., y = ...))`</span> function to initialise a plot</span>
<span id="cb116-1526"><a href="#cb116-1526" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>That we can add layers to a plot using the <span class="in">`+`</span> operator</span>
<span id="cb116-1527"><a href="#cb116-1527" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How to use the <span class="in">`geom_*()`</span> functions to add different physical representations of the data to your plot (e.g. points with <span class="in">`geom_point()`</span>, bars with <span class="in">`geom_bar()`</span>, etc.)</span>
<span id="cb116-1528"><a href="#cb116-1528" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How to save a plot to a file using the <span class="in">`ggsave()`</span> function, or through the RStudio plot window</span>
<span id="cb116-1529"><a href="#cb116-1529" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Using the <span class="in">`aes()`</span> function to map variables in your data to aesthetics like colour, x/y position, size and shape, as well as the different <span class="in">`scale_*()`</span> functions that can change the appearance of these aesthetics</span>
<span id="cb116-1530"><a href="#cb116-1530" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Ways we can change the appearance of a plot with pre-set themes (e.g. <span class="in">`theme_bw()`</span>, <span class="in">`theme_minimal()`</span>, etc.), using the <span class="in">`theme()`</span> function and adding labels with the <span class="in">`labs()`</span> function</span>
<span id="cb116-1531"><a href="#cb116-1531" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>That we can use the <span class="in">`facet_wrap()`</span> and <span class="in">`facet_grid()`</span> functions to create multiple plots that show different subsets of the data according to particular categorical variable(s)</span>
<span id="cb116-1532"><a href="#cb116-1532" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How to use the <span class="in">`patchwork`</span> package to combine multiple plots into a single figure with operators like <span class="in">`+`</span> and <span class="in">`/`</span></span>
<span id="cb116-1533"><a href="#cb116-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1534"><a href="#cb116-1534" aria-hidden="true" tabindex="-1"></a>These are just the basics of ggplot2, and there are many more features and functions that you can use to create beautiful and informative plots. If you're interested in learning more, check out the <span class="co">[</span><span class="ot">ggplot2 book</span><span class="co">](https://ggplot2-book.org/)</span>, the <span class="co">[</span><span class="ot">R graph gallery</span><span class="co">](https://r-graph-gallery.com/)</span> or explore some of the many packages that extend ggplot2, like <span class="co">[</span><span class="ot">ggbeeswarm</span><span class="co">](https://github.com/eclarke/ggbeeswarm)</span> for making beeswarm plots or <span class="co">[</span><span class="ot">ggrepel</span><span class="co">](https://ggrepel.slowkow.com/;)</span> to label plots without the text overlapping.</span>
<span id="cb116-1535"><a href="#cb116-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1536"><a href="#cb116-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1537"><a href="#cb116-1537" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practice questions</span></span>
<span id="cb116-1538"><a href="#cb116-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1539"><a href="#cb116-1539" aria-hidden="true" tabindex="-1"></a>Try these practice questions to test your understanding!</span>
<span id="cb116-1540"><a href="#cb116-1540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1541"><a href="#cb116-1541" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Look at the following ggplot2 code and try to describe in words what type of plot it will make. If you're not sure, try looking up the help pages for the functions!</span>
<span id="cb116-1542"><a href="#cb116-1542" aria-hidden="true" tabindex="-1"></a>  a.</span>
<span id="cb116-1545"><a href="#cb116-1545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1546"><a href="#cb116-1546" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-1547"><a href="#cb116-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1548"><a href="#cb116-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1549"><a href="#cb116-1549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> sex), <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb116-1550"><a href="#cb116-1550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb116-1551"><a href="#cb116-1551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb116-1552"><a href="#cb116-1552" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb116-1553"><a href="#cb116-1553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1554"><a href="#cb116-1554" aria-hidden="true" tabindex="-1"></a>  b.</span>
<span id="cb116-1557"><a href="#cb116-1557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1558"><a href="#cb116-1558" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-1559"><a href="#cb116-1559" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1560"><a href="#cb116-1560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1561"><a href="#cb116-1561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> drug_dose_g)) <span class="sc">+</span></span>
<span id="cb116-1562"><a href="#cb116-1562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb116-1563"><a href="#cb116-1563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb116-1564"><a href="#cb116-1564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1565"><a href="#cb116-1565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1566"><a href="#cb116-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1567"><a href="#cb116-1567" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Write some ggplot2 code that will create:</span>
<span id="cb116-1568"><a href="#cb116-1568" aria-hidden="true" tabindex="-1"></a>  a. A violin plot with points overlaid of drug dosage for each of the mouse strains. The violins should be coloured by mouse strain, and the points should be jittered to avoid overlap.</span>
<span id="cb116-1569"><a href="#cb116-1569" aria-hidden="true" tabindex="-1"></a>  b. A histogram of the weight lost, faceted into separate plots for each combination of sex and mouse strain. Each histogram should be coloured pink, and should have 15 bins.</span>
<span id="cb116-1570"><a href="#cb116-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1571"><a href="#cb116-1571" aria-hidden="true" tabindex="-1"></a>Try to make them look as nice as possible, using the techniques we've learned in this session.</span>
<span id="cb116-1572"><a href="#cb116-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1573"><a href="#cb116-1573" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>I've written the following code to create a scatterplot of initial weight vs tail length, with points coloured by weight lost. However, I'm getting an error. What's wrong?</span>
<span id="cb116-1574"><a href="#cb116-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1577"><a href="#cb116-1577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1578"><a href="#cb116-1578" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-1579"><a href="#cb116-1579" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1580"><a href="#cb116-1580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1581"><a href="#cb116-1581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> weight_lost_g) <span class="sc">+</span></span>
<span id="cb116-1582"><a href="#cb116-1582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-1583"><a href="#cb116-1583" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1584"><a href="#cb116-1584" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb116-1585"><a href="#cb116-1585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1586"><a href="#cb116-1586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1587"><a href="#cb116-1587" aria-hidden="true" tabindex="-1"></a>Hint: read the error message carefully! It will give you a clue about what the problem is.</span>
<span id="cb116-1588"><a href="#cb116-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1589"><a href="#cb116-1589" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Write some code to re-create the plots below in ggplot2.</span>
<span id="cb116-1590"><a href="#cb116-1590" aria-hidden="true" tabindex="-1"></a>  a.</span>
<span id="cb116-1591"><a href="#cb116-1591" aria-hidden="true" tabindex="-1"></a>  Hint: you can use <span class="in">`geom_smooth()`</span> twice, once to add the overall trendline, and once to add the separate trendlines for each mouse strain. You'll want to use the <span class="in">`aes()`</span> function within the geoms that need to be colour coded.</span>
<span id="cb116-1592"><a href="#cb116-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1595"><a href="#cb116-1595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1596"><a href="#cb116-1596" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-1597"><a href="#cb116-1597" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1598"><a href="#cb116-1598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1599"><a href="#cb116-1599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-1600"><a href="#cb116-1600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb116-1601"><a href="#cb116-1601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1602"><a href="#cb116-1602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Simpson's Paradox in the relationship between initial weight and tail length"</span>,</span>
<span id="cb116-1603"><a href="#cb116-1603" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1604"><a href="#cb116-1604" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb116-1605"><a href="#cb116-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1606"><a href="#cb116-1606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1607"><a href="#cb116-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1608"><a href="#cb116-1608" aria-hidden="true" tabindex="-1"></a>  b. The font size here is 16 and the thicker line is size 2.</span>
<span id="cb116-1609"><a href="#cb116-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1612"><a href="#cb116-1612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1613"><a href="#cb116-1613" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb116-1614"><a href="#cb116-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1615"><a href="#cb116-1615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> weight_lost_g, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1616"><a href="#cb116-1616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-1617"><a href="#cb116-1617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-1618"><a href="#cb116-1618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost by cage number and mouse strain"</span>,</span>
<span id="cb116-1619"><a href="#cb116-1619" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cage number"</span>,</span>
<span id="cb116-1620"><a href="#cb116-1620" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb116-1621"><a href="#cb116-1621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb116-1622"><a href="#cb116-1622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb116-1623"><a href="#cb116-1623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1624"><a href="#cb116-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1625"><a href="#cb116-1625" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Assign the plots you created in question 4 to variables, use the patchwork package to combine them into a single figure, and save it to a file.</span>
<span id="cb116-1626"><a href="#cb116-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1627"><a href="#cb116-1627" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">details</span><span class="dt">&gt;</span></span>
<span id="cb116-1628"><a href="#cb116-1628" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;</span><span class="kw">summary</span><span class="dt">&gt;</span>Solutions<span class="dt">&lt;/</span><span class="kw">summary</span><span class="dt">&gt;</span></span>
<span id="cb116-1629"><a href="#cb116-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1630"><a href="#cb116-1630" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The plotting code would generate:</span>
<span id="cb116-1631"><a href="#cb116-1631" aria-hidden="true" tabindex="-1"></a>  a. Boxplots of the weight lost (in grams), with one for each sex in each cage. The boxplots are coloured by sex and the width of the boxplots is set to 0.5 so they are a bit skinnier than usual. A dashed line is drawn at y = 4 (4g of weight lost), and the legend is placed at the bottom of the plot. The plot uses a minimal theme.</span>
<span id="cb116-1632"><a href="#cb116-1632" aria-hidden="true" tabindex="-1"></a>  b. A scatterplot of initial weight (in grams) vs weight lost (in grams), with points coloured by drug dosage (using a the viridis colour palette for continuous variables). A black linear trendline is plotted over the top, and the confidence interval is not shown (<span class="in">`se = FALSE`</span>). The plot uses a minimal theme.</span>
<span id="cb116-1633"><a href="#cb116-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1634"><a href="#cb116-1634" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Below are some sample answers. Your plots might look a little different depending on your aesthetic preferences.</span>
<span id="cb116-1635"><a href="#cb116-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1636"><a href="#cb116-1636" aria-hidden="true" tabindex="-1"></a>  a. To make the plot you could use the following code:</span>
<span id="cb116-1639"><a href="#cb116-1639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1640"><a href="#cb116-1640" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1641"><a href="#cb116-1641" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> mouse_strain, <span class="at">y =</span> drug_dose_g, <span class="at">fill =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1642"><a href="#cb116-1642" aria-hidden="true" tabindex="-1"></a>  <span class="co"># you could also use aes(colour = mouse_strain) here to have the outline of the violin be the same colour as the fill</span></span>
<span id="cb116-1643"><a href="#cb116-1643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb116-1644"><a href="#cb116-1644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb116-1645"><a href="#cb116-1645" aria-hidden="true" tabindex="-1"></a>  <span class="co"># choose a scale you like</span></span>
<span id="cb116-1646"><a href="#cb116-1646" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here I am using a vector of three different hex colours for the three different strains</span></span>
<span id="cb116-1647"><a href="#cb116-1647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#FFBA49"</span>, <span class="st">"#EF5B5B"</span>, <span class="st">"#3581B8"</span>)) <span class="sc">+</span></span>
<span id="cb116-1648"><a href="#cb116-1648" aria-hidden="true" tabindex="-1"></a>  <span class="co"># don't forget to label!!</span></span>
<span id="cb116-1649"><a href="#cb116-1649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Drug dosage by mouse strain"</span>,</span>
<span id="cb116-1650"><a href="#cb116-1650" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Drug dosage (g)"</span>,</span>
<span id="cb116-1651"><a href="#cb116-1651" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Mouse strain"</span>) <span class="sc">+</span></span>
<span id="cb116-1652"><a href="#cb116-1652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1653"><a href="#cb116-1653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1654"><a href="#cb116-1654" aria-hidden="true" tabindex="-1"></a>  b. To make the plot you could use the following code:</span>
<span id="cb116-1657"><a href="#cb116-1657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1658"><a href="#cb116-1658" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data, <span class="fu">aes</span>(<span class="at">x =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1659"><a href="#cb116-1659" aria-hidden="true" tabindex="-1"></a>  <span class="co"># choose your fave pink colour, here i just used "pink"</span></span>
<span id="cb116-1660"><a href="#cb116-1660" aria-hidden="true" tabindex="-1"></a>  <span class="co"># don't forget to set the bins to 15</span></span>
<span id="cb116-1661"><a href="#cb116-1661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"pink"</span>, <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb116-1662"><a href="#cb116-1662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(sex <span class="sc">~</span> mouse_strain) <span class="sc">+</span></span>
<span id="cb116-1663"><a href="#cb116-1663" aria-hidden="true" tabindex="-1"></a>  <span class="co"># don't forget to label!!</span></span>
<span id="cb116-1664"><a href="#cb116-1664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="st">"Weight lost by sex and mouse strain"</span>,</span>
<span id="cb116-1665"><a href="#cb116-1665" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Weight lost (g)"</span>,</span>
<span id="cb116-1666"><a href="#cb116-1666" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb116-1667"><a href="#cb116-1667" aria-hidden="true" tabindex="-1"></a>  <span class="co"># my fave theme</span></span>
<span id="cb116-1668"><a href="#cb116-1668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1669"><a href="#cb116-1669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1670"><a href="#cb116-1670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1671"><a href="#cb116-1671" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The error is because you are trying to colour the points by weight lost, but you haven't specified it in the <span class="in">`aes()`</span> function. You need to put <span class="in">`colour = weight_lost_g`</span> inside the <span class="in">`aes()`</span> function. This can be either the first <span class="in">`aes()`</span> function call inside <span class="in">`ggplot()`</span>:</span>
<span id="cb116-1672"><a href="#cb116-1672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1675"><a href="#cb116-1675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1676"><a href="#cb116-1676" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1677"><a href="#cb116-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm, <span class="at">colour =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1678"><a href="#cb116-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb116-1679"><a href="#cb116-1679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-1680"><a href="#cb116-1680" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1681"><a href="#cb116-1681" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb116-1682"><a href="#cb116-1682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1683"><a href="#cb116-1683" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1684"><a href="#cb116-1684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1685"><a href="#cb116-1685" aria-hidden="true" tabindex="-1"></a>Or, you could set the colour in the <span class="in">`geom_point()`</span> function, like this:</span>
<span id="cb116-1686"><a href="#cb116-1686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1689"><a href="#cb116-1689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1690"><a href="#cb116-1690" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1691"><a href="#cb116-1691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1692"><a href="#cb116-1692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> weight_lost_g)) <span class="sc">+</span></span>
<span id="cb116-1693"><a href="#cb116-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Initial weight vs tail length"</span>,</span>
<span id="cb116-1694"><a href="#cb116-1694" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1695"><a href="#cb116-1695" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb116-1696"><a href="#cb116-1696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1697"><a href="#cb116-1697" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1698"><a href="#cb116-1698" aria-hidden="true" tabindex="-1"></a>Either way, if you want to map a variable to an aesthetic, you need to put it inside the <span class="in">`aes()`</span> function!</span>
<span id="cb116-1699"><a href="#cb116-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1700"><a href="#cb116-1700" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>To recreate the plots, you could use the following code:</span>
<span id="cb116-1701"><a href="#cb116-1701" aria-hidden="true" tabindex="-1"></a>  a. Note how the <span class="in">`aes()`</span> function is used to colour the points and individual trendlines by mouse strain, but not the overall trendline because we specify it within the geoms, not in the initial <span class="in">`ggplot()`</span> function call:</span>
<span id="cb116-1702"><a href="#cb116-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1705"><a href="#cb116-1705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1706"><a href="#cb116-1706" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1707"><a href="#cb116-1707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> initial_weight_g, <span class="at">y =</span> tail_length_mm)) <span class="sc">+</span></span>
<span id="cb116-1708"><a href="#cb116-1708" aria-hidden="true" tabindex="-1"></a>  <span class="co"># colour the points by mouse strain</span></span>
<span id="cb116-1709"><a href="#cb116-1709" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we put this in geom_point() because we want to colour the points by mouse strain but not the overall trendline</span></span>
<span id="cb116-1710"><a href="#cb116-1710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-1711"><a href="#cb116-1711" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a grey trendline for the overall trend (not coloured by mouse strain)</span></span>
<span id="cb116-1712"><a href="#cb116-1712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb116-1713"><a href="#cb116-1713" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a separate trendline for each mouse strain</span></span>
<span id="cb116-1714"><a href="#cb116-1714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="fu">aes</span>(<span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1715"><a href="#cb116-1715" aria-hidden="true" tabindex="-1"></a>  <span class="co"># label the plot</span></span>
<span id="cb116-1716"><a href="#cb116-1716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Scatterplot of Simpson's Paradox in the relationship between initial weight and tail length"</span>,</span>
<span id="cb116-1717"><a href="#cb116-1717" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Initial weight (g)"</span>,</span>
<span id="cb116-1718"><a href="#cb116-1718" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Tail length (mm)"</span>) <span class="sc">+</span></span>
<span id="cb116-1719"><a href="#cb116-1719" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use the minimal theme</span></span>
<span id="cb116-1720"><a href="#cb116-1720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb116-1721"><a href="#cb116-1721" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1722"><a href="#cb116-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1723"><a href="#cb116-1723" aria-hidden="true" tabindex="-1"></a>  b. Notice how we specified the <span class="in">`linewidth`</span> argument in the <span class="in">`geom_boxplot()`</span> and <span class="in">`geom_hline()`</span> functions to make the lines thicker. This is not inside the <span class="in">`aes()`</span> function because it doesn't represent anything in the data, it's just used to style the plot. We also set the <span class="in">`base_size`</span> argument in the <span class="in">`theme_minimal()`</span> function to make the font size larger:</span>
<span id="cb116-1724"><a href="#cb116-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1727"><a href="#cb116-1727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1728"><a href="#cb116-1728" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mousezempic_dosage_data,</span>
<span id="cb116-1729"><a href="#cb116-1729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> cage_number, <span class="at">y =</span> weight_lost_g, <span class="at">colour =</span> mouse_strain)) <span class="sc">+</span></span>
<span id="cb116-1730"><a href="#cb116-1730" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set linewidth = 2 to make the lines thicker</span></span>
<span id="cb116-1731"><a href="#cb116-1731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-1732"><a href="#cb116-1732" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add a dashed line at y = 4</span></span>
<span id="cb116-1733"><a href="#cb116-1733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb116-1734"><a href="#cb116-1734" aria-hidden="true" tabindex="-1"></a>  <span class="co">#endregion</span></span>
<span id="cb116-1735"><a href="#cb116-1735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Weight lost by cage number and mouse strain"</span>,</span>
<span id="cb116-1736"><a href="#cb116-1736" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Cage number"</span>,</span>
<span id="cb116-1737"><a href="#cb116-1737" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Weight lost (g)"</span>) <span class="sc">+</span></span>
<span id="cb116-1738"><a href="#cb116-1738" aria-hidden="true" tabindex="-1"></a>  <span class="co"># minimal theme and increase font size</span></span>
<span id="cb116-1739"><a href="#cb116-1739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span></span>
<span id="cb116-1740"><a href="#cb116-1740" aria-hidden="true" tabindex="-1"></a>  <span class="co"># move the legend to the bottom</span></span>
<span id="cb116-1741"><a href="#cb116-1741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb116-1742"><a href="#cb116-1742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1743"><a href="#cb116-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1744"><a href="#cb116-1744" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>To combine the plots, you could use the following code:</span>
<span id="cb116-1745"><a href="#cb116-1745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1748"><a href="#cb116-1748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb116-1749"><a href="#cb116-1749" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb116-1750"><a href="#cb116-1750" aria-hidden="true" tabindex="-1"></a><span class="co"># assuming you have already created the plots and assigned them to variables 'plot1' and 'plot2'</span></span>
<span id="cb116-1751"><a href="#cb116-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1752"><a href="#cb116-1752" aria-hidden="true" tabindex="-1"></a><span class="co"># don't forget to load the patchwork package!</span></span>
<span id="cb116-1753"><a href="#cb116-1753" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb116-1754"><a href="#cb116-1754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1755"><a href="#cb116-1755" aria-hidden="true" tabindex="-1"></a><span class="co"># combine the plots</span></span>
<span id="cb116-1756"><a href="#cb116-1756" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> plot1 <span class="sc">+</span> plot2 <span class="sc">+</span></span>
<span id="cb116-1757"><a href="#cb116-1757" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we can add annotation if we like</span></span>
<span id="cb116-1758"><a href="#cb116-1758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb116-1759"><a href="#cb116-1759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1760"><a href="#cb116-1760" aria-hidden="true" tabindex="-1"></a><span class="co"># save the plot to a file</span></span>
<span id="cb116-1761"><a href="#cb116-1761" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"combined_plot.png"</span>, <span class="at">plot =</span> combined_plot, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">5</span>)</span>
<span id="cb116-1762"><a href="#cb116-1762" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb116-1763"><a href="#cb116-1763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-1764"><a href="#cb116-1764" aria-hidden="true" tabindex="-1"></a><span class="dt">&lt;/</span><span class="kw">details</span><span class="dt">&gt;</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="site_libs/quarto-contrib/alpine-3.12/alpine@3.12.min.js"></script>
</body></html>